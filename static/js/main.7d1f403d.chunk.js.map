{"version":3,"sources":["../../feature-viewer-test/feature-viewer/src/feature-viewer.js","../../feature-viewer-test/feature-viewer/lib/index.js","../../feature-viewer-test/feature-viewer/utils/icons.js","../../feature-viewer-test/feature-viewer/src/fv.nextprot.js","utils/services/isoform.ts","components/Isoform.tsx","utils/data.ts","utils/exportFile.ts","components/Table.tsx","components/FeatureViewer.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["require","crossIcon","deleteIcon","module","exports","sequence","div","options","self","this","events","FEATURE_SELECTED_EVENT","FEATURE_DESELECTED_EVENT","ZOOM_EVENT","GET_PREDICTIONS_EVENT","VARIANT_ADDED_EVENT","svgElement","el","document","getElementById","substring","intLength","Number","isInteger","fvLength","length","features","SVGOptions","showSequence","brushActive","verticalLine","dottedSequence","variant","offset","start","end","console","warn","svg","svgContainer","yAxisSVG","yAxisSVGgroup","seqPos","absoluteSeqPos","pathLevel","yData","Yposition","level","seqShift","zoomMax","current_extend","featureSelected","animation","variantInputValues","colorSelectedFeat","feat","object","d3","select","id","style","originalColor","type","color","margin","width","$","height","scaling","scale","linear","domain","range","scalingPosition","updateLineTooltip","mouse","pD","xP","elemHover","l","x","helper","tooltip","tooltipDiv","selectedRect","bodyNode","node","tooltipColor","selection","on","pI","selectAll","remove","absoluteMousePos","rightside","append","attr","left","bottom","offsetHeight","padding","position","first_line","description","second_line","y","html","getBoundingClientRect","undefined","xTemp","yTemp","xRect","widthRect","nodeName","rect","previousSibling","svgWidth","getBBox","parseInt","top","CustomEvent","event","detail","dispatchEvent","trigger","_x","arguments","attrs","styles","X","d","displaySequence","seq","rectWidth","rectX","rectWidth2","addLevel","array","leveling","forEach","push","placed","k","onFeatureSelected","listener","addEventListener","onFeatureDeselected","onZoom","onGetPredictions","onVariantAdded","lineBond","line","interpolate","lineGen","lineYscale","xAxis","axis","tickFormat","format","orient","shadeBlendConvert","p","from","to","sbcRip","RGB","Object","split","i","slice","parseFloat","r","Math","round","h","b","f","t","toString","updateSVGHeight","yAxisScale","ordinal","rangeRoundBands","updateYaxis","data","enter","filter","join","text","title","forcePropagation","item","brush_elm","new_click_event","Event","pageX","clientX","pageY","clientY","tickValues","preComputing","sort","a","map","shift","unshift","maxValue","max","apply","o","abs","fillSVG","typeIdentifier","name","rectangle","unique","multipleRect","path","Array","isArray","negativeNumbers","seqSelected","e","showPopup","posX","calculatePos","window","inputValue","singlePopup","show","divPos","value","property","v","original","callOnVariantAdded","addVariant","sequenceLine","transition","duration","rectHeight","rectShift","lineShift","rectsPro","dataline","className","rectsProGroup","call","uniqueShift","pathsDB","interpolation","fill","histog","dd","rects","showFilteredFeature","baseUrl","minY","maxY","gradient","url_gradient","url_dropshadow","hideFilteredFeature","transit1","transit2","brush","brushend","keys","constructor","info","extent","extentLength","empty","zoomScale","toFixed","currentShift","transition_data","reset_axis","zoom","clear","resetZoom","resetAll","resizeCallback","updateWindow","callOnGetPredictions","addRectSelection","svgId","featSelection","elemSelected","tagName","fn","popover","bubbleHelp","unit","toolbar","headerOptions","headerPosition","headerZoom","helpContent","find","multipleVariantContainer","showMultipleVariantPopup","multipleVariantPopup","appendInputFields","popup","each","$this","is","parent","log","splice","inputContainer","changeInputValues","idx","charAt","variantValues","inputWrapper","key","dropdown","not","hide","toggle","dropdownContainer","toUpperCase","getElementsByTagName","txtValue","textContent","innerText","indexOf","display","children","index","btnContainer","preventDefault","defs","feMerge","positionWithoutLetter","showAxis","vertical","mousex","addVerticalLine","initSVG","addFeature","clearInstance","off","global","jQuery","createFeature","Nextprot","NXUtils","NXViewerUtils","nxFeatureViewer","mixin","prototype","mergeData","oneData","metaData","viewer","featuresForViewer","convertMappingsToIsoformMap","featForViewer","convertNXAnnotations","addNxFeature","featuresName","featuresStyle","that","Promise","resolve","reject","all","nx","list","entry","getProteinSequence","getAntibody","getIsoformMapping","getAnnotationsByCategory","getFeaturesByview","nxClient","then","isoName","isoform","hasOwnProperty","feature","extend","filterFeatures","catch","err","message","stack","ft","startsWith","isoNb","nxEntry","iso","uniqueName","getIsoforms","axios","get","response","res","isoforms","error","Isoform","handleIsoformChange","currentIsoform","useState","setIsoforms","loading","setLoading","useEffect","onChange","mainEntityName","DEFAULT_OPTIONS","FEATURE_DATA","getExportFileBlob","columns","fileType","fileName","headerNames","col","exportValue","csvString","Papa","unparse","fields","Blob","RESULT_COLUMN_DATA","Header","accessor","Cell","row","GlobalFilter","preGlobalFilteredRows","globalFilter","setGlobalFilter","count","setValue","useAsyncDebounce","target","placeholder","Table","props","useMemo","useTable","initialState","pageIndex","pageSize","useGlobalFilter","usePagination","useExportData","getTableProps","getTableBodyProps","headerGroups","prepareRow","page","state","canPreviousPage","canNextPage","pageOptions","pageCount","gotoPage","nextPage","previousPage","setPageSize","exportData","onClick","headerGroup","getHeaderGroupProps","headers","column","backgroundColor","getHeaderProps","render","getRowProps","cells","cell","getCellProps","disabled","defaultValue","FeatureViewerComponent","setData","setCurrentIsoform","innerHTML","fv","sift","random","polyphen","App","src","alt","FeatureViewer","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"wHAAkCA,EAAQ,IAAlCC,E,EAAAA,UAAWC,E,EAAAA,WA4pE0C,kBAAnBC,EAAOC,UAC7CD,EAAOC,QA5pEX,SAAuBC,EAAUC,EAAKC,GAE9B,IAAIC,EAAOC,KAEXA,KAAKC,OAAS,CACZC,uBAAwB,mCACtBC,yBAA0B,qCAC5BC,WAAY,8BACZC,sBAAuB,iCACvBC,oBAAqB,gCAInBT,EAAMA,EAAV,IAEIU,EADAC,EAAKC,SAASC,eAAeb,EAAIc,UAAU,IAG3CC,GADAhB,EAAWA,EACCiB,OAAOC,UAAUlB,GAAYA,EAAW,MACpDmB,EAAWH,EAAYhB,EAASoB,OAChCC,EAAW,GACXC,EAAa,CACbC,cAAc,EACdC,aAAa,EACbC,cAAc,EACdC,gBAAgB,EAChBC,SAAS,GAETC,EAAS,CAACC,MAAM,EAAEC,IAAIX,GACtBjB,GAAWA,EAAQ0B,SACnBA,EAAS1B,EAAQ0B,QACNC,MAAQ,IACfD,EAAOC,MAAQ,EACfE,QAAQC,KAAK,wEAGrB,IACIC,EACAC,EAGAC,EACAC,EAcAC,EACAC,EArBAC,EAAY,EAIZC,EAAQ,GAGRC,EAAY,GACZC,EAAQ,EACRC,EAAW,EAEXC,EAAU,GACVC,EAAiB,CACTzB,OAASQ,EAAOE,IAAMF,EAAOC,MAC7BA,MAAQD,EAAOC,MACfC,IAAMF,EAAOE,KAErBgB,EAAkB,GAClBC,GAAY,EAIZC,EAAqB,GAEzB,SAASC,EAAkBC,EAAMC,GAEzBL,IAAoB,IAAIM,GAAGC,OAAOP,EAAgBQ,IAAIC,MAAM,OAAQT,EAAgBU,eACpE,SAAhBL,EAAOM,MAAmC,SAAhBN,EAAOM,OACjCX,EAAkB,CAAC,GAAMI,EAAM,cAAiBE,GAAGC,OAAOH,GAAMK,MAAM,SAAWJ,EAAOO,OACxFN,GAAGC,OAAOH,GAAMK,MAAM,OAAQ,cAStCH,GAAGC,OAAOpD,GACLsD,MAAM,WAAY,YAClBA,MAAM,UAAW,OACjBA,MAAM,UAAW,KAEtB,IAAII,EACS,GADTA,EAEW,GAFXA,EAGY,GAHZA,EAIU,IAEVC,EAAQC,EAAE5D,GAAK2D,QAAUD,EAAcA,EAAe,GACtDG,EAAS,IAAMH,EAAaA,EAC5BI,EAAUX,GAAGY,MAAMC,SAClBC,OAAO,CAACtC,EAAOC,MAAOD,EAAOE,MAC7BqC,MAAM,CAAC,EAAGP,EAAM,IACjBQ,EAAkBhB,GAAGY,MAAMC,SAC1BC,OAAO,CAAC,EAAGN,IACXO,MAAM,CAACvC,EAAOC,MAAOD,EAAOE,MAKjC,SAASuC,EAAkBC,EAAMC,GAG7B,IAFA,IAAIC,EAAKF,EAAM,IACXG,EAAY,GACPC,EAAE,EAAGA,EAAEH,EAAGnD,OAAOsD,IACtB,GAAIX,EAAQQ,EAAGG,GAAGC,GAAKH,GAAMT,EAAQQ,EAAGG,EAAE,GAAGC,GAAKH,EAAI,CAE9CC,EADCD,EAAKT,EAAQQ,EAAGG,GAAGC,GAAOZ,EAAQQ,EAAGG,EAAE,GAAGC,GAAKH,EACpCD,EAAGG,GAEFH,EAAGG,EAAE,GACtB,MAGR,OAAOD,EAGXrB,GAAGwB,OAAS,GAEZxB,GAAGwB,OAAOC,QAAU,SAAU1B,GAC1B,IAAI2B,EACAC,EACAC,EAAW5B,GAAGC,OAAOpD,GAAKgF,OAC1BC,EAAehF,EAAQgF,aAAehF,EAAQgF,aAAe,YAEjE,SAASL,EAAQM,GAEbA,EAAUC,GAAG,qBAAqB,SAAUb,EAAIc,GAE5CjC,GAAGC,OAAO,QAAQiC,UAAU,eAAeC,SAE3C,IAAIC,EAAmBpC,GAAGkB,MAAMU,GAC5BS,EAAaD,EAAiB,GAAK5B,EA2BvC,GA1BI6B,EACAX,EAAa1B,GAAGC,OAAOpD,GAClByF,OAAO,OACPC,KAAK,QAAS,aAEnBb,EAAa1B,GAAGC,OAAOpD,GAClByF,OAAO,OACPC,KAAK,QAAS,aACRpC,MAAM,CACbqC,KAAOJ,EAAiB,GAAK,GAAM,OAG3CV,EAAWvB,MAAM,CACbsC,OAASb,EAASc,aAAeN,EAAiB,GAAK,GAAM,KAC7D,mBAAoB,OACpB5B,MAAO,OACP,YAAa,QACbE,OAAQ,OACR,aAAc,OACdiC,QAAS,MACT,KAAQ,kBACR,aAAc,SACdC,SAAU,WACV,UAAW,GACX,aAAc,wBAEE,SAAhB7C,EAAOM,KAAiB,CACxB,IAAIwC,EAAa,8CAAgDf,EAAc,KAAOX,EAAG,GAAGI,EAAI,mBAAqBJ,EAAG,GAAGI,EAAI,OAC/H,GAAIJ,EAAG2B,YAAa,IAAIC,EAAc,8BAAgCjB,EAAc,mBAAqBX,EAAG2B,YAAc,YACjHC,EAAc,QACpB,GAAoB,SAAhBhD,EAAOM,KAAiB,CAC/B,IAAIgB,EAAYJ,EAAkBmB,EAAiB,GAAGjB,GAClDE,EAAUyB,aACND,EAAa,8CAAgDf,EAAc,KAAOT,EAAUE,EAAI,aAAeF,EAAU2B,EAAI,cAC7HD,EAAc,8BAAgCjB,EAAc,mBAAqBT,EAAUyB,YAAc,SAGzGD,EAAa,8BAAgCf,EAAc,kCAAoCT,EAAUE,EAAI,cAC7GwB,EAAc,8BAAgCjB,EAAc,+BAAiCT,EAAU2B,EAAI,mBAE5F,WAAhBjD,EAAOM,MAAqBc,EAAGI,IAAMJ,EAAG6B,GAC3CH,EAAa,8CAAgDf,EAAc,KAAOX,EAAGI,EAAI,OACrEwB,EAApB5B,EAAG2B,YAA+B,8BAAgChB,EAAc,mBAAqBX,EAAG2B,YAAc,OACnG,KAEnBD,EAAa,8CAAgDf,EAAc,KAAOX,EAAGI,EAAI,MAAQJ,EAAG6B,EAAI,OACpFD,EAApB5B,EAAG2B,YAA+B,8BAAgChB,EAAc,mBAAqBX,EAAG2B,YAAc,OACnG,IAG3BpB,EAAWuB,KAAKJ,EAAaE,GACzBV,GACAX,EAAWvB,MAAM,CACbqC,KAAOJ,EAAiB,GAAK,GAAMV,EAAWG,OAAOqB,wBAAwB1C,MAAU,UAI9FwB,GAAG,qBAAqB,SAAUb,EAAIc,GAEnC,GAAoB,SAAhBlC,EAAOM,KAAiB,CACxB,IACIgB,EAAYJ,GADZmB,EAAmBpC,GAAGkB,MAAMU,IACmB,GAAGT,GACtD,GAAIE,EAAUyB,YACV,IAAID,EAAa,8BAAgCf,EAAc,KAAOT,EAAUE,EAAI,aAAeF,EAAU2B,EAAI,cAC7GD,EAAc,8BAAgCjB,EAAc,mBAAqBT,EAAUyB,YAAc,YAGzGD,EAAa,8BAAgCf,EAAc,kCAAoCT,EAAUE,EAAI,cAC7GwB,EAAc,8BAAgCjB,EAAc,+BAAiCT,EAAU2B,EAAI,cAEnHtB,EAAWuB,KAAKJ,EAAaE,GAOjC,IAAIX,OADee,IAAfzB,KACAU,EAAmBpC,GAAGkB,MAAMU,IACE,GAAKpB,GAEnCkB,EAAWa,KAAK,QAAS,YACzBb,EAAWvB,MAAM,CACbqC,KAAOJ,EAAiB,GAAK,GAAMV,EAAWG,OAAOqB,wBAAwB1C,MAAU,KACvFiC,OAASb,EAASc,aAAeN,EAAiB,GAAK,GAAM,SAGjEV,EAAWa,KAAK,QAAS,YACzBb,EAAWvB,MAAM,CACbqC,KAAOJ,EAAiB,GAAK,GAAM,KACnCK,OAASb,EAASc,aAAeN,EAAiB,GAAK,GAAM,YAIxEJ,GAAG,oBAAoB,SAAUb,EAAIc,GAElCP,EAAWS,YAEdH,GAAG,SAAS,SAAUb,EAAIc,GACvB,IAAImB,EACAC,EACAC,EACAC,EACAlC,EAEJ,GAAqB,SAAlBrE,KAAKwG,SAAqB,CACzB,IAAIC,EAAO,IAAIzG,KAAK0G,gBAAgBxD,GACf,MAAlBuD,EAAKD,UAAkB3D,EAAkB4D,EAAM1D,QAEjDF,EAAkB7C,KAAM+C,GAE7B,IAAI4D,EAAWzF,EAAWE,YAAc4B,GAAGC,OAAO,eAAesC,KAAK,SAAWzD,EAAa+C,OAAO+B,UAAUpD,MA+C/G,GA9CAR,GAAGC,OAAO,QAAQiC,UAAU,oBAAoBC,SAEhDR,EAAe3B,GAAGC,OAAOpD,GACpByF,OAAO,OACPC,KAAK,QAAS,gBACC,SAAhBxC,EAAOM,MACP+C,EAAQjC,EAAG,GAAGI,EACd8B,EAAQlC,EAAG,GAAGI,GACS,SAAhBxB,EAAOM,MAGd+C,GADA/B,EAAYJ,EADWjB,GAAGkB,MAAMU,GACe,GAAGT,IAChCI,EAAI,GACtB8B,EAAQhC,EAAUE,EAAI,IACC,WAAhBxB,EAAOM,MAAqBc,EAAGI,IAAMJ,EAAG6B,GAC/CI,EAAQjC,EAAGI,EAAI,GACf8B,EAAQlC,EAAG6B,EAAI,KAEfI,EAAQjC,EAAGI,EACX8B,EAAQlC,EAAG6B,GAGXrC,EAAQyC,GAAS,GAAKzC,EAAQ0C,GAASM,GACvCL,EAAQ/C,EACRgD,EAAYM,SAASF,GAAY,GAC1BhD,EAAQyC,GAAS,GACxBE,EAAQ/C,EACRgD,EAAa5C,EAAQ0C,IACd1C,EAAQ0C,GAASM,GACxBL,EAAQ3C,EAAQyC,GAAS7C,EACzBgD,EAAYM,SAASF,GAAYhD,EAAQyC,GACzCG,GAAyB,IAEzBD,EAAQ3C,EAAQyC,GAAS7C,EACzBgD,EAAa5C,EAAQ0C,GAAS1C,EAAQyC,IAE1CzB,EAAaxB,MAAM,CACfqC,KAAMc,EAAQ,KACdQ,IAAMrD,EAAE5D,EAAM,eAAemB,OAAU,OAAY,OACnD,mBAAoB,qBACpBwC,MAAO+C,EAAY,KACnB7C,OAASrB,EAAY,GAAM,KAC3BuD,SAAU,WACV,WAAY,EACZ,aAAc,wBAGdmB,YAAa,CACb,IAAIC,EAAQ,IAAID,YAAYhH,EAAKE,OAAOC,uBAAwB,CAC5D+G,OAAQ,CACJxF,MAAuB,SAAhBsB,EAAOM,KAAkBc,EAAG,GAAGI,EAAoB,SAAhBxB,EAAOM,KAAkBgB,EAAUE,EAAIJ,EAAGI,EACpF7C,IAAqB,SAAhBqB,EAAOM,KAAkBc,EAAG,GAAGI,EAAoB,SAAhBxB,EAAOM,KAAkBgB,EAAU2B,EAAI7B,EAAG6B,EAClF9C,GAAoB,SAAhBH,EAAOM,KAAkBc,EAAG,GAAGjB,GAAqB,SAAhBH,EAAOM,KAAkBgB,EAAUnB,GAAKiB,EAAGjB,GACnF4C,YAA4B,SAAhB/C,EAAOM,KAAkBc,EAAG,GAAG2B,YAA8B,SAAhB/C,EAAOM,KAAkBgB,EAAUyB,YAAc3B,EAAG2B,eAGrHvF,EAAW2G,cAAcF,QAEzBrF,QAAQC,KAAK,kCAEb7B,EAAKoH,SAASpH,EAAKoH,QAAQpH,EAAKE,OAAOC,uBAAwB,CAC/DuB,MAAuB,SAAhBsB,EAAOM,KAAkBc,EAAG,GAAGI,EAAoB,SAAhBxB,EAAOM,KAAkBgB,EAAUE,EAAIJ,EAAGI,EACpF7C,IAAqB,SAAhBqB,EAAOM,KAAkBc,EAAG,GAAGI,EAAoB,SAAhBxB,EAAOM,KAAkBgB,EAAU2B,EAAI7B,EAAG6B,EAClF9C,GAAoB,SAAhBH,EAAOM,KAAkBc,EAAG,GAAGjB,GAAqB,SAAhBH,EAAOM,KAAkBgB,EAAUnB,GAAKiB,EAAGjB,GACnF4C,YAA4B,SAAhB/C,EAAOM,KAAkBc,EAAG,GAAG2B,YAA8B,SAAhB/C,EAAOM,KAAkBgB,EAAUyB,YAAc3B,EAAG2B,iBAkB7H,OAZArB,EAAQc,KAAO,SAAU6B,GACrB,OAAKC,UAAUrG,QACfsG,MAAQF,EACDpH,MAFuBsH,OAKlC7C,EAAQtB,MAAQ,SAAUiE,GACtB,OAAKC,UAAUrG,QACfuG,OAASH,EACFpH,MAFuBuH,QAK3B9C,GAIX,IAAI+C,EAAI,SAAUC,GACd,OAAO9D,EAAQ8D,EAAElD,IAEjBmD,EAAkB,SAAUC,GAC5B,OAAOnE,EAAQmE,EAAM,GAErBC,EAAY,SAAUH,GACtB,OAAQ9D,EAAQ8D,EAAEzB,GAAKrC,EAAQ8D,EAAElD,IAErC,SAASsD,EAAM9E,GACX,OAAIA,EAAOwB,IAAMxB,EAAOiD,EACbrC,EAAQZ,EAAOwB,EAAE,IAErBZ,EAAQZ,EAAOwB,GAE1B,SAASuD,EAAWL,GAChB,OAAIA,EAAElD,IAAMkD,EAAEzB,EACNrC,EAAQ8D,EAAElD,EAAI,IAAOZ,EAAQ8D,EAAElD,EAAI,IAAO,EAAU,EAC5CZ,EAAQ8D,EAAElD,EAAI,IAAOZ,EAAQ8D,EAAElD,EAAI,IAE3CZ,EAAQ8D,EAAEzB,GAAKrC,EAAQ8D,EAAElD,GAuBrC,SAASwD,EAASC,GACd,IAAIC,EAAW,GAqBf,OApBAD,EAAME,SAAQ,SAAUT,GACpB,GAAIQ,IAAa,GACbA,EAASE,KAAKV,EAAEzB,GAChByB,EAAEnF,MAAQ,MACP,CAEH,IADA,IAAI8F,GAAS,EACJC,EAAI,EAAGA,EAAIJ,EAASjH,OAAQqH,IACjC,GAAIZ,EAAElD,EAAI0D,EAASI,GAAI,CACnBD,GAAS,EACTX,EAAEnF,MAAQ+F,EACVJ,EAASI,GAAKZ,EAAEzB,EAChB,OAGO,IAAXoC,IACAH,EAASE,KAAKV,EAAEzB,GAChByB,EAAEnF,MAAQ2F,EAASjH,OAAS,OAIjCiH,EAASjH,OAvCpBhB,KAAKsI,kBAAoB,SAAUC,GAC/BhI,EAAWiI,iBAAiBzI,EAAKE,OAAOC,uBAAwBqI,IAEpEvI,KAAKyI,oBAAsB,SAAUF,GACjChI,EAAWiI,iBAAiBzI,EAAKE,OAAOE,yBAA0BoI,IAGtEvI,KAAK0I,OAAS,SAAUH,GACpBhI,EAAWiI,iBAAiBzI,EAAKE,OAAOG,WAAYmI,IAExDvI,KAAK2I,iBAAmB,SAAUJ,GAC9BhI,EAAWiI,iBAAiBzI,EAAKE,OAAOI,sBAAuBkI,IAEnEvI,KAAK4I,eAAiB,SAAUL,GAC5BhI,EAAWiI,iBAAiBzI,EAAKE,OAAOK,oBAAqBiI,IAsDjE,IAAIM,EAAW7F,GAAGnB,IAAIiH,OACjBC,YAAY,eACZxE,GAAE,SAAUkD,GACT,OAAO9D,EAAQ8D,EAAElD,MAEpByB,GAAE,SAAUyB,GACT,OAAc,IAANA,EAAEzB,EAAS7D,KAEvB6G,EAAUhG,GAAGnB,IAAIiH,OAGlBvE,GAAE,SAASkD,GACV,OAAO9D,EAAQ8D,EAAElD,MAElByB,GAAE,SAAUyB,GACP,OAA0B,GAAnBwB,GAAYxB,EAAEzB,GAAU7D,KAEnC8G,EAAajG,GAAGY,MAAMC,SACrBC,OAAO,CAAC,GAAG,KACXC,MAAM,CAAC,GAAG,KACX+E,EAAO9F,GAAGnB,IAAIiH,OACbC,YAAY,UACZxE,GAAE,SAAUkD,GACT,OAAO9D,EAAQ8D,EAAElD,MAEpByB,GAAE,SAAUyB,GACT,OAAOA,EAAEzB,EAAI,KAIjBkD,EAAQlG,GAAGnB,IAAIsH,OACdvF,MAAMD,GACNyF,WAAWpG,GAAGqG,OAAO,MACrBC,OAAO,UAEZ,SAASC,EAAkBC,EAAGC,EAAMC,GAChC,GAAc,iBAAJF,GAAcA,GAAG,GAAGA,EAAE,GAAiB,iBAAPC,GAA2B,KAATA,EAAK,IAAkB,KAATA,EAAK,IAAuB,iBAALC,GAA2B,oBAALA,EAAkB,OAAO,KAC5I1J,KAAK2J,SAAO3J,KAAK2J,OAAO,SAASlC,GACjC,IAAInD,EAAEmD,EAAEzG,OAAO4I,EAAI,IAAIC,OACvB,GAAGvF,EAAE,EAAE,CAEH,IADAmD,EAAEA,EAAEqC,MAAM,MACL9I,OAAO,GAAGyG,EAAEzG,OAAO,EAAE,OAAO,KACjC4I,EAAI,GAAGG,EAAEtC,EAAE,GAAGuC,MAAM,IAAIJ,EAAI,GAAGG,EAAEtC,EAAE,IAAImC,EAAI,GAAGG,EAAEtC,EAAE,IAAImC,EAAI,GAAGnC,EAAE,GAAGwC,WAAWxC,EAAE,KAAK,MACnF,CACD,GAAM,GAAHnD,GAAS,GAAHA,GAAMA,EAAE,EAAE,OAAO,KACvBA,EAAE,IAAEmD,EAAE,IAAIA,EAAE,GAAGA,EAAE,GAAGA,EAAE,GAAGA,EAAE,GAAGA,EAAE,GAAGA,EAAE,IAAInD,EAAE,EAAEmD,EAAE,GAAG,GAAGA,EAAE,GAAG,KAC7DA,EAAEsC,EAAEtC,EAAEuC,MAAM,GAAG,IAAIJ,EAAI,GAAGnC,GAAG,GAAG,IAAImC,EAAI,GAAGnC,GAAG,EAAE,IAAImC,EAAI,GAAK,IAAFnC,EAAMmC,EAAI,GAAM,GAAHtF,GAAS,GAAHA,EAAK4F,GAAIzC,GAAG,GAAG,KAAK,IAAK,KAAO,KAAO,EAEzH,OAAOmC,IACX,IAAIG,EAAElD,SAASqD,EAAEC,KAAKC,MAAMC,EAAEZ,EAAKzI,OAAO,EAA6DsJ,GAA3DD,EAAc,iBAALX,EAAcA,EAAG1I,OAAO,GAAW,KAAJ0I,IAASW,EAAQA,EAAIb,EAAE,GAAqDe,GAAnDf,EAAEc,GAAK,EAAHd,EAAKA,EAAEE,EAAGA,GAAQ,KAAJA,EAAQA,EAAGY,EAAE,UAAU,UAAYX,OAAOF,IAAMe,EAAEb,OAAOD,GACxL,OAAIa,GAAIC,EACLH,EAAS,OAAOH,GAAGM,EAAE,GAAGD,EAAE,IAAIf,EAAEe,EAAE,IAAI,IAAIL,GAAGM,EAAE,GAAGD,EAAE,IAAIf,EAAEe,EAAE,IAAI,IAAIL,GAAGM,EAAE,GAAGD,EAAE,IAAIf,EAAEe,EAAE,KAAKA,EAAE,GAAG,GAAGC,EAAE,GAAG,EAAE,IAAI,KAAKD,EAAE,IAAI,GAAGC,EAAE,IAAI,EAAEN,EAAuB,MAAnBM,EAAE,GAAGD,EAAE,IAAIf,EAAEe,EAAE,KAAW,IAAMC,EAAE,GAAG,EAAED,EAAE,GAAGC,EAAE,IAAI,KACjL,KAAK,WAAuG,UAA1FD,EAAE,IAAI,GAAGC,EAAE,IAAI,EAAEN,EAAuB,MAAnBM,EAAE,GAAGD,EAAE,IAAIf,EAAEe,EAAE,KAASC,EAAE,IAAI,EAAEN,EAAO,IAALM,EAAE,IAAQD,EAAE,IAAI,EAAEL,EAAO,IAALK,EAAE,IAAQ,KAAqC,MAAtBL,GAAGM,EAAE,GAAGD,EAAE,IAAIf,EAAEe,EAAE,IAAkC,IAAtBL,GAAGM,EAAE,GAAGD,EAAE,IAAIf,EAAEe,EAAE,IAAUL,GAAGM,EAAE,GAAGD,EAAE,IAAIf,EAAEe,EAAE,KAAKE,SAAS,IAAIT,MAAMO,EAAE,IAAI,GAAGC,EAAE,IAAI,EAAE,EAAE,GAFxO,KAiBrB,SAASE,GAAgB9E,GACrB/D,EAAI0D,KAAK,SAAUK,EAAW,GAAK,MACnC/D,EAAIoB,OAAO,iBAAiBsC,KAAK,SAAUK,EAAW,GAAK,MAG/D,IAAI+E,GAAa3H,GAAGY,MAAMgH,UACrB9G,OAAO,CAAC,EAAG1B,EAAMpB,SACjB6J,gBAAgB,CAAC,EAAG,KAAM,IAgB/B,SAASC,MAEL9I,EAAgBD,EACXmD,UAAU,UACV6F,KAAK3I,GACL4I,QACA1F,OAAO,MAEPA,OAAO,WACPC,KAAK,SAAS,SAAUkC,GACrB,OAAIA,EAAEwD,OAAexD,EAAEwD,OAAOnB,MAAM,KAAKoB,KAAK,KAAO,QAC9C,WAEV/H,MAAM,SAAU,IAChBA,MAAM,OAAQ,WACdoC,KAAK,UAAU,SAAUkC,GACtB,OAAQlE,EAAc,IAAO,KAAOkE,EAAEzB,EAAI,GAAK,MAAQzC,EAAc,KAAO,KAAOkE,EAAEzB,EAAI,IAAM,MAAQzC,EAAc,IAAM,KAAOkE,EAAEzB,EAAI,IAAM,MAAQzC,EAAc,GAAK,KAAOkE,EAAEzB,EAAI,KAAO,MAAQzC,EAAc,IAAM,KAAOkE,EAAEzB,EAAG,MAE7OhE,EACKsD,OAAO,QACPC,KAAK,QAAS,SACdA,KAAK,cAAe,SACpBA,KAAK,KAAK,WACP,OAAOhC,EAAc,OAExBgC,KAAK,KAAK,SAAUkC,GACjB,OAAOA,EAAEzB,EAAI,KAEhBmF,MAAK,SAAU1D,GACZ,OAAOA,EAAE2D,SAIrB,SAASC,GAAiBC,GACtBA,EAAKtG,GAAG,aAAa,WACjBuG,UAAY1J,EAAIoB,OAAO,UAAU4B,OACjC2G,gBAAkB,IAAIC,MAAM,aAC5BD,gBAAgBE,MAAQ1I,GAAGgE,MAAM0E,MACjCF,gBAAgBG,QAAU3I,GAAGgE,MAAM2E,QACnCH,gBAAgBI,MAAQ5I,GAAGgE,MAAM4E,MACjCJ,gBAAgBK,QAAU7I,GAAGgE,MAAM6E,QAC/BN,WACAA,UAAUrE,cAAcsE,oBAzDxBxI,GAAGnB,IAAIsH,OACdvF,MAAM+G,IACNmB,WAAW1J,GACXgH,YAAW,SAAU3B,GAClB,OAAOA,KAEV6B,OAAO,QAyDZ,IAAIyC,GACM,SAAUhJ,GACZA,EAAOgI,KAAKiB,MAAK,SAAUC,EAAG3B,GAC1B,OAAO2B,EAAE1H,EAAI+F,EAAE/F,KAEnB,IAAIjC,EAAQyF,EAAShF,EAAOgI,MAC5BhI,EAAOgI,KAAOhI,EAAOgI,KAAKmB,KAAI,SAAUzE,GACpC,MAAO,CAAC,CACJlD,EAAGkD,EAAElD,EACLyB,EAAG,EACH9C,GAAIuE,EAAEvE,GACN4C,YAAa2B,EAAE3B,YACfxC,MAAOmE,EAAEnE,OACV,CACCiB,EAAGkD,EAAEzB,EACLA,EAAGyB,EAAEnF,MAAQ,EACbY,GAAIuE,EAAEvE,IACP,CACCqB,EAAGkD,EAAEzB,EACLA,EAAG,EACH9C,GAAIuE,EAAEvE,QAGdf,EAAoB,GAARG,EAAa,EACzBS,EAAOW,OAAiB,GAARpB,EAAa,GAxBjCyJ,GA0BM,SAAUhJ,GACPA,EAAOW,SAAQX,EAAOW,OAAS,IACpC,IAAIyI,EAAQtF,SAAS9D,EAAOW,QACxBpB,EAAQ,EACZ,IAAK,IAAIyH,KAAKhH,EAAOgI,KAAM,CACvBhI,EAAOgI,KAAKhB,GAAGiC,MAAK,SAAUC,EAAG3B,GAC7B,OAAO2B,EAAE1H,EAAI+F,EAAE/F,KAES,IAAxBxB,EAAOgI,KAAKhB,GAAG,GAAG/D,GAClBjD,EAAOgI,KAAKhB,GAAGqC,QAAQ,CACnB7H,EAAExB,EAAOgI,KAAKhB,GAAG,GAAGxF,EAAE,EACtByB,EAAE,IAGyC,IAA/CjD,EAAOgI,KAAKhB,GAAGhH,EAAOgI,KAAKhB,GAAG/I,OAAQ,GAAGgF,GACzCjD,EAAOgI,KAAKhB,GAAG5B,KAAK,CAChB5D,EAAExB,EAAOgI,KAAKhB,GAAGhH,EAAOgI,KAAKhB,GAAG/I,OAAQ,GAAGuD,EAAE,EAC7CyB,EAAE,IAGV,IAAIqG,EAAWlC,KAAKmC,IAAIC,MAAMpC,KAAKpH,EAAOgI,KAAKhB,GAAGmC,KAAI,SAASM,GAAG,OAAOrC,KAAKsC,IAAID,EAAExG,OACpF1D,EAAQ+J,EAAW/J,EAAQ+J,EAAW/J,EAGtCS,EAAOgI,KAAKhB,GAAK,CAAChH,EAAOgI,KAAKhB,GAAGmC,KAAI,SAAUzE,GAC3C,MAAO,CACHlD,EAAGkD,EAAElD,EACLyB,EAAGyB,EAAEzB,EACL9C,GAAIuE,EAAEvE,GACN4C,YAAa2B,EAAE3B,iBAI3BmD,EAAWlF,MAAM,CAAC,GAAKoI,IAASrI,OAAO,CAAC,GAAKxB,IAC7CH,EAAoB,GAARgK,EAAY,EACxBpJ,EAAOT,MAAQA,EACfS,EAAOoJ,MAAgB,GAARA,EAAY,GA9D/BJ,GAgEc,SAAUhJ,GACpBA,EAAOgI,KAAKiB,MAAK,SAAUC,EAAG3B,GAC1B,OAAO2B,EAAE1H,EAAI+F,EAAE/F,KAEnBjC,EAAQyF,EAAShF,EAAOgI,MACxB5I,EAAoB,GAARG,EAAa,GAI7BoK,GAAU,CACVC,eAAgB,SAAU5J,GACtB,GAAoB,SAAhBA,EAAOM,KACP0I,GAA0BhJ,GAC1BX,EAAM+F,KAAK,CACPiD,MAAOrI,EAAO6J,KACd5G,EAAG3D,EACH4I,OAAQlI,EAAOkI,SAEnByB,GAAQG,UAAU9J,EAAQV,QACvB,GAAoB,SAAhBU,EAAOM,KACdqJ,GAAQ9M,SAASmD,EAAOgI,KAAM1I,GAC9BD,EAAM+F,KAAK,CACPiD,MAAOrI,EAAO6J,KACd5G,EAAG3D,EACH4I,OAAQlI,EAAOkI,SAEnBtH,EAAQI,MAAM,CAAC,EAAGP,EAAM,SACrB,GAAoB,WAAhBT,EAAOM,KACdqJ,GAAQI,OAAO/J,EAAQV,GACvBD,EAAM+F,KAAK,CACPiD,MAAOrI,EAAO6J,KACd5G,EAAG3D,EACH4I,OAAQlI,EAAOkI,cAEhB,GAAoB,iBAAhBlI,EAAOM,KACd0I,GAA0BhJ,GAC1B2J,GAAQK,aAAahK,EAAQV,EAAWC,GACxCF,EAAM+F,KAAK,CACPiD,MAAOrI,EAAO6J,KACd5G,EAAG3D,EACH4I,OAAQlI,EAAOkI,SAEnB5I,GAA2B,IAAbC,EAAQ,QACnB,GAAoB,SAAhBS,EAAOM,KACd0I,GAAkBhJ,GAClB2J,GAAQM,KAAKjK,EAAQV,GACrBA,GAAaF,EACbC,EAAM+F,KAAK,CACPiD,MAAOrI,EAAO6J,KACd5G,EAAG3D,EAAY,GACf4I,OAAQlI,EAAOkI,cAEhB,GAAoB,SAAhBlI,EAAOM,KAAiB,CACzB4J,MAAMC,QAAQnK,EAAOgI,KAAK,MAAMhI,EAAOgI,KAAO,CAAChI,EAAOgI,OACtDkC,MAAMC,QAAQnK,EAAOO,SAASP,EAAOO,MAAQ,CAACP,EAAOO,QAC3D,IAAI6J,GAAkB,EACtBpK,EAAOgI,KAAK7C,SAAQ,SAAST,GACrBA,EAAEwD,QAAO,SAAS3G,GAAI,OAAOA,EAAE0B,EAAI,KAAIhF,SAAQmM,GAAkB,MAEzEpB,GAAkBhJ,GAClB2J,GAAQ5D,KAAK/F,EAAQV,GACrBA,GAAaF,EACbC,EAAM+F,KAAK,CACPiD,MAAOrI,EAAO6J,KACd5G,EAAG3D,EAAY,GACf4I,OAAQlI,EAAOkI,SAEnB5I,GAAa8K,EAAkBhL,EAAU,EAAI,IAGrDvC,SAAU,SAAU+H,EAAK/B,EAAUnE,GAI/B,IAAI2L,EAFC3L,IAAWA,EAAQ,GAIxBK,EAAawD,OAAO,KACfC,KAAK,QAAS,YACdL,UAAU,OACV6F,KAAKpD,GACLqD,QACA1F,OAAO,QAAQ,WACZ,OAAOmC,EAAI,IAAMsC,KAEpBxE,KAAK,YAAa,cAClBA,KAAK,QAAS,MACdA,KAAK,cAAe,UACpBA,KAAK,KAAK,SAAUkC,EAAGsC,GACpB,OAAOpG,EAAQI,MAAM,CAAC,EAAGP,EAAM,GAAxBG,CAA4BoG,EAAItI,MAE1C8D,KAAK,IAAKK,GACVL,KAAK,YAAa,QAClBA,KAAK,cAAe,aACpB4F,MAAK,SAAU1D,EAAGsC,GACf,OAAOtC,KAEVzC,GAAG,aAAa,SAASqI,GACtBD,EAAcC,EAKdC,GAAU,EA4FlB,SAAsB9J,EAAO+J,GACzB,IAAMhK,EAAS,IACf,OAAGC,EAAQ+J,EAAOhK,EAAeC,GAASD,EAAO,GAAKC,EAAM+J,IAErDA,EAjGYC,CAHD/J,EAAEgK,QAAQjK,QACXxD,KAAKkG,wBAAwB3B,OAQlD,IAgCKmJ,EA9BDC,GAFgBlK,EAAE5D,EAAM,eAAemB,OAASgC,GAAGC,OAAOpD,EAAM,eAAiBmD,GAAGC,OAAOpD,GAAKyF,OAAO,OAAOC,KAAK,QAAS,cAEhGD,OAAO,OAClCC,KAAK,QAAS,wBA8DnB,SAAS+H,EAAWM,EAAMC,GACtB7K,GAAGC,OAAOpD,EAAM,6BAA6BsL,MAAK,WAC9C,OAAOjJ,KAGXc,GAAGC,OAAOpD,EAAM,6BAA6BsL,MAAK,WAC9C,OAAOiC,KAGX3M,SAASC,eAAe,wBAAwBoN,MAAQ,GAExDH,EACCxK,MAAM,OADP,UACkB0K,EADlB,OAEC1K,MAAM,UAAWyK,EAAO,QAAU,QAzEnCD,EAAYrI,OAAO,OAClBC,KAAK,QAAS,eACdA,KAAK,SAAU,UACfA,KAAK,QAAS,UACdA,KAAK,UAAU,eACfP,GAAG,SAAS,WACTsI,GAAU,MAEbrH,KAAKzG,GAENmO,EAAYrI,OAAO,OAAOW,KAA1B,40BAmBHjD,GAAGC,OAAOpD,EAAM,0BACZmF,GAAG,UAAU,WACV0I,EAAa1K,GAAGC,OAAOjD,MAAM+N,SAAS,YAG3C/K,GAAGC,OAAOpD,EAAM,8BACdmF,GAAG,SAAS,YAShB,SAAoB8I,GACjB,IAAIE,EAAI,GACRA,EAAEpI,SAAWnC,EAAE,4BAA4B0H,OAC3C6C,EAAEC,SAAWb,EACbY,EAAEzM,QAAUuM,EACZlL,EAAmBuF,KAAK6F,GACxBE,GAAmBtL,GAdfuL,CAAWT,OAqDvBU,aAAc,WAENlN,EAAWI,gBACSQ,EAAaoD,UAAU,iBACtC6F,KAAK,CAAC,CAAC,CAACxG,EAAE,EAAEyB,EAAE,IAAI,CAACzB,EAAExD,EAASiF,EAAE,OAChCgF,QACA1F,OAAO,QACPC,KAAK,YAAa,cAClBA,KAAK,IAAKuD,GACVvD,KAAK,QAAQ,gBACbpC,MAAM,UAAW,KACjBA,MAAM,SAAU,SAChBA,MAAM,mBAAmB,OACzBA,MAAM,eAAgB,OACtBA,MAAM,iBAAiB,GAGvBkL,aACAC,SAAS,KACTnL,MAAM,iBAAkB,IAGrC0J,UAAW,SAAU9J,EAAQ6C,GAEpB7C,EAAOW,SAAQX,EAAOW,OAAS,IAYpC,IAXA,IAAI6K,EAAaxL,EAAOW,OAEpB8K,EAAYD,EAAaA,EAAW,EACpCE,EAAYF,EAAW,EAAI,EAG3BG,EAAW5M,EAAawD,OAAO,KAC9BC,KAAK,QAAS,aACdA,KAAK,YAAa,eAAiBK,EAAW,KAE/C+I,EAAS,GACJ5E,EAAI,EAAGA,EAAIzH,EAAOyH,IACvB4E,EAASxG,KAAK,CAAC,CACP5D,EAAG,EACHyB,EAAI+D,EAAIyE,EAAYC,GACrB,CACClK,EAAGxD,EACHiF,EAAI+D,EAAIyE,EAAYC,KAGhCC,EAASxJ,UAAU,QAAUnC,EAAO6L,WAC/B7D,KAAK4D,GACL3D,QACA1F,OAAO,QACPC,KAAK,IAAKuD,GACVvD,KAAK,SAAS,WACX,MAAO,OAASxC,EAAO6L,aAE1BzL,MAAM,UAAW,KACjBA,MAAM,SAAUJ,EAAOO,OACvBH,MAAM,eAAgB,OAG3B,IAAI0L,EAAgBH,EAASxJ,UAAU,IAAMnC,EAAO6L,UAAY,SAC3D7D,KAAKhI,EAAOgI,MACZC,QACA1F,OAAO,KACPC,KAAK,QAASxC,EAAO6L,UAAY,SACjCrJ,KAAK,aAAa,SAAUkC,GACzB,MAAO,aAAeI,EAAMJ,GAAK,SAGzCoH,EACKvJ,OAAO,QACPC,KAAK,QAAS,WAAaxC,EAAO6L,WAClCrJ,KAAK,MAAM,SAAUkC,GAClB,MAAO,IAAMA,EAAEvE,MAElBqC,KAAK,KAAK,SAAUkC,GACjB,OAAOA,EAAEnF,MAAQkM,KAEpBjJ,KAAK,QAASuC,GACdvC,KAAK,SAAUgJ,GACfpL,MAAM,QAAQ,SAASsE,GAAK,OAAOA,EAAEnE,OAASP,EAAOO,SACrDH,MAAM,UAAW,MACjB2L,KAAK9L,GAAGwB,OAAOC,QAAQ1B,IAE5B8L,EACKvJ,OAAO,QACPC,KAAK,QAAS,WAAaxC,EAAO6L,UAAY,QAC9CrJ,KAAK,KAAK,SAAUkC,GACjB,OAAOA,EAAEnF,MAAQkM,EAAYD,EAAW,KAE3ChJ,KAAK,KAAM,UACXpC,MAAM,YAAa,QACnBgI,MAAK,SAAU1D,GACZ,OAAOA,EAAE3B,eAEZ3C,MAAM,OAAQ,SACdA,MAAM,UAAW,MACjBA,MAAM,cAAc,SAAUsE,GAC3B,IAAIA,EAAE3B,YACC,MAAO,YAEjBgJ,KAAK9L,GAAGwB,OAAOC,QAAQ1B,IAiB5BsI,GAAiBwD,GACjB,IAAIE,EAAcR,EAAa,GAAKA,EAAa,EAAI,EACrDlM,GAAaC,EAAQ,EAAIyM,GAAezM,EAAM,GAAKkM,EAAYO,GAEnEjC,OAAQ,SAAU/J,EAAQ6C,GACtB,IAAI8I,EAAW5M,EAAawD,OAAO,KAC9BC,KAAK,QAAS,kBACdA,KAAK,YAAa,eAAiBK,EAAW,KAE/C+I,EAAS,GACbA,EAASxG,KAAK,CAAC,CACP5D,EAAG,EACHyB,EAAG,GACJ,CACCzB,EAAGxD,EACHiF,EAAG,KAGX0I,EAASxJ,UAAU,QAAUnC,EAAO6L,WAC/B7D,KAAK4D,GACL3D,QACA1F,OAAO,QACPC,KAAK,YAAa,cAClBA,KAAK,IAAKuD,GACVvD,KAAK,QAAS,OAASxC,EAAO6L,WAC9BzL,MAAM,UAAW,KACjBA,MAAM,SAAUJ,EAAOO,OACvBH,MAAM,eAAgB,OAE3BuL,EAASxJ,UAAU,IAAMnC,EAAO6L,WAC3B7D,KAAKhI,EAAOgI,MACZC,QACA1F,OAAO,QACPC,KAAK,YAAa,cAClBA,KAAK,QAAS,WAAaxC,EAAO6L,WAClCrJ,KAAK,MAAM,SAAUkC,GAClB,MAAO,IAAMA,EAAEvE,MAElBqC,KAAK,KAAK,SAAUkC,GACjB,OAAO9D,EAAQ8D,EAAElD,EAAI,OAExBgB,KAAK,SAAS,SAAUkC,GACrB,OAAI9D,EAAQ8D,EAAElD,EAAI,IAAOZ,EAAQ8D,EAAElD,EAAI,IAAO,EAAU,EAC5CZ,EAAQ8D,EAAElD,EAAI,IAAOZ,EAAQ8D,EAAElD,EAAI,OAElDgB,KAAK,SAAU,IACfpC,MAAM,QAAQ,SAASsE,GAAI,OAAOA,EAAEnE,OAAUP,EAAOO,SACrDH,MAAM,UAAW,KACjB2L,KAAK9L,GAAGwB,OAAOC,QAAQ1B,IAE5BsI,GAAiBqD,IAErB1B,KAAM,SAAUjK,EAAQ6C,GACpB,IAAIoJ,EAAUlN,EAAawD,OAAO,KAC7BC,KAAK,QAAS,WACdA,KAAK,YAAa,eAAiBK,EAAW,KAE/C+I,EAAS,GACbA,EAASxG,KAAK,CAAC,CACP5D,EAAG,EACHyB,EAAG,GACJ,CACCzB,EAAGxD,EACHiF,EAAG,KAGXgJ,EAAQ9J,UAAU,QAAUnC,EAAO6L,WAC9B7D,KAAK4D,GACL3D,QACA1F,OAAO,QACPC,KAAK,YAAa,cAClBA,KAAK,IAAKsD,GACVtD,KAAK,QAAS,OAASxC,EAAO6L,WAC9BzL,MAAM,UAAW,KACjBA,MAAM,SAAUJ,EAAOO,OACvBH,MAAM,eAAgB,OAE3B6L,EAAQ9J,UAAU,IAAMnC,EAAO6L,WAC1B7D,KAAKhI,EAAOgI,MACZC,QACA1F,OAAO,QACPC,KAAK,YAAa,cAClBA,KAAK,QAAS,WAAaxC,EAAO6L,WAClCrJ,KAAK,MAAM,SAAUkC,GAClB,MAAO,IAAMA,EAAE,GAAGvE,MAErBqC,KAAK,IAAKsD,GACV1F,MAAM,OAAQ,QACdA,MAAM,UAAU,SAASsE,GAAI,OAAOA,EAAE,GAAGnE,OAASP,EAAOO,SACzDH,MAAM,UAAW,KACjBA,MAAM,eAAgB,OACtB2L,KAAK9L,GAAGwB,OAAOC,QAAQ1B,IAE5BsI,GAAiB2D,IAErBlG,KAAM,SAAU/F,EAAQ6C,GACf7C,EAAOkM,gBAAelM,EAAOkM,cAAgB,iBAC9B9I,IAAhBpD,EAAOmM,OAAoBnM,EAAOmM,MAAO,GAC7C,IAAIC,EAASrN,EAAawD,OAAO,KAC5BC,KAAK,QAAS,UACdA,KAAK,YAAa,eAAiBK,EAAW,KAE/C+I,EAAS,GACbA,EAASxG,KAAK,CAAC,CACP5D,EAAG,EACHyB,EAAG,GACJ,CACCzB,EAAGxD,EACHiF,EAAG,KAGXmJ,EAAOjK,UAAU,QAAUnC,EAAO6L,WAC7B7D,KAAK4D,GACL3D,QACA1F,OAAO,QACPC,KAAK,YAAa,cAClBA,KAAK,IAAKsD,GACVtD,KAAK,QAAS,OAASxC,EAAO6L,WAC9BzL,MAAM,UAAW,KACjBA,MAAM,SAAU,SAChBA,MAAM,eAAgB,OAC3BJ,EAAOgI,KAAK7C,SAAQ,SAASkH,EAAGrF,EAAE/B,GAC9BmH,EAAOjK,UAAU,IAAMnC,EAAO6L,UAAY7E,GACzCgB,KAAKqE,GACLpE,QACA1F,OAAO,QACPC,KAAK,YAAa,cAClBA,KAAK,QAAS,WAAaxC,EAAO6L,UAAY,IAAM7L,EAAO6L,UAAY7E,GACvExE,KAAK,IAAKyD,EAAQD,YAAYhG,EAAOkM,gBACrC9L,MAAM,OAAQJ,EAAOmM,KAAO3F,EAAkB,GAAKxG,EAAOO,MAAMyG,KAAOR,EAAkB,GAAK,QAAU,QACxGpG,MAAM,SAAUJ,EAAOO,MAAMyG,IAAM,QACnC5G,MAAM,UAAW,KACjBA,MAAM,eAAgB,OAEtB2L,KAAK9L,GAAGwB,OAAOC,QAAQ1B,OAG5BsI,GAAiB8D,IAErBpC,aAAc,SAAUhK,EAAQ6C,EAAUtD,GAOtC,IANA,IAEI+M,EAAQvN,EAAawD,OAAO,KAC3BC,KAAK,QAAS,iBACdA,KAAK,YAAa,eAAiBK,EAAW,KAE1CmE,EAAI,EAAGA,EAAIzH,EAAOyH,IACvBsF,EAAM/J,OAAO,QACRC,KAAK,IAAKuD,EAAK,CAAC,CACbvE,EAAG,EACHyB,EATI,GASA+D,EAAgB,GACrB,CACCxF,EAAGxD,EACHiF,EAZI,GAYA+D,EAAgB,MAEvBxE,KAAK,SAAS,WACX,MAAO,OAASxC,EAAO6L,aAE1BzL,MAAM,UAAW,KACjBA,MAAM,SAAUJ,EAAOO,OACvBH,MAAM,eAAgB,OAG/BkM,EAAMnK,UAAU,IAAMnC,EAAO6L,WACxB7D,KAAKhI,EAAOgI,MACZC,QACA1F,OAAO,QACPC,KAAK,YAAa,cAClBA,KAAK,QAAS,WAAaxC,EAAO6L,WAClCrJ,KAAK,MAAM,SAAUkC,GAClB,MAAO,IAAMA,EAAEvE,MAElBqC,KAAK,IAAKiC,GACVjC,KAAK,KAAK,SAAUkC,GACjB,OAjCQ,GAiCDA,EAAEnF,SAEZiD,KAAK,QAASqC,GACdrC,KAAK,SArCO,GAsCZpC,MAAM,QAAQ,SAASsE,GAAK,OAAOA,EAAEnE,OAASP,EAAOO,SACrDH,MAAM,UAAW,MACjB2L,KAAK9L,GAAGwB,OAAOC,QAAQ1B,IAE5BsI,GAAiBgE,KAIzBrP,KAAKsP,oBAAsB,SAASV,EAAWtL,EAAOiM,GAE5BxN,EAASmD,UAAU,IAAI0J,EAAU,SAAvD,IACIY,EAAOjM,EAAc,IACrBkM,EAAOlM,EAAc,EAErBmM,EAAW7N,EACVyD,OAAO,kBACPC,KAAK,KAAM,KACXA,KAAK,KAAM,KACXA,KAAK,KAAMiK,GACXjK,KAAK,KAAMkK,GACXlK,KAAK,KAAM,YACXA,KAAK,eAAgB,OACrBA,KAAK,gBAAiB,kBAE3BmK,EACKpK,OAAO,QACPC,KAAK,SAAU,OACfA,KAAK,aAAc,WACnBA,KAAK,eAAgB,GAGZmK,EACTpK,OAAO,QACPC,KAAK,SAAU,KACfA,KAAK,eAAgB,GACrBA,KAAK,aAAc,WAGnBA,KAAK,aAAcjC,GAExB,IAAIqM,EAAe,iBACfC,EAAiB,mBACjBL,IACAI,EAAe,OAASJ,EAAU,aAClCK,EAAiB,OAASL,EAAS,gBAGvBxN,EAASmD,UAAU,IAAI0J,EAAU,SAC5CzL,MAAM,OAAQwM,GACdxM,MAAM,SAAU,IAChBoC,KAAK,SAAUqK,GAEfrK,KAAK,UAAU,SAAUkC,GACtB,OAAQlE,EAAc,IAAO,KAAOkE,EAAEzB,EAAI,GAAK,MAAQzC,EAAc,KAAO,KAAOkE,EAAEzB,EAAI,IAAM,MAAQzC,EAAc,IAAM,KAAOkE,EAAEzB,EAAI,IAAM,MAAQzC,EAAc,GAAK,KAAOkE,EAAEzB,EAAI,KAAO,MAAQzC,EAAc,IAAM,KAAOkE,EAAEzB,EAAG,OAGjPhG,KAAK6P,oBAAsB,SAASjB,GAChC7M,EAASmD,UAAU,IAAI0J,EAAU,SAC5BzL,MAAM,OAAQ,sBACdoC,KAAK,SAAU,IACfA,KAAK,UAAU,SAAUkC,GACtB,OAAQlE,EAAc,IAAO,KAAOkE,EAAEzB,EAAI,GAAK,MAAQzC,EAAc,KAAO,KAAOkE,EAAEzB,EAAI,IAAM,MAAQzC,EAAc,IAAM,KAAOkE,EAAEzB,EAAI,IAAM,MAAQzC,EAAc,GAAK,KAAOkE,EAAEzB,EAAI,KAAO,MAAQzC,EAAc,IAAM,KAAOkE,EAAEzB,EAAG,OAIjP,IAAIqI,GACW,SAAUtL,GACjBjB,EAAaoD,UAAU,QAAUnC,EAAO6L,WACnCrJ,KAAK,IAAIuD,EAAKvE,GAAE,SAAUkD,GAC3B,OAAO9D,EAAQ8D,EAAElD,OAGjB5B,GACAmN,SAAWhO,EAAaoD,UAAU,IAAMnC,EAAO6L,UAAY,SAEtDP,aACAC,SAAS,KACdyB,SAAWjO,EAAaoD,UAAU,IAAMnC,EAAO6L,WAC1CP,aACAC,SAAS,OAGdwB,SAAWhO,EAAaoD,UAAU,IAAMnC,EAAO6L,UAAY,SAC3DmB,SAAWjO,EAAaoD,UAAU,IAAMnC,EAAO6L,YAEnDkB,SAASvK,KAAK,aAAa,SAAUkC,GACzB,MAAO,aAAeI,EAAMJ,GAAK,SAG7CsI,SACKxK,KAAK,QAASuC,GACnBhG,EAAaoD,UAAU,IAAMnC,EAAO6L,UAAY,QAC3CzL,MAAM,cAAc,SAAUsE,GAC3B,IAAIA,EAAE3B,YACC,MAAO,WA7B1BuI,GAgCU,SAAUtL,GAChBjB,EAAaoD,UAAU,IAAMnC,EAAO6L,WAI/BrJ,KAAK,KAAK,SAAUkC,GACjB,OAAO9D,EAAQ8D,EAAElD,MAEpBgB,KAAK,SAAS,SAAUkC,GACrB,OAAO9D,EAAQ8D,EAAEzB,GAAKrC,EAAQ8D,EAAElD,OAzC5C8J,GA4CQ,SAAUtL,GACdjB,EAAaoD,UAAU,QAAUnC,EAAO6L,WACnCrJ,KAAK,IAAIuD,EAAKvE,GAAE,SAAUkD,GAC3B,OAAO9D,EAAQ8D,EAAElD,QAGjB5B,EACUb,EAAaoD,UAAU,IAAMnC,EAAO6L,WAEzCP,aACAC,SAAS,KAGJxM,EAAaoD,UAAU,IAAMnC,EAAO6L,YAM7CrJ,KAAK,KAAK,SAAUkC,GACjB,OAAO9D,EAAQ8D,EAAElD,EAAI,OAExBgB,KAAK,SAAS,SAAUkC,GACrB,OAAI9D,EAAQ8D,EAAElD,EAAI,IAAOZ,EAAQ8D,EAAElD,EAAI,IAAO,EAAU,EAC5CZ,EAAQ8D,EAAElD,EAAI,IAAOZ,EAAQ8D,EAAElD,EAAI,QApE3D8J,GAuEM,SAAUtL,GACZjB,EAAaoD,UAAU,QAAUnC,EAAO6L,WACnCrJ,KAAK,IAAIsD,EAAStE,GAAE,SAAUkD,GACP,OAAO9D,EAAQ8D,EAAElD,MAEtByB,GAAE,SAAUyB,GACP,OAAc,IAANA,EAAEzB,EAASjD,EAAOW,YAIlDf,EACUb,EAAaoD,UAAU,IAAMnC,EAAO6L,WAEzCP,aACAC,SAAS,KAGJxM,EAAaoD,UAAU,IAAMnC,EAAO6L,YAG7CrJ,KAAK,IAAKsD,EAAS7C,GAAE,SAAUyB,GAC5B,OAAc,IAANA,EAAEzB,EAASjD,EAAOW,YA5FtC2K,GA+FM,SAAUtL,GACZkG,EAAWlF,MAAM,CAAC,GAAKhB,EAAOW,SAAUI,OAAO,CAAC,GAAKf,EAAOT,QAC5DR,EAAaoD,UAAU,QAAUnC,EAAO6L,WACnCrJ,KAAK,IAAKyD,EAAQhD,GAAE,SAAUyB,GAC3B,OAA0B,GAAnBwB,GAAYxB,EAAEzB,GAAUjD,EAAOoJ,WAG1CxJ,EACUb,EAAaoD,UAAU,IAAMnC,EAAO6L,WAEzCP,aACAC,SAAS,KAGJxM,EAAaoD,UAAU,IAAMnC,EAAO6L,YAI7CrJ,KAAK,IAAKyD,EAAQhD,GAAE,SAAUyB,GAC3B,OAA0B,GAAnBwB,GAAYxB,EAAEzB,GAAUjD,EAAOoJ,SAEnCpD,YAAYhG,EAAOkM,iBApHlCZ,GAuHM,SAAUtL,EAAQtB,IAEhBkB,EACUb,EAAaoD,UAAU,IAAMnC,EAAO6L,WAEzCP,aACAC,SAAS,KAGJxM,EAAaoD,UAAU,IAAMnC,EAAO6L,YAG7CrJ,KAAK,KAAK,SAAUkC,EAAGsC,GACpB,OAAOpG,EAAQoG,EAAItI,OAK/BuO,GAAQhN,GAAGnB,IAAImO,QACdzL,EAAEZ,GAEFqB,GAAG,WAAYiL,IAsBpB,SAASA,KAEL,GADAjN,GAAGC,OAAOpD,GAAKqF,UAAU,oBAAoBC,SACD,IAAxC0E,OAAOqG,KAAKxN,GAAiB1B,QAAgB0B,EAAgByN,cAAgBtG,OAAQ,CAGrF,GAFA7G,GAAGC,OAAOP,EAAgBQ,IAAIC,MAAM,OAAQT,EAAgBU,eAC5DV,EAAkB,GACdqE,YAAa,CACb,IAAIC,EAAQ,IAAID,YAAYhH,EAAKE,OAAOE,yBAA0B,CAC9D8G,OAAQ,CAACmJ,KAAK,wBAElB7P,EAAW2G,cAAcF,QAEzBrF,QAAQC,KAAK,kCAEb7B,EAAKoH,SAASpH,EAAKoH,QAAQpH,EAAKE,OAAOE,yBAA0B,CAACiQ,KAAK,uBAG/E,IAAIC,EAASL,GAAMK,SACfC,EAAenG,KAAKsC,IAAI4D,EAAO,GAAKA,EAAO,IAE/C,GAAIA,EAAO,GAAKA,EAAO,GAAI,IAAI5O,EAAQoF,SAASwJ,EAAO,GAAK,GACxD3O,EAAMmF,SAASwJ,EAAO,GAAK,QACtB5O,EAAQoF,SAASwJ,EAAO,GAAK,GAClC3O,EAAMmF,SAASwJ,EAAO,GAAK,GAE/B,IAAI1I,EAAMD,EAAgB4I,GAC1B,IAAKN,GAAMO,SAAWD,EAAe9N,EAAS,CAC1CC,EAAezB,OAASsP,EACxB,IAAIE,GAAazP,EAAWuP,GAAcG,QAAQ,GAClDhN,EAAE5D,EAAM,cAAcsL,KAAKqF,EAAU/F,YAGjCvJ,EAAWC,eAAkBP,GAAc+G,GAAO7F,EAAaoD,UAAU,OAAOqL,UAChF9N,EAAiB,CACjBzB,OAASsP,EACT7O,MAAQA,EACRC,IAAMA,GAENa,EAAWd,EACXK,EAAaoD,UAAU,iBAAiBC,SACxCuH,GAAQ9M,SAASA,EAASe,UAAUc,EAAM,EAAGC,GAAM,GAAIa,EAAS,IAKpEoB,EAAQG,OAAOuM,GACfrM,EAAgBD,MAAMsM,GACtB,IAAIK,EAAenO,GAAsBf,EAAOC,MAGhDkP,GAAgB1P,EAAUyP,GAC1BE,KAEI7J,aACFxG,EAAW2G,cAAc,IAAIH,YAC3BhH,EAAKE,OAAOG,WACZ,CAAC6G,OAAQ,CAAExF,MAAOA,EAAOC,IAAKA,EAAKmP,KAAML,MAGzCzQ,EAAKoH,SAASpH,EAAKoH,QAAQpH,EAAKE,OAAOG,WAAY,CAC3CqB,MAAOA,EACPC,IAAKA,EACLmP,KAAML,IAIlBxN,GAAGC,OAAOpD,GAAKqF,UAAU,UAAU4J,KAAKkB,GAAMc,cAE9C9N,GAAGC,OAAOpD,GAAKqF,UAAU,UAAU4J,KAAKkB,GAAMc,SA/EtD9Q,KAAK6Q,KAAO,SAASpP,EAAOC,GACPe,EAAehB,MAAMA,GAASgB,EAAef,IAAIA,GAE9DI,EAAaoD,UAAU,aAAaC,SAExC6K,GAAMK,OAAO,CAAC5O,EAAMC,IACpBuO,MAEJjQ,KAAK+Q,UAAY,SAAStP,EAAOC,GAC7BsP,MA2EJ,IAAIC,GAAiB,YAOrB,WAIIzN,EAAQC,EAAE5D,GAAK2D,QAAUD,EAAcA,EAAe,GACtDP,GAAGC,OAAOpD,EAAI,QACT0F,KAAK,QAAS/B,EAAQD,EAAcA,GACzCP,GAAGC,OAAOpD,EAAI,eAAe0F,KAAK,QAAS/B,GACvCtC,EAAWE,aACX4B,GAAGC,OAAOpD,EAAI,gBAAgB0F,KAAK,QAAS/B,GAEhDR,GAAGC,OAAOpD,GAAKqF,UAAU,UAAU4J,KAAKkB,GAAMc,SAG9C,IAAInJ,EAAMD,EAAgBjF,EAAezB,QACrCE,EAAWC,eAAkBP,KACjB,IAAR+G,GAAkB7F,EAAaoD,UAAU,OAAOqL,SAInC,IAAR5I,GAAgB7F,EAAaoD,UAAU,OAAOqL,UACnDzO,EAAaoD,UAAU,iBAAiBC,SACxCuH,GAAQ9M,SAASA,EAASe,UAAU8B,EAAehB,MAAM,EAAGgB,EAAef,KAAM,GAAIe,EAAehB,MAAM,KAL1GK,EAAaoD,UAAU,aAAaC,SACpCuH,GAAQ0B,iBAShBzK,EAAQI,MAAM,CAAC,EAAEP,EAAM,IACvBQ,EAAgBF,OAAO,CAAC,EAAGN,IAE3BmN,GAAgB1P,EAAUwB,EAAehB,OACzCmP,KApCAM,IAyCJ,SAASF,KAILvN,EAAE,aAAa0H,KAAK,KACpBxH,EAAQG,OAAO,CAACtC,EAAOC,MAAOD,EAAOE,MACrCsC,EAAgBD,MAAM,CAACvC,EAAOC,MAAOD,EAAOE,MAC5C,IAAIiG,EAAMD,EAAgBlG,EAAOE,IAAMF,EAAOC,OAE1CP,EAAWC,eAAkBP,KACjB,IAAR+G,GAAkB7F,EAAaoD,UAAU,OAAOqL,QAI3C9N,EAAezB,SAAWD,IAAoB,IAAR4G,GAAiB7F,EAAaoD,UAAU,OAAOqL,UAC1FzO,EAAaoD,UAAU,aAAaC,SACpCuH,GAAQ9M,SAASA,EAASe,UAAUa,EAAOC,MAAM,EAAED,EAAOE,KAAM,GAAIF,EAAOC,SAL3EK,EAAaoD,UAAU,aAAaC,SACpCuH,GAAQ0B,iBAQhB3L,EAAe,CACPzB,OAASQ,EAAOE,IAAIF,EAAOC,MAC3BA,MAAQD,EAAOC,MACfC,IAAMF,EAAOE,KAErBa,EAAS,EAEToO,GAAgB1P,EAAUO,EAAOC,OACjCmP,KAGI7J,aACFxG,EAAW2G,cAAc,IAAIH,YAAYhH,EAAKE,OAAOG,WACnD,CAAE6G,OAAQ,CAAExF,MAAO,EAAGC,IAAK9B,EAASoB,OAAQ6P,KAAM,MAElD9Q,EAAKoH,SAASpH,EAAKoH,QAAQpH,EAAKE,OAAOG,WAAY,CACvCqB,MAAO,EACPC,IAAK9B,EAASoB,OACd6P,KAAM,IAGtB7N,GAAGC,OAAOpD,GAAKqF,UAAU,UAAU4J,KAAKkB,GAAMc,SAGlD,SAASH,GAAgB1P,EAAUQ,GAC/BR,EAASiH,SAAQ,SAAUsE,GACR,SAAXA,EAAEnJ,KACFgL,GAAqB7B,GACH,iBAAXA,EAAEnJ,KACTgL,GAAoB7B,GACF,WAAXA,EAAEnJ,KACTgL,GAAkB7B,GACA,SAAXA,EAAEnJ,KACTgL,GAAgB7B,GACE,SAAXA,EAAEnJ,KACTgL,GAAgB7B,GACE,SAAXA,EAAEnJ,MACTgL,GAAgB7B,EAAG/K,MAM/B,SAASmP,KACL9O,EACKuM,aAAaC,SAAS,KACtBrL,OAAO,WACP6L,KAAK5F,GA8mBd,SAASgF,GAAmBtL,GACpBmE,aACAxG,EAAW2G,cAAc,IAAIH,YAC3BhH,EAAKE,OAAOK,oBACZ,CAAC2G,OAAQrE,KAGT7C,EAAKoH,SAAUpH,EAAKoH,QAAQpH,EAAKE,OAAOK,oBAC1CsC,GAQR,SAASuO,GAAqBvO,GACtBmE,aACAxG,EAAW2G,cAAc,IAAIH,YAC7BhH,EAAKE,OAAOI,sBACZ,CAAE4G,OAAQrE,KAGV7C,EAAKoH,SAASpH,EAAKoH,QAAQpH,EAAKE,OAAOI,sBACvCuC,GA/uBRa,EAAEgK,QAAQzI,GAAG,SAAUiM,IAmIvBjR,KAAKoR,iBAAmB,SAAUC,GAC9B,IAEIjL,EACAC,EACAC,EACAC,EALA+K,EAAgBtO,GAAGC,OAAOoO,GAC1BE,EAAeD,EAAcvG,OAK7BpE,EAAWzF,EAAWE,YAAc4B,GAAGC,OAAO,eAAesC,KAAK,SAAWzD,EAAa+C,OAAO+B,UAAUpD,MAC/GR,GAAGC,OAAO,QAAQiC,UAAU,oBAAoBC,SAGhDtC,EAAkBwO,EADG,CAAChO,KAAKiO,EAAc,GAAG,GAAGE,QAASlO,MAAMgO,EAAcnO,MAAM,UAIlF,IAAIwB,EAAe3B,GAAGC,OAAOpD,GACxByF,OAAO,OACPC,KAAK,QAAS,gBAEY,IAA3BgM,EAAa,GAAGvQ,QAChBoF,EAAQmL,EAAa,GAAG,GAAGhN,EAC3B8B,EAAQkL,EAAa,GAAG,GAAGhN,GACpBgN,EAAa,GAAGhN,IAAMgN,EAAa,GAAGvL,GAC7CI,EAAQmL,EAAa,GAAGhN,EAAI,GAC5B8B,EAAQkL,EAAa,GAAGvL,EAAI,KAE5BI,EAAQmL,EAAa,GAAGhN,EACxB8B,EAAQkL,EAAa,GAAGvL,GAExBrC,EAAQyC,GAAS,GACjBE,EAAQ/C,EACRgD,EAAa5C,EAAQ0C,IACd1C,EAAQ0C,GAASM,GACxBL,EAAQ3C,EAAQyC,GAAS7C,EACzBgD,EAAYI,EAAWhD,EAAQyC,KAE/BE,EAAQ3C,EAAQyC,GAAS7C,EACzBgD,EAAa5C,EAAQ0C,GAAS1C,EAAQyC,IAE1CzB,EAAaxB,MAAM,CACfqC,KAAMc,EAAQ,KACdQ,IAAK,OACL,mBAAoB,qBACpBtD,MAAO+C,EAAY,KACnB7C,OAASrB,EAAY,GAAM,KAC3BuD,SAAU,WACV,WAAY,EACZ,aAAc,yBAItB,SAAiB/F,EAAKC,GA+BlB,GA7BuB,qBAAZA,IACHA,EAAU,CACV,UAAY,EACZ,cAAgB,EAChB,aAAe,EACf,cAAgB,EAChB,SAAW,EACX,YAAc,EACd,KAAQ,QACR,QAAW,KAId2D,EAAEgO,GAAGC,UACN5R,EAAQ6R,YAAa,EACrBhQ,QAAQC,KAAK,+IAIb9B,EAAQ0C,UACRA,EAAU1C,EAAQ0C,SAEjB1C,EAAQ8R,OACT9R,EAAQ8R,KAAO,SAEf9R,EAAQ6C,YACRA,EAAY7C,EAAQ6C,YAGA,IAApB7C,EAAQ+R,QAAkB,CAE1B,IAAIC,EAAgBrO,EAAE5D,EAAM,eAAemB,OAASgC,GAAGC,OAAOpD,EAAM,eAAiBmD,GAAGC,OAAOpD,GAAKyF,OAAO,OAAOC,KAAK,QAAS,aAI5H,IAAK9B,EAAE5D,EAAM,qBAAqBmB,OAAQ,CACtC,IAAI+Q,EAAiBD,EAChBxM,OAAO,OACPC,KAAK,QAAS,mBACdpC,MAAM,UAAW,gBACjBA,MAAM,SAAU,iBAChBA,MAAM,UAAW,OACjBA,MAAM,cAAc,QACzB4O,EACKzM,OAAO,OACPC,KAAK,QAAS,kBACdpC,MAAM,UAAW,WACjBA,MAAM,UAAW,gBACjBA,MAAM,UAAW,OACjBA,MAAM,cAAc,OACpBgI,KAAK,iBACV4G,EACKzM,OAAO,OACPnC,MAAM,UAAW,gBACjBA,MAAM,UAAW,OACjBA,MAAM,eAAgB,OACtBmC,OAAO,OACPnC,MAAM,YAAY,QAClBoC,KAAK,KAAM,gBACX4F,KAAK,KAET1H,EAAE5D,EAAM,iBAAiBmB,UACtBgR,EAAaF,EACZxM,OAAO,OACPC,KAAK,QAAS,eACdpC,MAAM,UAAW,gBACjBA,MAAM,SAAU,gBAChBA,MAAM,UAAW,OACjBA,MAAM,cAAc,SAEpBmC,OAAO,OACPC,KAAK,QAAS,cACdpC,MAAM,UAAW,WACjBA,MAAM,UAAW,gBACjBA,MAAM,UAAW,OACjBA,MAAM,cAAc,OACpBgI,KAAK,WAEV6G,EACK1M,OAAO,OACPnC,MAAM,UAAW,gBACjBA,MAAM,UAAW,OACjBmC,OAAO,OACPnC,MAAM,YAAY,QAClBA,MAAM,eAAgB,OACtBmC,OAAO,QACP6F,KAAK,MACL7F,OAAO,QACPC,KAAK,QAAS,YACd4F,KAAK,MAqElB,IAAI6G,EAAavO,EAAE5D,EAAM,iBAAiBmB,OAASgC,GAAGC,OAAOpD,EAAM,iBAAmBiS,EACtF,IAA2B,IAAvBhS,EAAQ6R,aACHlO,EAAE5D,EAAM,iBAAiBmB,OAAQ,CAClC,IAAIiR,EAAc,8MAE4CzP,EAAQiI,WAAa,IAAM3K,EAAQ8R,KAAM,kBAEtFI,EACZ1M,OAAO,OAGPnC,MAAM,UAAW,gBAEjBA,MAAM,SAAU,OAChBA,MAAM,eAAgB,OAEtBA,MAAM,UAAW,OAEjBmC,OAAO,KACPC,KAAK,OAAQ,UACbA,KAAK,QAAS,eACdA,KAAK,cAAe,WACpBA,KAAK,iBAAkB,aACvBA,KAAK,QAAS,QACdA,KAAK,eAAgB0M,GACrB9O,MAAM,YAAa,QAGnBmC,OAAO,QACPC,KAAK,QAAS,mCACdpC,MAAM,cAAc,OAEpBA,MAAM,gBAAgB,OAMtBA,MAAM,aAAa,sCACnBA,MAAM,QAAQ,QAEd8C,KAAK,wCACVxC,GAAE,WACEA,EAAE,2BAA2BiO,QAAQ,CAACzL,MAAM,IAC5CxC,EAAE5D,EAAM,iBAAiBmF,GAAG,mBAAmB,WAC7CvB,EAAEzD,MAAMkS,KAAK,UAAU/G,KAAK,WAE9B1H,EAAE5D,EAAM,iBAAiBmF,GAAG,mBAAmB,WAC7CvB,EAAEzD,MAAMkS,KAAK,UAAU/G,KAAK,eAMtC,IAAK1H,EAAE5D,EAAM,mBAAmBmB,OAAQ,CAEpC,IAEMmR,GAFgB1O,EAAE5D,EAAM,eAAemB,OAASgC,GAAGC,OAAOpD,EAAM,eAAiBmD,GAAGC,OAAOpD,GAAKyF,OAAO,OAAOC,KAAK,QAAS,cAGrGD,OAAO,OACPnC,MAAM,WAAY,YAClBA,MAAM,UAAU,QAEzCiP,GAA2B,EAE/BD,EACK7M,OAAO,QACPC,KAAK,QAAS,mBACdpC,MAAM,cAAe,QACrBgI,KAAK,2BACLnG,GAAG,SAAS,WACTqN,EAAqBD,GACY,IAA9BxP,EAAmB5B,QAClBsR,IAEJF,GAA4BA,KAIpC,IAAMG,EAAQJ,EACT7M,OAAO,OACPC,KAAK,QAAS,0BAGPgN,EAAMtM,KAAN,0DAA8DxG,EAA9D,2DAGZgE,EAAE,gBAAgBuB,GAAG,SAAS,WAClBvB,EAAE,kBAAkB+O,MAAK,WACrB,IAAIC,EAAQhP,EAAEzD,MACVkD,EAAKO,EAAEzD,MAAMuF,KAAK,MACnBkN,EAAMC,GAAG,aACRD,EAAME,SAASxN,SACfxD,QAAQiR,IAAI,KAAM1P,GAClBN,EAAmBiQ,OAAO3P,EAAI,GAC9BvB,QAAQiR,IAAI,OAAQhQ,GACpBsL,GAAmBtL,IAEnBjB,QAAQiR,IAAI,qBAM5BL,EAAMjN,OAAO,OACRC,KAAK,SAAU,UACfA,KAAK,QAAS,UACdpC,MAAM,WAAY,YAClBA,MAAM,MAAO,KACbA,MAAM,QAAS,KACfA,MAAM,SAAU,QAChBA,MAAM,SAAU,WAChB6B,GAAG,SAAS,WACTqN,GAAqB,MAExB9M,KAAK,UAAU,eACfU,KAAKzG,GAEd,IAAMsT,EAAiBP,EAClBjN,OAAO,OACPC,KAAK,QAAS,mBAEnB,SAASwN,EAAkBjF,EAAOzK,EAAM2P,GACpC,OAAO3P,GACH,IAAK,WAAYT,EAAmBoQ,GAAKpN,SAAWkI,EACpCrK,EAAE,IAAD,OAAKuP,EAAL,cAAqB7H,MAAK,WACvB,OAAOvL,EAASqT,OAAOnF,EAAM,MAEjClL,EAAmBoQ,GAAK/E,SAAWrO,EAASqT,OAAOnF,EAAM,GACzD,MAChB,IAAK,UAAWlL,EAAmBoQ,GAAKzR,QAAUuM,GAS1D,SAASwE,IACL,IAAMY,EAAgB,CAAEtN,SAAU,GAAIqI,SAAU,GAAI1M,QAAS,IAE7DqB,EAAmBuF,KAAK+K,GAExB,IAAMC,EAAeL,EAAexN,OAAO,OAG3C6N,EAAa7N,OAAO,SACnBC,KAAK,OAAQ,YACbA,KAAK,QAAS,kBACdA,KAAK,MAAM,WACR,OAAO3C,EAAmB5B,OAAS,KAGvC6I,OAAOqG,KAAKgD,GAAehL,SAAQ,SAASkL,GAExC,GAAW,aAARA,EACCD,EACC7N,OAAO,QACPC,KAAK,MAAM,WACR,OAAO3C,EAAmB5B,OAAS,EAAI,IAAMoS,KAEhDjQ,MAAM,aAAc,UACpBgI,KAAK,UACH,GAAW,aAARiI,EACND,EACC7N,OAAO,SACPC,KAAK,QAAS,eACdA,KAAK,YAAa,KAClBA,KAAK,MAAM,WACR,OAAO3C,EAAmB5B,OAAS,EAAI,IAAMoS,KAEhD7N,KAAK,SAAS,SAASkC,EAAGsC,GACvB,OAAOA,KAEV/E,GAAG,UAAU,SAASyC,GACnB,IAAIqG,EAAQ9K,GAAGC,OAAOjD,MAAM+N,SAAS,SACjCiF,EAAMhQ,GAAGC,OAAOjD,MAAM+N,SAAS,MAAMjE,MAAM,KAAK,GACpDiJ,EAAkBjF,EAAOsF,EAAKJ,UAE/B,CACH,IAAMK,EAAWF,EAChB7N,OAAO,OACPC,KAAK,QAAS,YAEf8N,EACC/N,OAAO,UACPC,KAAK,QAAS,gBACdA,KAAK,MAAM,WACR,OAAO3C,EAAmB5B,OAAS,EAAI,IAAMoS,KAEhDjI,KAAK,kBACLnG,GAAG,SAAS,WACT,IAAI9B,EAAKO,EAAEzD,MAAMuF,KAAK,MACtB9B,EAAE,wBAAwB6P,IAA1B,WAAkCpQ,EAAlC,cAAiDqQ,OACjD9P,EAAE,IAAD,OAAKP,EAAL,cAAoBsQ,YAGzB,IAAMC,EAAoBJ,EAAS/N,OAAO,OACzCC,KAAK,MAAM,WACR,OAAO3C,EAAmB5B,OAAS,EAAI,IAAMoS,EAAM,eAEtD7N,KAAK,QAAS,oBAEfkO,EAAkBnO,OAAO,SACxBC,KAAK,cAAe,aACpBA,KAAK,KAAM,yBACXP,GAAG,SAAS,WACT,IAAWiG,EAAQgB,EAAGlC,EAKtB,IAHAkB,EADQxK,SAASC,eAAe,yBACjBoN,MAAM4F,cAErBzH,GADApM,EAAMY,SAASC,eAAe,uBACtBiT,qBAAqB,KACxB5J,EAAI,EAAGA,EAAIkC,EAAEjL,OAAQ+I,IACxB6J,SAAW3H,EAAElC,GAAG8J,aAAe5H,EAAElC,GAAG+J,UAChCF,SAASF,cAAcK,QAAQ9I,IAAW,EAC5CgB,EAAElC,GAAG5G,MAAM6Q,QAAU,GAErB/H,EAAElC,GAAG5G,MAAM6Q,QAAU,UAKL,CAAC,IAAK,IAAK,IAAK,KAExB9H,KAAI,SAACzE,GACjBgM,EAAkBnO,OAAO,KACxBC,KAAK,QAAS,oBACdA,KAAK,KAAMkC,GACX0D,KAAK1D,UAMtBhE,EAAEhD,UAAUuE,GAAG,QAAS,qBAAqB,WACzC,IAAM8I,EAAQrK,EAAEzD,MAAMuF,KAAK,MAC3B9B,EAAE,qBAAqB8P,OAEvB,IAAMrQ,EAAKO,EAAEzD,MAAM2S,SAASA,SAASsB,SAAS,UAAU1O,KAAK,MACvD2O,EAAQhR,EAAG4G,MAAM,KAAK,GACtBzG,EAAOH,EAAG4G,MAAM,KAAK,GAE3BrG,EAAEzD,MAAM2S,SAASA,SAASsB,SAAS,UAAU9I,MAAK,WAC9C,OAAO2C,KAGXiF,EAAkBjF,EAAOzK,EAAM6Q,MAGnC,IAAMC,EAAe5B,EAAMjN,OAAO,OACTC,KAAK,QAAS,kCAmBvC,SAAS8M,EAAqB/E,GAC1BiF,EACCpP,MAAM,UAAWmK,EAAY,QAAU,QAnB5C6G,EACS7O,OAAO,QACPC,KAAK,QAAS,mBACd4F,KAAK,KACLnG,GAAG,SAAS,WACTkJ,GAAmBtL,GACnB0P,OAGZ6B,EACS7O,OAAO,QACP6F,KAAK,mBACL5F,KAAK,QAAS,uBACdP,GAAG,SAAS,WACTmM,GAAqBvO,MAQjCuP,EACC7M,OAAO,QACHC,KAAK,QAAS,uBACd4F,KAAK,mBACLnG,GAAG,SAAS,WACVmM,GAAqBvO,MAKxCf,EAAMmB,GAAGC,OAAOpD,GAAKyF,OAAO,OACvBC,KAAK,QAAS/B,EAAQD,EAAcA,GACpCgC,KAAK,SAAU7B,EAASH,EAAaA,GACrCJ,MAAM,UAAW,KACjB6B,GAAG,eAAe,SAAUyC,EAAGsC,GAC5B/G,GAAGgE,MAAMoN,iBACTpD,QAGRzQ,EAAaC,EAAGmT,qBAAqB,OAAO,GAQ5C,IAAIU,GALJvS,EAAeD,EACVyD,OAAO,KACPC,KAAK,YAAa,aAAehC,EAAc,IAAMA,EAAa,MAG/C+B,OAAO,QAE/B+O,EAAK/O,OAAO,YACPC,KAAK,KAAM,QACXD,OAAO,QACPC,KAAK,QAAS/B,GACd+B,KAAK,SAAU7B,GAEpB,IAAIuH,EAASoJ,EAAK/O,OAAO,UACpBC,KAAK,KAAM,cACXA,KAAK,SAAU,QAEpB0F,EAAO3F,OAAO,kBACTC,KAAK,KAAM,eACXA,KAAK,eAAgB,GACrBA,KAAK,SAAU,QACpB0F,EAAO3F,OAAO,YACTC,KAAK,KAAM,QACXA,KAAK,MAAO,GACZA,KAAK,KAAM,GACXA,KAAK,SAAU,cAEpB,IA3kDcK,EA2kDV0O,EAAUrJ,EAAO3F,OAAO,WAE5BgP,EAAQhP,OAAO,eACVC,KAAK,KAAM,cAChB+O,EAAQhP,OAAO,eACVC,KAAK,KAAM,iBAEhBzD,EAAakD,GAAG,aAAa,WACzB,IAAII,EAAmBlE,EAAWE,YAAc4B,GAAGkB,MAAMlB,GAAGC,OAAO,eAAe4B,QAAU7B,GAAGkB,MAAMpC,EAAa+C,QAClH5C,EAASkI,KAAKC,MAAMpG,EAAgBoB,EAAiB,KACrDlD,EAAiBD,EACZnC,EAAQyU,wBACTtS,GAAUrC,EAASqC,EAAO,IAAM,IAEpCwB,EAAE5D,EAAM,kBAAkBsL,KAAKlJ,MAGG,qBAA3BnC,EAAQwB,iBACfJ,EAAWI,eAAiBxB,EAAQwB,gBAEpCxB,EAAQqB,eAAkBP,IAC1BM,EAAWC,cAAe,EACtBuG,EAAgBlG,EAAOE,IAAMF,EAAOC,OACpCiL,GAAQ9M,SAASA,EAASe,UAAUa,EAAOC,MAAM,EAAGD,EAAOE,KAAMW,EAAWb,EAAOC,OAGnFiL,GAAQ0B,eAEZnN,EAASkH,KAAK,CACV4C,KAAMnL,EACNgN,KAAM,WACNgC,UAAW,KACXtL,MAAO,QACPD,KAAM,SAEVjB,EAAM+F,KAAK,CACPiD,MAAO,WACPpF,EAAG3D,EAAY,KAGnBvC,EAAQ0U,WAnnDE5O,EAmnDiBvD,EAlnD/BP,EAAawD,OAAO,KACfC,KAAK,QAAS,gBACdA,KAAK,YAAa,gBAAkBK,EAAW,IAAM,KACrDkJ,KAAK5F,IAyBVnH,EAAWF,EAAIyD,OAAO,KACjBC,KAAK,QAAS,YACdA,KAAK,YAAa,eAAiBhC,EAAa,KACrDuH,KAqlDIhL,EAAQsB,cACRF,EAAWE,aAAc,EApyB7BU,EAAawD,OAAO,KACfC,KAAK,QAAS,SACduJ,KAAKkB,IACL9K,UAAU,QACVK,KAAK,SAAUlD,EAAY,KAoyB5BvC,EAAQuB,eACRH,EAAWG,cAAe,EA7lBlC,WACI,IAAIoT,EAAWzR,GAAGC,OAAO,UACpBqC,OAAO,OACPC,KAAK,QAAS,SACdpC,MAAM,WAAY,YAClBA,MAAM,UAAW,MACjBA,MAAM,QAAS,OACfA,MAAM,SAAWd,EAAY,GAAM,MACnCc,MAAM,MAAO,QAEbA,MAAM,aAAc,QAEzBH,GAAGC,OAAO,UACL+B,GAAG,mBAAmB,WACnB0P,OAAS1R,GAAGkB,MAAMlE,MAAM,GAAK,EAC7ByU,EAAStR,MAAM,OAAQuR,OAAS,SA+kBpCC,IAGJjK,GAAgBrI,GAIpBuS,CAAQ/U,EAAKC,GAkCbE,KAAK6U,WAAa,SAAU9R,GA9pD5B,IAAqB6C,EA+pDjBvD,GAAa,GACbpB,EAASkH,KAAKpF,GACd2J,GAAQC,eAAe5J,GACvB+H,KAlqDiBlF,EAmqDLvD,EAlqDZP,EAAaoD,UAAU,UAClBK,KAAK,YAAa,gBAAkBK,EAAW,IAAM,KAkqD1D8E,GAAgBrI,GACZnB,EAAWE,aACXU,EAAaoD,UAAU,eAClBK,KAAK,SAAUlD,EAAY,IAEhCnB,EAAWG,cAAc2B,GAAGkC,UAAU,UAAU/B,MAAM,SAAWd,EAAY,GAAM,MACnFW,GAAGkC,UAAU,YAAY,GAAGlE,OAAS,OAAM2B,GAAY,IAI/D3C,KAAK8U,cAAgB,WACjBrR,EAAEgK,QAAQsH,IAAI,SAAU9D,IACxBpP,EAAM,KACNtB,EAAa,KACbuB,EAAe,KACfE,EAAgB,KAChBD,EAAW,KACXd,EAAW,KACX0I,OAAS,KACT3G,GAAGwB,OAAS,O,oBCvpExB,YAaAwQ,EAAOC,OAASxR,EAAIlE,EAAQ,IAC5ByD,GAAKzD,EAAQ,IACbA,EAAQ,IACRA,EAAQ,IAERA,EAAQ,IAER,IAAM2V,EAAgB3V,EAAQ,IAGxB4V,EAAW5V,EAAQ,IACnB6V,EAAU7V,EAAQ,IAAR,QACV8V,EAAgB9V,EAAQ,IAAR,cAGhB+V,EAAkB/V,EAAQ,IAEhCA,EAAQ,IAAgBgW,MAAML,EAAcM,WAC5C9V,EAAOC,QAAU,CAAEuV,gBAAeC,WAAUC,UAASC,gBAAeC,qB,6EC2DpE5V,EAAOC,QAAU,CAAEH,UA1FD,+oBA0FYC,WAxFX,8lG,mBCFnB,IAAMyV,EAAgB3V,EAAQ,IAGxB6V,GADW7V,EAAQ,IACTA,EAAQ,IAAR,SACV8V,EAAgB9V,EAAQ,IAAR,cAyCtB,SAASkW,EAAUC,EAASC,EAAUC,GAClCC,kBAAoB,GAEpB,IAAK,IAAI9L,EAAI,EAAGA,EAAI2L,EAAQ1U,OAAQ+I,IAAK,CACrC,IAAIjH,EAAOsS,EAAQU,4BAA4BJ,EAAQ3L,GAAI4L,EAAS5L,GAAG6C,KAAM+I,EAAS5L,GAAGkB,QACrF8K,EAAgBV,EAAcW,qBAAqBlT,EAAM6S,EAAS5L,IACtE8L,kBAAkB1N,KAAK4N,GAE3B,OAAOF,kBAyBX,SAASI,EAAaC,EAAcC,GAChCxU,QAAQiR,IAAI,OACZ,IAAIwD,EAAOpW,KACX,OAAO,IAAIqW,SAAQ,SAASC,EAASC,GACjCF,QAAQG,IA1BhB,SAA2BC,EAAIC,EAAMC,GAEjC,IAAI5L,EAAO,GACX,IAAK,IAAIjI,KAAQ4T,EACb,OAAQA,EAAK5T,IACb,IAAK,WACDiI,EAAK5C,KAAKsO,EAAGG,mBAAmBD,IAChC,MACJ,IAAK,WACD5L,EAAK5C,KAAKsO,EAAGI,YAAYF,IACzB,MACJ,IAAK,kBACD5L,EAAK5C,KAAKsO,EAAGK,kBAAkBH,IAC/B,MACJ,QACI5L,EAAK5C,KAAKsO,EAAGM,yBAAyBJ,EAAOD,EAAK5T,KAI1D,OAAOiI,EAOSiM,CAAkBZ,EAAKa,SAAUf,EAAcE,EAAKO,QAC3DO,MAAK,SAAUxB,IAhD5B,SAAwBG,EAAmBD,GAEvC,IADA,IAAIuB,EAAUvB,EAAOwB,QACZrN,EAAI,EAAGA,EAAI8L,EAAkB7U,OAAQ+I,IAC1C,GAAiD,IAA7CF,OAAOqG,KAAK2F,EAAkB9L,IAAI/I,QAAgB6U,EAAkB9L,GAAGsN,eAAeF,GAAU,CAChG,IAAIG,EAAUrC,OAAOsC,OAAO,GAAI1B,EAAkB9L,GAAGoN,IACrDvB,EAAOf,WAAWyC,IA6CdE,CADwB/B,EAAUC,EAASS,GACTC,GAClCE,EAAQF,MACTqB,OAAM,SAAUC,GAEf/V,QAAQiR,IAAI,iBAAmB8E,EAAIC,SACnChW,QAAQiR,IAAI,mBAAqB8E,EAAIE,aAMQ,kBAAnBlY,EAAOC,UAC7CD,EAAOC,QAvFX,SAAyB8W,EAAIE,EAAO9W,EAAKC,GAErC,OADW2W,EACJ,IAAIJ,SAAQ,SAASC,EAASC,GACjC,IAAIsB,EACAT,EAAUT,EAEd,GAAIA,EAAMmB,WAAW,OAAQ,CACzB,IAAIC,EAAQX,EAAQtN,MAAM,KAAK,GAAKsN,EAAUA,EAAQtN,MAAM,KAAK,GAAK,KAClEkO,EAAUZ,EAAQtN,MAAM,KAAK,GACjC2M,EAAGG,mBAAmBoB,GAASd,MAAK,SAAUnM,GAC1C,IACInL,EADSmL,EAAKE,QAAO,SAASgN,GAAM,OAAOA,EAAIC,aAAeH,KAC5C,GAAGnY,SAEzBsV,EAAcM,UAAU4B,QAAUW,EAClC7C,EAAcM,UAAUmB,MAAQqB,EAChC9C,EAAcM,UAAUyB,SAAWR,EACnCvB,EAAcM,UAAUS,aAAeA,EACvC4B,EAAK,IAAI3C,EAActV,EAAUC,EAAKC,GACtCwW,EAAQuB,a,yKC1BjB,SAAeM,EAAtB,kC,4CAAO,WAA2BxB,GAA3B,eAAA1K,EAAA,sEAECmM,IACHC,IADG,yCACmC1B,EADnC,MAEHO,MAAK,SAAUoB,GAEd3W,QAAQiR,IAAI0F,GACZC,EAAMD,EAASvN,KAAK4L,MAAM6B,SAC1B7W,QAAQiR,IAAI0F,EAASvN,KAAK4L,MAAM6B,aAEjCf,OAAM,SAAUgB,GAEf9W,QAAQiR,IAAI6F,MAZX,gCA2BEF,GA3BF,4C,iCCwCQG,EAjCC,SAAC,GAA2D,IAAzDC,EAAwD,EAAxDA,oBAAqBC,EAAmC,EAAnCA,eAAmC,EACzCC,qBADyC,mBAClEL,EADkE,KACxDM,EADwD,OAE3CD,oBAAS,GAFkC,mBAElEE,EAFkE,KAEzDC,EAFyD,KAczE,OAVAC,qBAAU,WACR,sBAAC,4BAAAhN,EAAA,sEACiBkM,EAAY,aAD7B,OACKI,EADL,OAEC5W,QAAQiR,IAAI,MAAO2F,GACnBO,EAAYP,GAHb,0CAAD,GAIKrB,MAAK,WACR8B,GAAW,QAEZ,IAECD,EACK,0CAIP,8BACGP,GAAYA,EAASxX,OAAS,EAC7B,wBAAQ8M,MAAO8K,EAAgBM,SAAU,SAAC7L,GAAD,OAAOsL,EAAoBtL,IAApE,gBACGmL,QADH,IACGA,OADH,EACGA,EAAUtM,KAAI,SAACnC,GAAD,OACb,wBAAQ+D,MAAO/D,EAAEmO,WAAjB,SAA8BnO,EAAEoP,eAAevM,YAInD,4CAAe4L,GAAYA,EAAS,GAAGW,eAAevM,WC/BjDwM,EAAkB,CAC7B5E,UAAU,EACVrT,cAAc,EACdC,aAAa,EACbyQ,SAAS,EACTF,YAAY,EACZnP,QAAS,GACTjB,SAAS,GAWE8X,EAAe,CAC1B,CACEzM,KAAM,iBACN7B,KAAM,CACJ,CAAExG,EAAG,IAAKyB,EAAG,IAAKF,YAAa,QAAS5C,GAAI,MAC5C,CAAEqB,EAAG,GAAIyB,EAAG,IAAKF,YAAa,QAAS5C,GAAI,MAC3C,CAAEqB,EAAG,GAAIyB,EAAG,IAAKF,YAAa,QAAS5C,GAAI,MAC3C,CAAEqB,EAAG,GAAIyB,EAAG,GAAIF,YAAa,QAAS5C,GAAI,MAC1C,CAAEqB,EAAG,IAAKyB,EAAG,IAAKF,YAAa,QAAS5C,GAAI,MAC5C,CAAEqB,EAAG,GAAIyB,EAAG,GAAIF,YAAa,QAAS5C,GAAI,MAC1C,CAAEqB,EAAG,GAAIyB,EAAG,IAAKF,YAAa,QAAS5C,GAAI,MAC3C,CAAEqB,EAAG,GAAIyB,EAAG,GAAIF,YAAa,QAAS5C,GAAI,MAC1C,CAAEqB,EAAG,GAAIyB,EAAG,IAAKF,YAAa,QAAS5C,GAAI,OAE7C0L,UAAW,QACXtL,MAAO,UACPD,KAAM,eACN4H,OAAQ,SAEV,CACEF,KAAM,CACJ,CAAExG,EAAG,GAAIyB,EAAG,GAAIF,YAAa,YAAa5C,GAAI,OAEhD0J,KAAM,aACNgC,UAAW,QACXtL,MAAO,UACPD,KAAM,OACN4H,OAAQ,SAEV,CACEF,KAAM,CACJ,CAAExG,EAAG,IAAKyB,EAAG,KACb,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,MAEd4G,KAAM,iBACNgC,UAAW,QACXtL,MAAO,UACPD,KAAM,OACN4H,OAAQ,SAEV,CACEF,KAAM,CACJ,CAAExG,EAAG,IAAKyB,EAAG,KACb,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,IAAKyB,EAAG,KACb,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,GAAIyB,EAAG,MAEd4G,KAAM,iBACNgC,UAAW,QACXtL,MAAO,UACPD,KAAM,eACN4H,OAAQ,SAEV,CACEF,KAAM,CACJ,CAAExG,EAAG,IAAKyB,EAAG,KACb,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,IAAKyB,EAAG,KACb,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,GAAIyB,EAAG,MAEd4G,KAAM,iBACNgC,UAAW,QACXtL,MAAO,SACPD,KAAM,OACNK,OAAQ,EACRuH,OAAQ,SAEV,CACEF,KAAM,CACJ,CAAExG,EAAG,IAAKyB,EAAG,KACb,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,IAAKyB,EAAG,KACb,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,GAAIyB,EAAG,KACZ,CAAEzB,EAAG,GAAIyB,EAAG,IACZ,CAAEzB,EAAG,GAAIyB,EAAG,KAEd4G,KAAM,iBACNgC,UAAW,QACXtL,MAAO,QACPD,KAAM,OACN4H,OAAQ,U,uCCnHL,SAASqO,EAAT,GAAwE,IAA3CC,EAA0C,EAA1CA,QAASxO,EAAiC,EAAjCA,KAAMyO,EAA2B,EAA3BA,SAA2B,EAAjBC,SAC3D,GAAiB,QAAbD,EAAoB,CACtB,IAAME,EAAcH,EAAQrN,KAAI,SAACyN,GAAD,OAAcA,EAAIC,eAC5CC,EAAYC,IAAKC,QAAQ,CAAEC,OAAQN,EAAa3O,SACtD,OAAO,IAAIkP,KAAK,CAACJ,GAAY,CAAExW,KAAM,cCOzC,IAAM6W,EAAqB,CACzB,CACEC,OAAQ,SACRC,SAAU,KACVC,KAAM,SAACC,GACL,OAAO,8BAAMzZ,OAAOyZ,EAAIA,IAAIpX,IAAM,MAGtC,CACEiX,OAAQ,WACRC,SAAU,YAEZ,CACED,OAAQ,WACRC,SAAU,YAEZ,CACED,OAAQ,UACRC,SAAU,WAEZ,CACED,OAAQ,OACRC,SAAU,QAEZ,CACED,OAAQ,WACRC,SAAU,aAQd,SAASG,EAAT,GAIS,IAHPC,EAGM,EAHNA,sBACAC,EAEM,EAFNA,aACAC,EACM,EADNA,gBAEMC,EACJH,EAAsBxZ,OAAS,EAAIwZ,EAAsBxZ,OAAS,EAF9D,EAIoB6X,mBAAS4B,GAJ7B,mBAIC3M,EAJD,KAIQ8M,EAJR,KAMA1B,EAAW2B,4BAAiB,SAAC/M,GACjC4M,EAAgB5M,QAAS3H,KACxB,KAEH,OACE,uBACEyI,UAAU,eACVd,MAAOA,GAAS,GAChBoL,SAAU,SAAC7L,GACTuN,EAASvN,EAAEyN,OAAOhN,OAClBoL,EAAS7L,EAAEyN,OAAOhN,QAEpBiN,YAAW,iBAAYJ,EAAZ,iBAKjB,IA0JeK,EA1JD,SAACC,GAAuB,IAC5BlQ,EAASkQ,EAATlQ,KAEFwO,EAAU2B,mBAAQ,kBAAMhB,IAAoB,IAHf,EAwB/BiB,mBACF,CAEE5B,UACAxO,OACAuO,oBAEA8B,aAAc,CAAEC,UAAW,EAAGC,SAAU,IAE1CC,kBACAC,gBACAC,KA7BAC,EANiC,EAMjCA,cACAC,EAPiC,EAOjCA,kBACAC,EARiC,EAQjCA,aACAC,EATiC,EASjCA,WACAC,EAViC,EAUjCA,KACAC,EAXiC,EAWjCA,MACAC,EAZiC,EAYjCA,gBACAC,EAbiC,EAajCA,YACAC,EAdiC,EAcjCA,YACAC,EAfiC,EAejCA,UACAC,EAhBiC,EAgBjCA,SACAC,EAjBiC,EAiBjCA,SACA7B,EAlBiC,EAkBjCA,sBACAE,EAnBiC,EAmBjCA,gBACA4B,EApBiC,EAoBjCA,aACAC,EArBiC,EAqBjCA,YArBiC,IAsBjCR,MAASV,EAtBwB,EAsBxBA,UAAWC,EAtBa,EAsBbA,SACpBkB,EAvBiC,EAuBjCA,WAeF,OACE,sBAAK5N,UAAU,0BAAf,UACE,sBAAKA,UAAU,eAAf,UACE,cAAC2L,EAAD,CACEC,sBAAuBA,EACvBC,aAAcsB,EAAMtB,aACpBC,gBAAiBA,IAEnB,wBACE9L,UAAU,aACV6N,QAAS,WACPD,EAAW,OAAO,IAHtB,kCASF,kDAAWd,KAAX,IAA4B9M,UAAU,qBAAtC,UACE,gCACGgN,EAAa1P,KAAI,SAACwQ,GACjB,OACE,8CAAQA,EAAYC,uBAApB,aACGD,EAAYE,QAAQ1Q,KAAI,SAAC2Q,GACxB,OACE,4CACE1Z,MAAO,CACL2Z,gBACgB,aAAdD,EAAO3Z,IAAmC,SAAd2Z,EAAO3Z,GAC/B,UACA,SAEJ2Z,EAAOE,kBAPb,aASGF,EAAOG,OAAO,wBAQ7B,iDAAWrB,KAAX,aACGG,EAAK5P,KAAI,SAACoO,GAET,OADAuB,EAAWvB,GAET,8CAAQA,EAAI2C,eAAZ,aACG3C,EAAI4C,MAAMhR,KAAI,SAACiR,GACd,OACE,8CAAQA,EAAKC,gBAAb,aAA8BD,EAAKH,OAAO,2BAQvC,IAAhBjS,EAAK/J,OACJ,oBAAG4N,UAAU,aAAb,UACE,2GADF,OAQA,sBAAKA,UAAU,aAAf,UACE,wBAAQ6N,QAAS,kBAAML,EAAS,IAAIiB,UAAWrB,EAA/C,SACG,OACO,IACV,wBAAQS,QAAS,kBAAMH,KAAgBe,UAAWrB,EAAlD,SACG,MACO,IACV,wBAAQS,QAAS,kBAAMJ,KAAYgB,UAAWpB,EAA9C,SACG,MACO,IACV,wBACEQ,QAAS,kBAAML,EAASD,EAAY,IACpCkB,UAAWpB,EAFb,SAIG,OACO,IACV,wCACO,IACL,mCACGZ,EAAY,EADf,OACsBa,EAAYlb,UACxB,OAEZ,iDACgB,IACd,uBACEqC,KAAK,SACLia,aAAcjC,EAAY,GAAK,EAC/BnC,SAAU,SAAC7L,GACT,IAAMyO,EAAOzO,EAAEyN,OAAOhN,MAAQjN,OAAOwM,EAAEyN,OAAOhN,OAAS,EAAI,EAC3DsO,EAASN,SAGP,IACR,wBACEhO,MAAOwN,EACPpC,SAAU,SAAC7L,GACTkP,EAAY1b,OAAOwM,EAAEyN,OAAOhN,SAHhC,SAMG,CAAC,GAAI,GAAI,GAAI,GAAI,IAAI5B,KAAI,SAACoP,GAAD,OACxB,yBAAuBxN,MAAOwN,EAA9B,kBACQA,IADKA,eC5GZiC,EAzFgB,WAAO,IAAD,EACX1E,mBAA6B,IADlB,mBAC5B9N,EAD4B,KACtByS,EADsB,OAES3E,qBAFT,mBAE5BD,EAF4B,KAEZ6E,EAFY,KA6EnC,OAhEAxE,qBAAU,WAoCRxY,SAASC,eA7CU,OA6CoBgd,UAAY,GAEnD,IAAIC,EAAK,IAAIzI,gBHtEf,4FGsEW,WA/CU,OAkDjBkE,GAGFC,EAAanN,KAAI,SAACoL,GAChBqG,EAAG9I,WAAWyC,MAGhBqG,EAAG/U,gBAAe,SAACnB,GACjB+V,EAAQ,YAAI/V,EAAER,YAGhB0W,EAAGhV,kBAAiB,SAAClB,GACnB,IAAMyL,EAAgBzL,EAAER,OAExBiM,EAAchH,KAAI,SAAC8B,GACjBA,EAAE4P,KAAOzT,KAAK0T,SAASpN,QAAQ,GAC/BzC,EAAE8P,SAAW3T,KAAK0T,SAASpN,QAAQ,MAGrC+M,EAAQtK,QAET,IAGD,sBAAKtE,UAAU,mBAAf,UACE,cAAC,EAAD,CACEgK,eAAgBA,EAChBD,oBA3EN,SAA6BtL,GAC3B1L,QAAQiR,IAAIvF,EAAEyN,OAAOhN,OACrB2P,EAAkBpQ,EAAEyN,OAAOhN,OAE3B0P,EAAQ,OAyEN,qBAAKta,GAAG,QACR,cAAC,EAAD,CAAO6H,KAAMA,QC3FJgT,G,MATH,WACV,OACE,sBAAKnP,UAAU,MAAf,UACE,qBAAKoP,IAAI,oBAAoBpP,UAAU,OAAOqP,IAAI,kBAClD,cAACC,EAAD,SCMSC,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,6BAAqBnH,MAAK,YAAkD,IAA/CoH,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCHdO,IAAS3B,OACP,cAAC,IAAM4B,WAAP,UACE,cAAC,EAAD,MAEFne,SAASC,eAAe,SAM1Byd,M","file":"static/js/main.7d1f403d.chunk.js","sourcesContent":["const { crossIcon, deleteIcon } = require('../utils/icons')\nfunction createFeature(sequence, div, options) {\n//        var nxSeq = sequence.startsWith('NX_') ? true : false;\n        var self = this;\n        // if (!div) var div = window;\n        this.events = {\n          FEATURE_SELECTED_EVENT: \"feature-viewer-position-selected\",\n            FEATURE_DESELECTED_EVENT: \"feature-viewer-position-deselected\",\n          ZOOM_EVENT: \"feature-viewer-zoom-altered\",\n          GET_PREDICTIONS_EVENT: \"feature-viewer-vep-predictions\",\n          VARIANT_ADDED_EVENT: \"feature-viewer-variant-added\"\n        };\n\n        // if (!div) var div = window;\n        var div = div;\n        var el = document.getElementById(div.substring(1));\n        var svgElement;\n        var sequence = sequence;\n        var intLength = Number.isInteger(sequence) ? sequence : null;\n        var fvLength = intLength | sequence.length;\n        var features = [];\n        var SVGOptions = {\n            showSequence: false,\n            brushActive: false,\n            verticalLine: false,\n            dottedSequence: true,\n            variant: false\n        };\n        var offset = {start:1,end:fvLength};\n        if (options && options.offset) {\n            offset = options.offset;\n            if (offset.start < 1) {\n                offset.start = 1;\n                console.warn(\"WARNING ! offset.start should be > 0. Thus, it has been reset to 1.\");\n            }\n        }\n        var pathLevel = 0;\n        var svg;\n        var svgContainer;\n        var filter;\n        var yData = [];\n        var yAxisSVG;\n        var yAxisSVGgroup;\n        var Yposition = 20;\n        var level = 0;\n        var seqShift = 0;\n        var zoom = false;\n        var zoomMax = 50;\n        var current_extend = { \n                    length : offset.end - offset.start,\n                    start : offset.start,\n                    end : offset.end\n                }\n        var featureSelected = {};\n        var animation = true;\n        \n        let seqPos; // Stores sequence + its position\n        let absoluteSeqPos; // Store only sequence position\n        let variantInputValues = []; // Entered variant values\n\n        function colorSelectedFeat(feat, object) {\n            //change color && memorize\n            if (featureSelected !== {}) d3.select(featureSelected.id).style(\"fill\", featureSelected.originalColor);\n            if (object.type !== \"path\" && object.type !== \"line\"){\n                featureSelected = {\"id\": feat, \"originalColor\": d3.select(feat).style(\"fill\") || object.color};\n                d3.select(feat).style(\"fill\", \"orangered\");\n            }\n        }\n\n        /**\n         * Private Methods\n         */\n\n            //Init box & scaling\n        d3.select(div)\n            .style(\"position\", \"relative\")\n            .style(\"padding\", \"0px\")\n            .style(\"z-index\", \"2\");\n\n        var margin = {\n                top: 10,\n                right: 20,\n                bottom: 20,\n                left: 110\n            },\n            width = $(div).width() - margin.left - margin.right - 17,\n            height = 600 - margin.top - margin.bottom;\n        var scaling = d3.scale.linear()\n            .domain([offset.start, offset.end])\n            .range([5, width-5]);\n        var scalingPosition = d3.scale.linear()\n            .domain([0, width])\n            .range([offset.start, offset.end]);\n        \n        \n        \n\n        function updateLineTooltip(mouse,pD){\n            var xP = mouse-110;\n            var elemHover = \"\";\n            for (var l=0; l<pD.length;l++) {\n                if (scaling(pD[l].x) < xP && scaling(pD[l+1].x) > xP) {\n                    if ((xP - scaling(pD[l].x)) < (scaling(pD[l+1].x) - xP )) {\n                        elemHover = pD[l];\n                    }\n                    else elemHover = pD[l+1];\n                    break;\n                }\n            }\n            return elemHover;\n        }\n        \n        d3.helper = {};\n\n        d3.helper.tooltip = function (object) {\n            var tooltipDiv;\n            var selectedRect;\n            var bodyNode = d3.select(div).node();\n            var tooltipColor = options.tooltipColor ? options.tooltipColor : \"orangered\";\n\n            function tooltip(selection) {\n\n                selection.on('mouseover.tooltip', function (pD, pI) {\n                    // Clean up lost tooltips\n                    d3.select('body').selectAll('div.tooltip').remove();\n                    // Append tooltip\n                    var absoluteMousePos = d3.mouse(bodyNode);\n                    var rightside = (absoluteMousePos[0] > width);\n                    if (rightside) {\n                        tooltipDiv = d3.select(div)\n                            .append('div')\n                            .attr('class', 'tooltip3');\n                    } else {\n                        tooltipDiv = d3.select(div)\n                            .append('div')\n                            .attr('class', 'tooltip2');\n                        tooltipDiv.style({\n                            left: (absoluteMousePos[0] - 15) + 'px'\n                        });\n                    }\n                    tooltipDiv.style({\n                        bottom: (bodyNode.offsetHeight - absoluteMousePos[1] + 16) + 'px',\n                        'background-color': '#eee',\n                        width: 'auto',\n                        'max-width': '170px',\n                        height: 'auto',\n                        'max-height': '68px',\n                        padding: '5px',\n                        \"font\": '10px sans-serif',\n                        'text-align': 'center',\n                        position: 'absolute',\n                        'z-index': 45,\n                        'box-shadow': '0 1px 2px 0 #656565' \n                    });\n                    if (object.type === \"path\") {\n                        var first_line = '<p style=\"margin:2px;font-weight:700;color:' + tooltipColor +'\">' + pD[0].x + '&#x256d;&#x256e;' + pD[1].x + '</p>';\n                        if (pD.description) var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + pD.description + '</p>';\n                        else var second_line = '';\n                    } else if (object.type === \"line\") {\n                        var elemHover = updateLineTooltip(absoluteMousePos[0],pD);\n                        if (elemHover.description) {\n                            var first_line = '<p style=\"margin:2px;font-weight:700;color:' + tooltipColor +'\">' + elemHover.x + ' : <span> ' + elemHover.y + '</span></p>';\n                            var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + elemHover.description + '</p>';\n                        }\n                        else {\n                            var first_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">position : <span id=\"tLineX\">' + elemHover.x + '</span></p>';\n                            var second_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">count : <span id=\"tLineC\">' + elemHover.y + '</span></p>';\n                        }\n                    } else if (object.type === \"unique\" || pD.x === pD.y) {\n                        var first_line = '<p style=\"margin:2px;font-weight:700;color:' + tooltipColor +'\">' + pD.x + '</p>';\n                        if (pD.description) var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + pD.description + '</p>';\n                        else var second_line = '';\n                    } else {\n                        var first_line = '<p style=\"margin:2px;font-weight:700;color:' + tooltipColor +'\">' + pD.x + ' - ' + pD.y + '</p>';\n                        if (pD.description) var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + pD.description + '</p>';\n                        else var second_line = '';\n                    }\n\n                    tooltipDiv.html(first_line + second_line);\n                    if (rightside) {\n                        tooltipDiv.style({\n                            left: (absoluteMousePos[0] + 10 - (tooltipDiv.node().getBoundingClientRect().width)) + 'px'\n                        })\n                    }\n                })\n                    .on('mousemove.tooltip', function (pD, pI) {\n                    \n                        if (object.type === \"line\") {\n                            var absoluteMousePos = d3.mouse(bodyNode);\n                            var elemHover = updateLineTooltip(absoluteMousePos[0],pD);\n                            if (elemHover.description) {\n                                var first_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">' + elemHover.x + ' : <span> ' + elemHover.y + '</span></p>';\n                                var second_line = '<p style=\"margin:2px;color:' + tooltipColor +';font-size:9px\">' + elemHover.description + '</p>';\n                            }\n                            else {\n                                var first_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">position : <span id=\"tLineX\">' + elemHover.x + '</span></p>';\n                                var second_line = '<p style=\"margin:2px;color:' + tooltipColor +'\">count : <span id=\"tLineC\">' + elemHover.y + '</span></p>';\n                            }\n                            tooltipDiv.html(first_line + second_line);\n//                            $('#tLineX').text(elemHover.x);\n//                            $('#tLineC').text(elemHover.y);  \n                        }\n                        // Move tooltip\n                        // IE 11 sometimes fires mousemove before mouseover\n                        if (tooltipDiv === undefined) { return; }\n                        var absoluteMousePos = d3.mouse(bodyNode);\n                        var rightside = (absoluteMousePos[0] > width);\n                        if (rightside) {\n                            tooltipDiv.attr(\"class\", \"tooltip3\");\n                            tooltipDiv.style({\n                                left: (absoluteMousePos[0] + 10 - (tooltipDiv.node().getBoundingClientRect().width)) + 'px',\n                                bottom: (bodyNode.offsetHeight - absoluteMousePos[1] + 16) + 'px'\n                            });\n                        } else {\n                            tooltipDiv.attr(\"class\", \"tooltip2\");\n                            tooltipDiv.style({\n                                left: (absoluteMousePos[0] - 15) + 'px',\n                                bottom: (bodyNode.offsetHeight - absoluteMousePos[1] + 16) + 'px'\n                            })\n                        }\n                    })\n                    .on('mouseout.tooltip', function (pD, pI) {\n                        // Remove tooltip\n                        tooltipDiv.remove();\n                    })\n                    .on('click', function (pD, pI) {\n                        var xTemp;\n                        var yTemp;\n                        var xRect;\n                        var widthRect;\n                        var elemHover;\n\n                        if(this.nodeName === \"text\") {\n                            var rect = \"#\"+this.previousSibling.id;\n                            if(rect.nodeName !== \"#\") colorSelectedFeat(rect, object);\n                        }\n                        else colorSelectedFeat(this, object);\n\n                        var svgWidth = SVGOptions.brushActive ? d3.select(\".background\").attr(\"width\") : svgContainer.node().getBBox().width;\n                        d3.select('body').selectAll('div.selectedRect').remove();\n                        // Append tooltip\n                        selectedRect = d3.select(div)\n                            .append('div')\n                            .attr('class', 'selectedRect');\n                        if (object.type === \"path\") {\n                            xTemp = pD[0].x;\n                            yTemp = pD[1].x;\n                        } else if (object.type === \"line\") {\n                            var absoluteMousePos = d3.mouse(bodyNode);\n                            elemHover = updateLineTooltip(absoluteMousePos[0],pD);\n                            xTemp = elemHover.x - 0.5;\n                            yTemp = elemHover.x + 0.5;\n                        } else if (object.type === \"unique\" || pD.x === pD.y) {\n                            xTemp = pD.x - 0.4;\n                            yTemp = pD.y + 0.4;\n                        } else {\n                            xTemp = pD.x;\n                            yTemp = pD.y;\n                        }\n\n                        if (scaling(xTemp) < 0 && scaling(yTemp) > svgWidth) {\n                            xRect = margin.left;\n                            widthRect = parseInt(svgWidth) + 5;\n                        } else if (scaling(xTemp) < 0) {\n                            xRect = margin.left;\n                            widthRect = (scaling(yTemp));\n                        } else if (scaling(yTemp) > svgWidth) {\n                            xRect = scaling(xTemp) + margin.left;\n                            widthRect = parseInt(svgWidth) - scaling(xTemp);\n                            widthRect =  widthRect + 5;\n                        } else {\n                            xRect = scaling(xTemp) + margin.left;\n                            widthRect = (scaling(yTemp) - scaling(xTemp));\n                        }\n                        selectedRect.style({\n                            left: xRect + 'px',\n                            top: ($(div + \" .svgHeader\").length) ? 60 + 'px' : 10 + 'px',\n                            'background-color': 'rgba(0, 0, 0, 0.2)',\n                            width: widthRect + 'px',\n                            height: (Yposition + 50) + 'px',\n                            position: 'absolute',\n                            'z-index': -1,\n                            'box-shadow': '0 1px 2px 0 #656565'\n                        });\n\n                        if (CustomEvent) {\n                            var event = new CustomEvent(self.events.FEATURE_SELECTED_EVENT, {\n                                detail: {\n                                    start: object.type === \"path\" ? pD[0].x : object.type === \"line\" ? elemHover.x : pD.x,\n                                    end: object.type === \"path\" ? pD[1].x : object.type === \"line\" ? elemHover.y : pD.y,\n                                    id: object.type === \"path\" ? pD[0].id : object.type === \"line\" ? elemHover.id : pD.id,\n                                    description:object.type === \"path\" ? pD[0].description : object.type === \"line\" ? elemHover.description : pD.description\n                                }\n                            });\n                            svgElement.dispatchEvent(event);\n                        } else {\n                            console.warn(\"CustomEvent is not defined....\");\n                        }\n                        if (self.trigger) self.trigger(self.events.FEATURE_SELECTED_EVENT, {\n                            start: object.type === \"path\" ? pD[0].x : object.type === \"line\" ? elemHover.x : pD.x,\n                            end: object.type === \"path\" ? pD[1].x : object.type === \"line\" ? elemHover.y : pD.y,\n                            id: object.type === \"path\" ? pD[0].id : object.type === \"line\" ? elemHover.id : pD.id,\n                            description:object.type === \"path\" ? pD[0].description : object.type === \"line\" ? elemHover.description : pD.description\n                        });\n\n                    });\n            }\n\n            tooltip.attr = function (_x) {\n                if (!arguments.length) return attrs;\n                attrs = _x;\n                return this;\n            };\n\n            tooltip.style = function (_x) {\n                if (!arguments.length) return styles;\n                styles = _x;\n                return this;\n            };\n\n            return tooltip;\n        };\n\n        //COMPUTING FUNCTION\n        var X = function (d) {\n            return scaling(d.x);\n        };\n        var displaySequence = function (seq) {\n            return width / seq > 5;\n        };\n        var rectWidth = function (d) {\n            return (scaling(d.y) - scaling(d.x));\n        };\n        function rectX(object) {\n            if (object.x === object.y) {\n                return scaling(object.x-0.4);\n            }\n            return scaling(object.x);\n        };\n        function rectWidth2(d){\n            if (d.x === d.y) {\n                if (scaling(d.x + 0.4) - scaling(d.x - 0.4) < 2) return 2;\n                else return scaling(d.x + 0.4) - scaling(d.x - 0.4);\n            }\n            return (scaling(d.y) - scaling(d.x));\n        };\n        var uniqueWidth = function (d) {\n            return (scaling(1));\n        };\n\n        this.onFeatureSelected = function (listener) {\n            svgElement.addEventListener(self.events.FEATURE_SELECTED_EVENT, listener);\n        };\n        this.onFeatureDeselected = function (listener) {\n            svgElement.addEventListener(self.events.FEATURE_DESELECTED_EVENT, listener);\n        };\n\n        this.onZoom = function (listener) {\n            svgElement.addEventListener(self.events.ZOOM_EVENT, listener);\n        };\n        this.onGetPredictions = function (listener) {\n            svgElement.addEventListener(self.events.GET_PREDICTIONS_EVENT, listener);\n        }\n        this.onVariantAdded = function (listener) {\n            svgElement.addEventListener(self.events.VARIANT_ADDED_EVENT, listener);\n        }\n\n        function addLevel(array) {\n            var leveling = [];\n            array.forEach(function (d) {\n                if (leveling === []) {\n                    leveling.push(d.y);\n                    d.level = 0;\n                } else {\n                    var placed = false;\n                    for (var k = 0; k < leveling.length; k++) {\n                        if (d.x > leveling[k]) {\n                            placed = true;\n                            d.level = k;\n                            leveling[k] = d.y;\n                            break;\n                        }\n                    }\n                    if (placed === false) {\n                        leveling.push(d.y);\n                        d.level = leveling.length - 1;\n                    }\n                }\n            });\n            return leveling.length;\n        }\n\n        function addLevelToBond(array) {\n            var leveling = [];\n            var newArray = [];\n            array.forEach(function (d) {\n                if (leveling === []) {\n                    leveling.push(d[2].x);\n                    d[1].y = 1;\n                } else {\n                    var placed = false;\n                    for (var k = 0; k < leveling.length; k++) {\n                        if (d[0].x > leveling[k]) {\n                            placed = true;\n                            d[1].y = k + 1;\n                            leveling[k] = d[2].x;\n                            break;\n                        }\n                    }\n                    if (placed === false) {\n                        leveling.push(d[2].x);\n                        d[1].y = leveling.length;\n                    }\n                }\n            });\n            return leveling.length;\n        }\n\n        var lineBond = d3.svg.line()\n            .interpolate(\"step-before\")\n            .x(function (d) {\n                return scaling(d.x);\n            })\n            .y(function (d) {\n                return -d.y * 10 + pathLevel;\n            });\n        var lineGen = d3.svg.line()\n          \n//          .interpolate(\"cardinal\")\n          .x(function(d) {\n            return scaling(d.x);\n          })\n          .y(function (d) {\n                return lineYscale(-d.y) * 10 + pathLevel;\n            });\n        var lineYscale = d3.scale.linear()\n            .domain([0,-30])\n            .range([0,-20]);\n        var line = d3.svg.line()\n            .interpolate(\"linear\")\n            .x(function (d) {\n                return scaling(d.x);\n            })\n            .y(function (d) {\n                return d.y + 6;\n            });\n\n        //Create Axis\n        var xAxis = d3.svg.axis()\n            .scale(scaling)\n            .tickFormat(d3.format(\"d\"))\n            .orient(\"bottom\");\n        \n        function shadeBlendConvert(p, from, to) {\n            if(typeof(p)!=\"number\"||p<-1||p>1||typeof(from)!=\"string\"||(from[0]!='r'&&from[0]!='#')||(typeof(to)!=\"string\"&&typeof(to)!=\"undefined\"))return null; //ErrorCheck\n            if(!this.sbcRip)this.sbcRip=function(d){\n                var l=d.length,RGB=new Object();\n                if(l>9){\n                    d=d.split(\",\");\n                    if(d.length<3||d.length>4)return null;//ErrorCheck\n                    RGB[0]=i(d[0].slice(4)),RGB[1]=i(d[1]),RGB[2]=i(d[2]),RGB[3]=d[3]?parseFloat(d[3]):-1;\n                }else{\n                    if(l==8||l==6||l<4)return null; //ErrorCheck\n                    if(l<6)d=\"#\"+d[1]+d[1]+d[2]+d[2]+d[3]+d[3]+(l>4?d[4]+\"\"+d[4]:\"\"); //3 digit\n                    d=i(d.slice(1),16),RGB[0]=d>>16&255,RGB[1]=d>>8&255,RGB[2]=d&255,RGB[3]=l==9||l==5?r(((d>>24&255)/255)*10000)/10000:-1;\n                }\n                return RGB;}\n            var i=parseInt,r=Math.round,h=from.length>9,h=typeof(to)==\"string\"?to.length>9?true:to==\"c\"?!h:false:h,b=p<0,p=b?p*-1:p,to=to&&to!=\"c\"?to:b?\"#000000\":\"#FFFFFF\",f=sbcRip(from),t=sbcRip(to);\n            if(!f||!t)return null; //ErrorCheck\n            if(h)return \"rgb(\"+r((t[0]-f[0])*p+f[0])+\",\"+r((t[1]-f[1])*p+f[1])+\",\"+r((t[2]-f[2])*p+f[2])+(f[3]<0&&t[3]<0?\")\":\",\"+(f[3]>-1&&t[3]>-1?r(((t[3]-f[3])*p+f[3])*10000)/10000:t[3]<0?f[3]:t[3])+\")\");\n            else return \"#\"+(0x100000000+(f[3]>-1&&t[3]>-1?r(((t[3]-f[3])*p+f[3])*255):t[3]>-1?r(t[3]*255):f[3]>-1?r(f[3]*255):255)*0x1000000+r((t[0]-f[0])*p+f[0])*0x10000+r((t[1]-f[1])*p+f[1])*0x100+r((t[2]-f[2])*p+f[2])).toString(16).slice(f[3]>-1||t[3]>-1?1:3);\n        }\n\n        function addXAxis(position) {\n            svgContainer.append(\"g\")\n                .attr(\"class\", \"x axis Xaxis\")\n                .attr(\"transform\", \"translate(0,\" + (position + 20) + \")\")\n                .call(xAxis);\n        }\n\n        function updateXaxis(position) {\n            svgContainer.selectAll(\".Xaxis\")\n                .attr(\"transform\", \"translate(0,\" + (position + 20) + \")\")\n        }\n\n        function updateSVGHeight(position) {\n            svg.attr(\"height\", position + 60 + \"px\");\n            svg.select(\"clippath rect\").attr(\"height\", position + 60 + \"px\");\n        }\n\n        var yAxisScale = d3.scale.ordinal()\n            .domain([0, yData.length])\n            .rangeRoundBands([0, 500], .1);\n        var yAxis = d3.svg.axis()\n            .scale(yAxisScale)\n            .tickValues(yData) //specify an array here for values\n            .tickFormat(function (d) {\n                return d\n            })\n            .orient(\"left\");\n\n        function addYAxis() {\n            yAxisSVG = svg.append(\"g\")\n                .attr(\"class\", \"pro axis\")\n                .attr(\"transform\", \"translate(0,\" + margin.top + \")\");\n            updateYaxis();\n        }\n\n        function updateYaxis() {\n\n            yAxisSVGgroup = yAxisSVG\n                .selectAll(\".yaxis\")\n                .data(yData)\n                .enter()\n                .append(\"g\");\n            yAxisSVGgroup\n                .append(\"polygon\") // attach a polygon\n                .attr(\"class\", function (d) {\n                    if (d.filter) return d.filter.split(\" \").join(\"_\") + \"Arrow\";\n                    return \"Arrow\";\n                })\n                .style(\"stroke\", \"\") // colour the line\n                .style(\"fill\", \"#DFD5D3\") // remove any fill colour\n                .attr(\"points\", function (d) {\n                    return (margin.left - 105) + \",\" + (d.y - 3) + \", \" + (margin.left - 105) + \",\" + (d.y + 12) + \", \" + (margin.left - 15) + \",\" + (d.y + 12) + \", \" + (margin.left - 7) + \",\" + (d.y + 4.5) + \", \" + (margin.left - 15) + \",\" + (d.y -3); // x,y points\n                });\n            yAxisSVGgroup\n                .append(\"text\")\n                .attr(\"class\", \"yaxis\")\n                .attr(\"text-anchor\", \"start\")\n                .attr(\"x\", function () {\n                    return margin.left - 102\n                })\n                .attr(\"y\", function (d) {\n                    return d.y + 8\n                })\n                .text(function (d) {\n                    return d.title\n                });\n        }\n\n        function forcePropagation(item) {\n            item.on('mousedown', function () {\n                brush_elm = svg.select(\".brush\").node();\n                new_click_event = new Event('mousedown');\n                new_click_event.pageX = d3.event.pageX;\n                new_click_event.clientX = d3.event.clientX;\n                new_click_event.pageY = d3.event.pageY;\n                new_click_event.clientY = d3.event.clientY;\n                if (brush_elm) {\n                    brush_elm.dispatchEvent(new_click_event);\n                }\n            });\n        }\n\n        /** export to new utils file  */\n        var preComputing = {\n            path: function (object) {\n                object.data.sort(function (a, b) {\n                    return a.x - b.x;\n                });\n                var level = addLevel(object.data);\n                object.data = object.data.map(function (d) {\n                    return [{\n                        x: d.x,\n                        y: 0,\n                        id: d.id,\n                        description: d.description,\n                        color: d.color\n                    }, {\n                        x: d.y,\n                        y: d.level + 1,\n                        id: d.id\n                    }, {\n                        x: d.y,\n                        y: 0,\n                        id: d.id\n                    }]\n                })\n                pathLevel = level * 10 + 5;\n                object.height = level * 10 + 5;\n            },\n            line: function (object) {\n                if (!object.height) object.height = 10;\n                var shift = parseInt(object.height);\n                var level = 0;\n                for (var i in object.data) {\n                    object.data[i].sort(function (a, b) {\n                        return a.x - b.x;\n                    });\n                    if (object.data[i][0].y !== 0) {\n                        object.data[i].unshift({\n                            x:object.data[i][0].x-1,\n                            y:0\n                        })\n                    }\n                    if (object.data[i][object.data[i].length -1].y !== 0){\n                        object.data[i].push({\n                            x:object.data[i][object.data[i].length -1].x+1,\n                            y:0\n                        })\n                    }\n                    var maxValue = Math.max.apply(Math,object.data[i].map(function(o){return Math.abs(o.y);}));\n                    level = maxValue > level ? maxValue : level;\n                    \n\n                    object.data[i] = [object.data[i].map(function (d) {\n                        return {\n                            x: d.x,\n                            y: d.y,\n                            id: d.id,\n                            description: d.description\n                        }\n                    })]\n                }\n                lineYscale.range([0, -(shift)]).domain([0, -(level)]);\n                pathLevel = shift * 10 +5;\n                object.level = level;\n                object.shift = shift * 10 +5;\n            },\n            multipleRect: function (object) {\n                object.data.sort(function (a, b) {\n                    return a.x - b.x;\n                });\n                level = addLevel(object.data);\n                pathLevel = level * 10 + 5;\n            }\n        };\n\n        var fillSVG = {\n            typeIdentifier: function (object) {\n                if (object.type === \"rect\") {\n                    preComputing.multipleRect(object);\n                    yData.push({\n                        title: object.name,\n                        y: Yposition,\n                        filter: object.filter\n                    });\n                    fillSVG.rectangle(object, Yposition);\n                } else if (object.type === \"text\") {\n                    fillSVG.sequence(object.data, Yposition);\n                    yData.push({\n                        title: object.name,\n                        y: Yposition,\n                        filter: object.filter\n                    });\n                    scaling.range([5, width-5]);\n                } else if (object.type === \"unique\") {\n                    fillSVG.unique(object, Yposition);\n                    yData.push({\n                        title: object.name,\n                        y: Yposition,\n                        filter: object.filter\n                    });\n                } else if (object.type === \"multipleRect\") {\n                    preComputing.multipleRect(object);\n                    fillSVG.multipleRect(object, Yposition, level);\n                    yData.push({\n                        title: object.name,\n                        y: Yposition,\n                        filter: object.filter\n                    });\n                    Yposition += (level - 1) * 10;\n                } else if (object.type === \"path\") {\n                    preComputing.path(object);\n                    fillSVG.path(object, Yposition);\n                    Yposition += pathLevel;\n                    yData.push({\n                        title: object.name,\n                        y: Yposition - 10,\n                        filter: object.filter\n                    });\n                } else if (object.type === \"line\") {\n                    if (!(Array.isArray(object.data[0]))) object.data = [object.data];\n                    if (!(Array.isArray(object.color))) object.color = [object.color];\n                    var negativeNumbers = false;\n                    object.data.forEach(function(d){\n                        if (d.filter(function(l){ return l.y < 0}).length) negativeNumbers = true;\n                    });\n                    preComputing.line(object);\n                    fillSVG.line(object, Yposition);\n                    Yposition += pathLevel;\n                    yData.push({\n                        title: object.name,\n                        y: Yposition - 10,\n                        filter: object.filter\n                    });\n                    Yposition += negativeNumbers ? pathLevel-5 : 0;\n                }\n            },\n            sequence: function (seq, position, start) {\n                //Create group of sequence\n                if (!start) var start = 0;\n\n                let seqSelected;\n\n                svgContainer.append(\"g\")\n                    .attr(\"class\", \"seqGroup\")\n                    .selectAll(\".AA\")\n                    .data(seq)\n                    .enter()\n                    .append(\"text\", function() {\n                        return d + '-' + i\n                    })\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"AA\")\n                    .attr(\"text-anchor\", \"middle\")\n                    .attr(\"x\", function (d, i) {\n                        return scaling.range([5, width-5])(i + start)\n                    })\n                    .attr(\"y\", position)\n                    .attr(\"font-size\", \"10px\")\n                    .attr(\"font-family\", \"monospace\")\n                    .text(function (d, i) {\n                        return d\n                    })\n                    .on(\"mouseover\", function(e) {\n                        seqSelected = e;\n                        const width = $(window).width();\n                        const posX = this.getBoundingClientRect().x;\n\n                        const divPos = calculatePos(width, posX)\n                        showPopup(true, divPos)\n                    })\n\n                // Single variant popup UI\n                    \n                let optionsHeader = $(div + \" .svgHeader\").length ? d3.select(div + \" .svgHeader\") : d3.select(div).append(\"div\").attr(\"class\", \"svgHeader\");\n\n                let singlePopup = optionsHeader.append(\"div\") \n                    .attr(\"class\", \"single-variant-popup\")\n     \n                    singlePopup.append('svg')\n                    .attr(\"class\", \"cancel-icon\")\n                    .attr(\"height\", \"1.5rem\")\n                    .attr(\"width\", \"1.5rem\")                \n                    .attr(\"viewBox\",\"0 0 512 640\")\n                    .on(\"click\", function() {\n                        showPopup(false)\n                    })\n                    .html(crossIcon)\n                 \n                    singlePopup.append(\"div\").html(`\n                        <p>Enter the variants</p>\n                        <div class=\"properties-row\">\n                            <p class=\"title\">Position</p>\n                            <p class=\"single-variant-position\"></p>\n                        </div>\n                        <div class=\"properties-row\">\n                            <p class=\"title\">Original</p>\n                            <p class=\"single-variant-original\"></p>\n                        </div>\n                        <div class=\"properties-row\">\n                            <p class=\"title\">Variant</p>\n                            <input id=\"single-variant-input\" class=\"popup-input\"></input>\n                        </div>\n                        <span id=\"single-entry-add-variant\" class=\"add-variant-btn\">Add Variant</span>\n                    `)\n\n                 let inputValue;\n\n                 d3.select(div + \" #single-variant-input\")\n                    .on(\"change\", function() {\n                        inputValue = d3.select(this).property(\"value\");\n                   });\n\n                   d3.select(div + \" #single-entry-add-variant\")\n                    .on(\"click\", function() {\n                        addVariant(inputValue)\n                  });\n\n                  /**\n                 * Add variant and call onVariantAdded Event\n                 * @param {int} value Variant value\n                 */\n\n                 function addVariant(value) {\n                    let v = {}\n                    v.position = $('.single-variant-position').text();\n                    v.original = seqSelected;\n                    v.variant = value;\n                    variantInputValues.push(v)\n                    callOnVariantAdded(variantInputValues)\n                 }\n                 \n                \n                /**\n                 * Show the single variant entry popup\n                 * @param {boolean} show Show/hide the popup\n                 * @param {float} divPos Position of popup \n                 */\n\n                function showPopup (show, divPos) {\n                    d3.select(div + \" .single-variant-position\").text(function() {\n                        return absoluteSeqPos\n                    })\n\n                    d3.select(div + \" .single-variant-original\").text(function() {\n                        return seqSelected\n                    })\n\n                    document.getElementById(\"single-variant-input\").value = '';\n\n                    singlePopup\n                    .style(\"left\", `${divPos}px`)\n                    .style(\"display\", show ? \"block\" : \"none\")\n                }\n\n                 /**\n                 * Calculate the position of popup\n                 * @param {float} width Screen width of client\n                 * @param {float} posX Position of sequence clicked (in px)\n                 */\n\n                function calculatePos(width, posX) {\n                    const margin = 800;\n                    if(width - posX < margin) return width - (margin/2 + (width-posX));\n                    \n                    return posX;\n                }\n            },\n            sequenceLine: function () {\n                //Create line to represent the sequence\n                if (SVGOptions.dottedSequence){\n                    var dottedSeqLine = svgContainer.selectAll(\".sequenceLine\")\n                        .data([[{x:1,y:12},{x:fvLength,y:12}]])\n                        .enter()\n                        .append(\"path\")\n                        .attr(\"clip-path\", \"url(#clip)\")\n                        .attr(\"d\", line)\n                        .attr(\"class\",\"sequenceLine\")\n                        .style(\"z-index\", \"0\")\n                        .style(\"stroke\", \"black\")\n                        .style(\"stroke-dasharray\",\"1,3\")\n                        .style(\"stroke-width\", \"1px\")\n                        .style(\"stroke-opacity\",0);\n\n                    dottedSeqLine\n                        .transition()\n                        .duration(500)\n                        .style(\"stroke-opacity\", 1);\n                }\n            },\n            rectangle: function (object, position) {\n                //var rectShift = 20;\n                if (!object.height) object.height = 12;\n                var rectHeight = object.height;\n                \n                var rectShift = rectHeight + rectHeight/3;\n                var lineShift = rectHeight/2 - 6;\n//                var lineShift = rectHeight/2 - 6;\n\n                var rectsPro = svgContainer.append(\"g\")\n                    .attr(\"class\", \"rectangle\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n                \n                var dataline=[];\n                for (var i = 0; i < level; i++) {\n                    dataline.push([{\n                            x: 1,\n                            y: (i * rectShift + lineShift)\n                        }, {\n                            x: fvLength,\n                            y: (i * rectShift + lineShift)\n                        }]);\n                }\n                rectsPro.selectAll(\".line\" + object.className)\n                    .data(dataline)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"d\", line)\n                    .attr(\"class\", function () {\n                        return \"line\" + object.className\n                    })\n                    .style(\"z-index\", \"0\")\n                    .style(\"stroke\", object.color)\n                    .style(\"stroke-width\", \"1px\");\n\n\n                var rectsProGroup = rectsPro.selectAll(\".\" + object.className + \"Group\")\n                    .data(object.data)\n                    .enter()\n                    .append(\"g\")\n                    .attr(\"class\", object.className + \"Group\")\n                    .attr(\"transform\", function (d) {\n                        return \"translate(\" + rectX(d) + \",0)\"\n                    });\n\n                rectsProGroup\n                    .append(\"rect\")\n                    .attr(\"class\", \"element \" + object.className)\n                    .attr(\"id\", function (d) {\n                        return \"f\" + d.id\n                    })\n                    .attr(\"y\", function (d) {\n                        return d.level * rectShift\n                    })\n                    .attr(\"width\", rectWidth2)\n                    .attr(\"height\", rectHeight)\n                    .style(\"fill\", function(d) { return d.color || object.color })\n                    .style(\"z-index\", \"13\")\n                    .call(d3.helper.tooltip(object));\n\n                rectsProGroup\n                    .append(\"text\")\n                    .attr(\"class\", \"element \" + object.className + \"Text\")\n                    .attr(\"y\", function (d) {\n                        return d.level * rectShift + rectHeight/2\n                    })\n                    .attr(\"dy\", \"0.35em\")\n                    .style(\"font-size\", \"10px\")\n                    .text(function (d) {\n                        return d.description\n                    })\n                    .style(\"fill\", \"black\")\n                    .style(\"z-index\", \"15\")\n                    .style(\"visibility\", function (d) {\n                        if (d.description) {\n                        } else return \"hidden\";\n                    })\n                    .call(d3.helper.tooltip(object));\n\n\n                //rectsPro.selectAll(\".\" + object.className)\n                //    .data(object.data)\n                //    .enter()\n                //    .append(\"rect\")\n                //    .attr(\"clip-path\", \"url(#clip)\")\n                //    .attr(\"class\", \"element \"+object.className)\n                //    .attr(\"id\", function(d) { return \"f\"+d.id })\n                //    .attr(\"x\", X)\n                //    .attr(\"width\", rectWidth)\n                //    .attr(\"height\", 12)\n                //    .style(\"fill\", object.color)\n                //    .style(\"z-index\", \"13\")\n                //    .call(d3.helper.tooltip(object));\n\n                forcePropagation(rectsProGroup);\n                var uniqueShift = rectHeight > 12 ? rectHeight - 6 : 0;\n                Yposition += level < 2 ? uniqueShift : (level-1) * rectShift + uniqueShift;\n            },\n            unique: function (object, position) {\n                var rectsPro = svgContainer.append(\"g\")\n                    .attr(\"class\", \"uniquePosition\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n\n                var dataline=[];\n                dataline.push([{\n                        x: 1,\n                        y: 0\n                    }, {\n                        x: fvLength,\n                        y: 0\n                    }]);\n                \n                rectsPro.selectAll(\".line\" + object.className)\n                    .data(dataline)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"d\", line)\n                    .attr(\"class\", \"line\" + object.className)\n                    .style(\"z-index\", \"0\")\n                    .style(\"stroke\", object.color)\n                    .style(\"stroke-width\", \"1px\");\n\n                rectsPro.selectAll(\".\" + object.className)\n                    .data(object.data)\n                    .enter()\n                    .append(\"rect\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"element \" + object.className)\n                    .attr(\"id\", function (d) {\n                        return \"f\" + d.id\n                    })\n                    .attr(\"x\", function (d) {\n                        return scaling(d.x - 0.4)\n                    })\n                    .attr(\"width\", function (d) {\n                        if (scaling(d.x + 0.4) - scaling(d.x - 0.4) < 2) return 2;\n                        else return scaling(d.x + 0.4) - scaling(d.x - 0.4);\n                    })\n                    .attr(\"height\", 12)\n                    .style(\"fill\", function(d) {return d.color ||  object.color})\n                    .style(\"z-index\", \"3\")\n                    .call(d3.helper.tooltip(object));\n\n                forcePropagation(rectsPro);\n            },\n            path: function (object, position) {\n                var pathsDB = svgContainer.append(\"g\")\n                    .attr(\"class\", \"pathing\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n\n                var dataline=[];\n                dataline.push([{\n                        x: 1,\n                        y: 0\n                    }, {\n                        x: fvLength,\n                        y: 0\n                    }]);\n                \n                pathsDB.selectAll(\".line\" + object.className)\n                    .data(dataline)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"d\", lineBond)\n                    .attr(\"class\", \"line\" + object.className)\n                    .style(\"z-index\", \"0\")\n                    .style(\"stroke\", object.color)\n                    .style(\"stroke-width\", \"1px\");\n\n                pathsDB.selectAll(\".\" + object.className)\n                    .data(object.data)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"element \" + object.className)\n                    .attr(\"id\", function (d) {\n                        return \"f\" + d[0].id\n                    })\n                    .attr(\"d\", lineBond)\n                    .style(\"fill\", \"none\")\n                    .style(\"stroke\", function(d) {return d[0].color || object.color})\n                    .style(\"z-index\", \"3\")\n                    .style(\"stroke-width\", \"2px\")\n                    .call(d3.helper.tooltip(object));\n\n                forcePropagation(pathsDB);\n            },\n            line: function (object, position) {\n                if (!object.interpolation) object.interpolation = \"monotone\";\n                if (object.fill === undefined) object.fill = true;\n                var histog = svgContainer.append(\"g\")\n                    .attr(\"class\", \"lining\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n\n                var dataline=[];\n                dataline.push([{\n                        x: 1,\n                        y: 0\n                    }, {\n                        x: fvLength,\n                        y: 0\n                    }]);\n                \n                histog.selectAll(\".line\" + object.className)\n                    .data(dataline)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"d\", lineBond)\n                    .attr(\"class\", \"line\" + object.className)\n                    .style(\"z-index\", \"0\")\n                    .style(\"stroke\", \"black\")\n                    .style(\"stroke-width\", \"1px\");\n                object.data.forEach(function(dd,i,array){\n                    histog.selectAll(\".\" + object.className + i)\n                    .data(dd)\n                    .enter()\n                    .append(\"path\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"element \" + object.className + \" \" + object.className + i)\n                    .attr(\"d\", lineGen.interpolate(object.interpolation))\n                    .style(\"fill\", object.fill ? shadeBlendConvert(0.6, object.color[i]) || shadeBlendConvert(0.6, \"#000\") : \"none\")\n                    .style(\"stroke\", object.color[i] || \"#000\")\n                    .style(\"z-index\", \"3\")\n                    .style(\"stroke-width\", \"2px\")\n//                    .style(\"shape-rendering\", \"crispEdges\")\n                    .call(d3.helper.tooltip(object));\n                })\n                \n                forcePropagation(histog);\n            },\n            multipleRect: function (object, position, level) {\n                var rectHeight = 8;\n                var rectShift = 10;\n                var rects = svgContainer.append(\"g\")\n                    .attr(\"class\", \"multipleRects\")\n                    .attr(\"transform\", \"translate(0,\" + position + \")\");\n\n                for (var i = 0; i < level; i++) {\n                    rects.append(\"path\")\n                        .attr(\"d\", line([{\n                            x: 1,\n                            y: (i * rectShift - 2)\n                        }, {\n                            x: fvLength,\n                            y: (i * rectShift - 2)\n                        }]))\n                        .attr(\"class\", function () {\n                            return \"line\" + object.className\n                        })\n                        .style(\"z-index\", \"0\")\n                        .style(\"stroke\", object.color)\n                        .style(\"stroke-width\", \"1px\");\n                }\n\n                rects.selectAll(\".\" + object.className)\n                    .data(object.data)\n                    .enter()\n                    .append(\"rect\")\n                    .attr(\"clip-path\", \"url(#clip)\")\n                    .attr(\"class\", \"element \" + object.className)\n                    .attr(\"id\", function (d) {\n                        return \"f\" + d.id\n                    })\n                    .attr(\"x\", X)\n                    .attr(\"y\", function (d) {\n                        return d.level * rectShift\n                    })\n                    .attr(\"width\", rectWidth)\n                    .attr(\"height\", rectHeight)\n                    .style(\"fill\", function(d) { return d.color || object.color })\n                    .style(\"z-index\", \"13\")\n                    .call(d3.helper.tooltip(object));\n\n                forcePropagation(rects);\n            }\n        };\n\n        this.showFilteredFeature = function(className, color, baseUrl){\n\n            var featureSelected = yAxisSVG.selectAll(\".\"+className+\"Arrow\");\n            var minY = margin.left - 105;\n            var maxY = margin.left - 7;\n\n            var gradient = svg\n                .append(\"linearGradient\")\n                .attr(\"y1\", \"0\")\n                .attr(\"y2\", \"0\")\n                .attr(\"x1\", minY)\n                .attr(\"x2\", maxY)\n                .attr(\"id\", \"gradient\")\n                .attr(\"spreadMethod\", \"pad\")\n                .attr(\"gradientUnits\", \"userSpaceOnUse\");\n\n            gradient\n                .append(\"stop\")\n                .attr(\"offset\", \"0.3\")\n                .attr(\"stop-color\", \"#DFD5D3\")\n                .attr(\"stop-opacity\", 1);\n\n\n            var redgrad = gradient\n                .append(\"stop\")\n                .attr(\"offset\", \"1\")\n                .attr(\"stop-opacity\", 1)\n                .attr(\"stop-color\", \"#DFD5D3\");\n\n            redgrad\n                .attr(\"stop-color\", color);\n\n            var url_gradient = \"url(#gradient)\";\n            var url_dropshadow = \"url(#dropshadow)\";\n            if (baseUrl) {\n                url_gradient = \"url(\" + baseUrl + \"#gradient)\";\n                url_dropshadow = \"url(\" + baseUrl +\"#dropshadow)\";\n            }\n\n            var selection = yAxisSVG.selectAll(\".\"+className+\"Arrow\")\n                .style(\"fill\", url_gradient)\n                .style(\"stroke\", \"\")\n                .attr(\"filter\", url_dropshadow);\n            selection\n                .attr(\"points\", function (d) {\n                    return (margin.left - 105) + \",\" + (d.y - 3) + \", \" + (margin.left - 105) + \",\" + (d.y + 12) + \", \" + (margin.left - 10) + \",\" + (d.y + 12) + \", \" + (margin.left - 2) + \",\" + (d.y + 4.5) + \", \" + (margin.left - 10) + \",\" + (d.y -3); // x,y points\n                });\n        };\n        this.hideFilteredFeature = function(className){\n            yAxisSVG.selectAll(\".\"+className+\"Arrow\")\n                .style(\"fill\", \"rgba(95,46,38,0.2)\")\n                .attr(\"filter\", \"\")\n                .attr(\"points\", function (d) {\n                    return (margin.left - 105) + \",\" + (d.y - 3) + \", \" + (margin.left - 105) + \",\" + (d.y + 12) + \", \" + (margin.left - 15) + \",\" + (d.y + 12) + \", \" + (margin.left - 7) + \",\" + (d.y + 4.5) + \", \" + (margin.left - 15) + \",\" + (d.y -3); // x,y points\n                });\n        };\n\n        var transition = {\n            rectangle: function (object) {\n                svgContainer.selectAll(\".line\" + object.className)\n                    .attr(\"d\",line.x(function (d) {\n                    return scaling(d.x);\n                }));\n                var transit;\n                if (animation) {\n                    transit1 = svgContainer.selectAll(\".\" + object.className + \"Group\")\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                    transit2 = svgContainer.selectAll(\".\" + object.className)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit1 = svgContainer.selectAll(\".\" + object.className + \"Group\");\n                    transit2 = svgContainer.selectAll(\".\" + object.className);\n                }\n                transit1.attr(\"transform\", function (d) {\n                            return \"translate(\" + rectX(d) + \",0)\"\n                        });\n\n                transit2\n                    .attr(\"width\", rectWidth2);\n                svgContainer.selectAll(\".\" + object.className + \"Text\")\n                    .style(\"visibility\", function (d) {\n                        if (d.description) {\n                        } else return \"none\";\n                    });\n            },\n            multiRec: function (object) {\n                svgContainer.selectAll(\".\" + object.className)\n//                    .data(object.data)\n                    //.transition()\n                    //.duration(500)\n                    .attr(\"x\", function (d) {\n                        return scaling(d.x)\n                    })\n                    .attr(\"width\", function (d) {\n                        return scaling(d.y) - scaling(d.x)\n                    });\n            },\n            unique: function (object) {\n                svgContainer.selectAll(\".line\" + object.className)\n                    .attr(\"d\",line.x(function (d) {\n                    return scaling(d.x);\n                }));\n                var transit;\n                if (animation) {\n                    transit = svgContainer.selectAll(\".\" + object.className)\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit = svgContainer.selectAll(\".\" + object.className);\n                }\n                transit\n//                    .data(object.data)\n                    //.transition()\n                    //.duration(500)\n                    .attr(\"x\", function (d) {\n                        return scaling(d.x - 0.4)\n                    })\n                    .attr(\"width\", function (d) {\n                        if (scaling(d.x + 0.4) - scaling(d.x - 0.4) < 2) return 2;\n                        else return scaling(d.x + 0.4) - scaling(d.x - 0.4);\n                    });\n            },\n            path: function (object) {\n                svgContainer.selectAll(\".line\" + object.className)\n                    .attr(\"d\",lineBond.x(function (d) {\n                                            return scaling(d.x);\n                                        })\n                                      .y(function (d) {\n                                            return -d.y * 10 + object.height;\n                                        })\n                         );\n                var transit;\n                if (animation) {\n                    transit = svgContainer.selectAll(\".\" + object.className)\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit = svgContainer.selectAll(\".\" + object.className);\n                }\n                transit\n                    .attr(\"d\", lineBond.y(function (d) {\n                        return -d.y * 10 + object.height;\n                    }));\n            },\n            line: function (object) {\n                lineYscale.range([0, -(object.height)]).domain([0, -(object.level)]);\n                svgContainer.selectAll(\".line\" + object.className)\n                    .attr(\"d\", lineGen.y(function (d) {\n                        return lineYscale(-d.y) * 10 + object.shift;\n                    }));\n                var transit;\n                if (animation) {\n                    transit = svgContainer.selectAll(\".\" + object.className)\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit = svgContainer.selectAll(\".\" + object.className);\n                }\n                \n                transit\n                    .attr(\"d\", lineGen.y(function (d) {\n                        return lineYscale(-d.y) * 10 + object.shift;\n                    })\n                          .interpolate(object.interpolation)\n                         );\n            },\n            text: function (object, start) {\n                var transit;\n                if (animation) {\n                    transit = svgContainer.selectAll(\".\" + object.className)\n    //                    .data(object.data)\n                        .transition()\n                        .duration(500);\n                }\n                else {\n                    transit = svgContainer.selectAll(\".\" + object.className);\n                }\n                transit\n                    .attr(\"x\", function (d, i) {\n                        return scaling(i + start)\n                    });\n            }\n        };\n\n        var brush = d3.svg.brush()\n            .x(scaling)\n            //.on(\"brush\", brushmove)\n            .on(\"brushend\", brushend);\n\n        function addBrush() {\n            svgContainer.append(\"g\")\n                .attr(\"class\", \"brush\")\n                .call(brush)\n                .selectAll(\"rect\")\n                .attr('height', Yposition + 50);\n        }\n        \n        this.zoom = function(start, end){\n            var zoomInside = current_extend.start<start && current_extend.end>end;\n            if (!zoomInside) {\n                svgContainer.selectAll(\".seqGroup\").remove();\n            }\n            brush.extent([start,end]);\n            brushend();\n        }\n        this.resetZoom = function(start, end){\n            resetAll();\n        }\n\n        function brushend() {\n            d3.select(div).selectAll('div.selectedRect').remove();\n            if (Object.keys(featureSelected).length !== 0 && featureSelected.constructor === Object) {\n                d3.select(featureSelected.id).style(\"fill\", featureSelected.originalColor);\n                featureSelected = {};\n                if (CustomEvent) {\n                    var event = new CustomEvent(self.events.FEATURE_DESELECTED_EVENT, {\n                        detail: {info:\"feature-deselected\"}\n                    });\n                    svgElement.dispatchEvent(event);\n                } else {\n                    console.warn(\"CustomEvent is not defined....\");\n                }\n                if (self.trigger) self.trigger(self.events.FEATURE_DESELECTED_EVENT, {info:\"feature-deselected\"});\n            }\n            // Check if brush is big enough before zooming\n            var extent = brush.extent();\n            var extentLength = Math.abs(extent[0] - extent[1]);\n\n            if (extent[0] < extent[1]) var start = parseInt(extent[0] - 1),\n                end = parseInt(extent[1] + 1);\n            else var start = parseInt(extent[1] + 1),\n                end = parseInt(extent[0] - 1);\n\n            var seq = displaySequence(extentLength);\n            if (!brush.empty() && extentLength > zoomMax) {\n                current_extend.length = extentLength;\n                var zoomScale = (fvLength / extentLength).toFixed(1);\n                $(div + \" .zoomUnit\").text(zoomScale.toString());\n                \n//                scaling.range([5,width-5]); \n                if (SVGOptions.showSequence && !(intLength) && seq && svgContainer.selectAll(\".AA\").empty()) {\n                    current_extend = { \n                    length : extentLength,\n                    start : start,\n                    end : end\n                    }\n                    seqShift = start;\n                    svgContainer.selectAll(\".sequenceLine\").remove();\n                    fillSVG.sequence(sequence.substring(start-1, end), 20, seqShift-1);\n                }\n\n                //modify scale\n//                scaling.range([5,width-5]);\n                scaling.domain(extent);\n                scalingPosition.range(extent);\n                var currentShift = seqShift ? seqShift : offset.start;\n                \n\n                transition_data(features, currentShift);\n                reset_axis();\n\n                if (CustomEvent) {\n                  svgElement.dispatchEvent(new CustomEvent(\n                    self.events.ZOOM_EVENT,\n                    {detail: { start: start, end: end, zoom: zoomScale }}\n                    ));\n                }\n                if (self.trigger) self.trigger(self.events.ZOOM_EVENT, {\n                            start: start,\n                            end: end,\n                            zoom: zoomScale\n                        });\n\n                //rectsPep2.classed(\"selected\", false);\n                d3.select(div).selectAll(\".brush\").call(brush.clear());\n            } else {\n                d3.select(div).selectAll(\".brush\").call(brush.clear());\n                //resetAll();\n            }\n        }\n//        \n        var resizeCallback = function(){\n            \n            updateWindow();\n        }\n        \n        $(window).on(\"resize\", resizeCallback);\n        \n        function updateWindow(){\n//            var new_width = $(div).width() - margin.left - margin.right - 17;\n//            var width_larger = (width < new_width);\n            \n            width = $(div).width() - margin.left - margin.right - 17;\n            d3.select(div+\" svg\")\n                .attr(\"width\", width + margin.left + margin.right);\n            d3.select(div+\" #clip>rect\").attr(\"width\", width);\n            if (SVGOptions.brushActive) {\n                d3.select(div+\" .background\").attr(\"width\", width);\n            }\n            d3.select(div).selectAll(\".brush\").call(brush.clear());\n            \n//            var currentSeqLength = svgContainer.selectAll(\".AA\").size();\n            var seq = displaySequence(current_extend.length);\n            if (SVGOptions.showSequence && !(intLength)){\n                if (seq === false && !svgContainer.selectAll(\".AA\").empty()) {\n                    svgContainer.selectAll(\".seqGroup\").remove();\n                    fillSVG.sequenceLine();\n                }\n                else if (seq === true && svgContainer.selectAll(\".AA\").empty()){\n                    svgContainer.selectAll(\".sequenceLine\").remove();\n                    fillSVG.sequence(sequence.substring(current_extend.start-1, current_extend.end), 20, current_extend.start-1);\n                    \n                }\n            }\n            \n            scaling.range([5,width-5]);\n            scalingPosition.domain([0, width]);\n            \n            transition_data(features, current_extend.start);\n            reset_axis();\n            \n        }\n\n        // If brush is too small, reset view as origin\n        function resetAll() {\n\n            //reset scale\n\n            $(\".zoomUnit\").text(\"1\");\n            scaling.domain([offset.start, offset.end]);\n            scalingPosition.range([offset.start, offset.end]);\n            var seq = displaySequence(offset.end - offset.start);\n            \n            if (SVGOptions.showSequence && !(intLength)){\n                if (seq === false && !svgContainer.selectAll(\".AA\").empty()){\n                    svgContainer.selectAll(\".seqGroup\").remove();\n                    fillSVG.sequenceLine();\n                }\n                else if (current_extend.length !== fvLength && seq === true && !svgContainer.selectAll(\".AA\").empty()) {\n                    svgContainer.selectAll(\".seqGroup\").remove();\n                    fillSVG.sequence(sequence.substring(offset.start-1,offset.end), 20, offset.start);\n                }\n            }\n\n            current_extend={ \n                    length : offset.end-offset.start,\n                    start : offset.start,\n                    end : offset.end\n                };\n            seqShift=0;\n            \n            transition_data(features, offset.start);\n            reset_axis();\n\n            // Fire Event\n            if (CustomEvent) {\n              svgElement.dispatchEvent(new CustomEvent(self.events.ZOOM_EVENT,\n                { detail: { start: 1, end: sequence.length, zoom: 1 }}));\n            };\n            if (self.trigger) self.trigger(self.events.ZOOM_EVENT, {\n                            start: 1,\n                            end: sequence.length,\n                            zoom: 1\n                        });\n\n            d3.select(div).selectAll(\".brush\").call(brush.clear());\n        }\n\n        function transition_data(features, start) {\n            features.forEach(function (o) {\n                if (o.type === \"rect\") {\n                    transition.rectangle(o);\n                } else if (o.type === \"multipleRect\") {\n                    transition.multiRec(o);\n                } else if (o.type === \"unique\") {\n                    transition.unique(o);\n                } else if (o.type === \"path\") {\n                    transition.path(o);\n                } else if (o.type === \"line\") {\n                    transition.line(o);\n                } else if (o.type === \"text\") {\n                    transition.text(o, start);\n                }\n            });\n        }\n\n        /** export to new axis file? */\n        function reset_axis() {\n            svgContainer\n                .transition().duration(500)\n                .select(\".x.axis\")\n                .call(xAxis);\n        }\n\n        function addVerticalLine() {\n            var vertical = d3.select(\".chart\")\n                .append(\"div\")\n                .attr(\"class\", \"Vline\")\n                .style(\"position\", \"absolute\")\n                .style(\"z-index\", \"19\")\n                .style(\"width\", \"1px\")\n                .style(\"height\", (Yposition + 50) + \"px\")\n                .style(\"top\", \"30px\")\n                // .style(\"left\", \"0px\")\n                .style(\"background\", \"#000\");\n\n            d3.select(\".chart\")\n                .on(\"mousemove.Vline\", function () {\n                    mousex = d3.mouse(this)[0] - 2;\n                    vertical.style(\"left\", mousex + \"px\")\n                });\n            //.on(\"click\", function(){\n            //    mousex = d3.mouse(this);\n            //    mousex = mousex[0] + 5;\n            //    vertical.style(\"left\", mousex + \"px\")});\n        }\n\n        this.addRectSelection = function (svgId) {\n            var featSelection = d3.select(svgId);\n            var elemSelected = featSelection.data();\n            var xTemp;\n            var yTemp;\n            var xRect;\n            var widthRect;\n            var svgWidth = SVGOptions.brushActive ? d3.select(\".background\").attr(\"width\") : svgContainer.node().getBBox().width;\n            d3.select('body').selectAll('div.selectedRect').remove();\n\n            var objectSelected = {type:featSelection[0][0].tagName, color:featSelection.style(\"fill\")};\n            colorSelectedFeat(svgId, objectSelected);\n\n            // Append tooltip\n            var selectedRect = d3.select(div)\n                .append('div')\n                .attr('class', 'selectedRect');\n\n            if (elemSelected[0].length === 3) {\n                xTemp = elemSelected[0][0].x;\n                yTemp = elemSelected[0][1].x;\n            } else if (elemSelected[0].x === elemSelected[0].y) {\n                xTemp = elemSelected[0].x - 0.5;\n                yTemp = elemSelected[0].y + 0.5;\n            } else {\n                xTemp = elemSelected[0].x;\n                yTemp = elemSelected[0].y;\n            }\n            if (scaling(xTemp) < 0) {\n                xRect = margin.left;\n                widthRect = (scaling(yTemp));\n            } else if (scaling(yTemp) > svgWidth) {\n                xRect = scaling(xTemp) + margin.left;\n                widthRect = svgWidth - scaling(xTemp);\n            } else {\n                xRect = scaling(xTemp) + margin.left;\n                widthRect = (scaling(yTemp) - scaling(xTemp));\n            }\n            selectedRect.style({\n                left: xRect + 'px',\n                top: 60 + 'px',\n                'background-color': 'rgba(0, 0, 0, 0.2)',\n                width: widthRect + 'px',\n                height: (Yposition + 50) + 'px',\n                position: 'absolute',\n                'z-index': -1,\n                'box-shadow': '0 1px 2px 0 #656565'\n            });\n        };\n\n        function initSVG(div, options) {\n\n            if (typeof options === 'undefined') {\n                var options = {\n                    'showAxis': false,\n                    'showSequence': false,\n                    'brushActive': false,\n                    'verticalLine': false,\n                    'toolbar': false,\n                    'bubbleHelp': false,\n                    'unit': \"units\",\n                    'zoomMax': 50\n                }\n            }\n\n            if (!$.fn.popover) {\n                options.bubbleHelp = false;\n                console.warn(\"The bubble help requires tooltip and popover bootstrap js libraries. The feature viewer will continue to work, but without the info bubble\");\n            }\n\n            // Create SVG\n            if (options.zoomMax) {\n                zoomMax = options.zoomMax;\n            }\n            if (!options.unit) {\n                options.unit = \"units\";\n            }\n            if (options.animation) {\n                animation = options.animation;\n            }\n\n            if (options.toolbar === true) {\n                \n                var headerOptions = $(div + \" .svgHeader\").length ? d3.select(div + \" .svgHeader\") : d3.select(div).append(\"div\").attr(\"class\", \"svgHeader\");\n                \n//                if (options.toolbarTemplate && options.toolbarTemplate === 2) {\n\n                    if (!$(div + ' .header-position').length) {\n                        var headerPosition = headerOptions\n                            .append(\"div\")\n                            .attr(\"class\", \"header-position\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"margin\", \"15px 10px 0px\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"line-height\",\"32px\");\n                        headerPosition\n                            .append(\"div\")\n                            .attr(\"class\", \"position-label\")\n                            .style(\"padding\", \"0px 5px\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"font-weight\",\"700\")\n                            .text(\"Position  :  \");\n                        headerPosition\n                            .append(\"div\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"padding-left\", \"5px\")\n                            .append(\"div\")\n                            .style(\"min-width\",\"50px\")\n                            .attr(\"id\", \"zoomPosition\")\n                            .text(\"0\");\n                    }\n                    if (!$(div + ' .header-zoom').length) {\n                        var headerZoom = headerOptions\n                            .append(\"div\")\n                            .attr(\"class\", \"header-zoom\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"margin\", \"15px 0px 0px\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"line-height\",\"32px\");\n                        headerZoom\n                            .append(\"div\")\n                            .attr(\"class\", \"zoom-label\")\n                            .style(\"padding\", \"0px 5px\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"padding\", \"0px\")\n                            .style(\"font-weight\",\"700\")\n                            .text(\"Zoom : \");\n\n                        headerZoom\n                            .append(\"div\")\n                            .style(\"display\", \"inline-block\")\n                            .style(\"padding\", \"0px\")\n                            .append(\"div\")\n                            .style(\"min-width\",\"50px\")\n                            .style(\"padding-left\", \"5px\")\n                            .append(\"span\")\n                            .text(\"x \")\n                            .append(\"span\")\n                            .attr(\"class\", \"zoomUnit\")\n                            .text(\"1\");\n                    }\n//                }\n//                else{\n//                    if (!$(div + ' .header-zoom').length) {\n//                        var headerZoom = headerOptions\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel panel-default header-zoom\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"width\", \"150px\")\n//                            .style(\"margin\", \"20px 0px 0px\")\n//                            .style(\"padding\", \"0px\");\n//                        headerZoom\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel-heading\")\n//                            .style(\"padding\", \"0px 15px\")\n//                            .style(\"border-right\", \"1px solid #DDD\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"width\", \"80px\")\n//                            .append(\"h5\")\n//                            .style(\"padding\", \"0px\")\n//                            .style(\"height\", \"10px\")\n//                            .style(\"color\", \"#777\")\n//                            .text(\"ZOOM\");\n//                        headerZoom\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel-body\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"padding\", \"0px\")\n//                            .append(\"h5\")\n//                            .style(\"padding-left\", \"15px\")\n//                            .style(\"height\", \"10px\")\n//                            .text(\"x \")\n//                            .append(\"span\")\n//                            .attr(\"class\", \"zoomUnit\")\n//                            .text(\"1\");\n//                    }\n//                    if (!$(div + ' .header-position').length) {\n//                        var headerPosition = headerOptions\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel panel-default header-position\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"width\", \"175px\")\n//                            .style(\"margin\", \"20px 20px 0px\")\n//                            .style(\"padding\", \"0px\");\n//                        headerPosition\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel-heading\")\n//                            .style(\"padding\", \"0px 15px\")\n//                            .style(\"border-right\", \"1px solid #DDD\")\n//                            .style(\"display\", \"inline-block\")\n//                            .append(\"h5\")\n//                            .style(\"padding\", \"0px\")\n//                            .style(\"height\", \"10px\")\n//                            .style(\"color\", \"#777\")\n//                            .text(\"POSITION\");\n//                        headerPosition\n//                            .append(\"div\")\n//                            .attr(\"class\", \"panel-body\")\n//                            .style(\"display\", \"inline-block\")\n//                            .style(\"padding\", \"0px\")\n//                            .append(\"h5\")\n//                            .style(\"padding-left\", \"15px\")\n//                            .style(\"height\", \"10px\")\n//                            .append(\"span\")\n//                            .attr(\"id\", \"zoomPosition\")\n//                            .text(\"0\");\n//                    }\n//                }\n                var headerZoom = $(div + ' .header-zoom').length ? d3.select(div + ' .header-zoom') : headerOptions;\n                if (options.bubbleHelp === true) {\n                    if (!$(div + ' .header-help').length) {\n                        var helpContent = \"<div><strong>To zoom in :</strong> Left click to select area of interest</div>\" +\n                            \"<div><strong>To zoom out :</strong> Right click to reset the scale</div>\" +\n                            \"<div><strong>Zoom max  :</strong> Limited to <strong>\" + zoomMax.toString() + \" \" + options.unit +\"</strong></div>\";\n//                        var headerHelp = headerOptions\n                        var headerHelp = headerZoom\n                            .append(\"div\")\n//                            .insert(\"div\",\":first-child\")\n//                            .attr(\"class\", \"pull-right\")\n                            .style(\"display\", \"inline-block\")\n//                            .style(\"margin\", \"15px 35px 0px 0px\")\n                            .style(\"margin\", \"0px\")\n                            .style(\"margin-right\", \"5px\")\n//                            .style(\"line-height\",\"32px\")\n                            .style(\"padding\", \"0px\");\n                        var buttonHelp = headerHelp\n                            .append(\"a\")\n                            .attr(\"type\", \"button\")\n                            .attr(\"class\", \"header-help\")\n                            .attr(\"data-toggle\", \"popover\")\n                            .attr(\"data-placement\", \"auto left\")\n                            .attr(\"title\", \"Help\")\n                            .attr(\"data-content\", helpContent)\n                            .style(\"font-size\", \"14px\");\n//                            .style(\"margin-bottom\", \"2px\");\n                        buttonHelp\n                            .append(\"span\")\n                            .attr(\"class\", \"label label-as-badge label-info\")\n                            .style(\"font-weight\",\"500\")\n//                            .style(\"border-radius\",\"3px\")\n                            .style(\"border-radius\",\"3px\")\n//                            .style(\"background-color\",\"#f8f8f8\")\n//                            .style(\"background-color\",\"#108D9F\")\n//                            .style(\"border\",\"1px solid #ddd\")\n//                            .style(\"border\",\"1px solid #0C6B78\")\n//                            .style(\"color\",\"#777\")\n                            .style(\"box-shadow\",\"inset 0px 0px 4px rgba(0,0,0,0.10)\")\n                            .style(\"color\",\"#fff\")\n//                            .style(\"padding\",\"2px 6px\")\n                            .html(\"<span class='state'>Show</span> help\");\n                        $(function () {\n                            $('[data-toggle=\"popover\"]').popover({html: true});\n                            $(div + ' .header-help').on('hide.bs.popover', function () {\n                              $(this).find(\".state\").text(\"Show\");\n                            });\n                            $(div + ' .header-help').on('show.bs.popover', function () {\n                              $(this).find(\".state\").text(\"Hide\");\n                            });\n                        })\n                    }\n                }\n            }\n                    if (!$(div + ' .variantHeader').length) {\n\n                        const optionsHeader = $(div + \" .svgHeader\").length ? d3.select(div + \" .svgHeader\") : d3.select(div).append(\"div\").attr(\"class\", \"svgHeader\");\n\n                        const multipleVariantContainer = optionsHeader\n                                                    .append(\"div\")\n                                                    .style(\"position\", \"relative\")\n                                                    .style(\"display\",\"flex\")\n\n                        let showMultipleVariantPopup = true\n\n                        multipleVariantContainer\n                            .append(\"span\")\n                            .attr(\"class\", \"add-variant-btn\")\n                            .style(\"margin-left\", \"auto\")\n                            .text(\"+ Add Multiple Variants\")\n                            .on(\"click\", function() {\n                                multipleVariantPopup(showMultipleVariantPopup)\n                                if(variantInputValues.length === 0) {\n                                    appendInputFields()\n                                } \n                                showMultipleVariantPopup = !showMultipleVariantPopup\n                            })\n\n\n                        const popup = multipleVariantContainer\n                            .append(\"div\")\n                            .attr(\"class\", \"multiple-variant-popup\")\n                            \n                            \n                                    popup.html(`<p>Enter the variants</p><div class=\"header\"><p>${deleteIcon}</p><p>Position</p><p>Original</p><p>Variant</p></div>`)\n\n                        \n                        $('.delete-icon').on(\"click\", function() {\n                                    $(\"input:checkbox\").each(function(){\n                                        var $this = $(this);\n                                        let id = $(this).attr('id')\n                                        if($this.is(\":checked\")){\n                                            $this.parent().remove()\n                                            console.log(\"id\", id)\n                                            variantInputValues.splice(id, 1)\n                                            console.log(\"vvvg\", variantInputValues)\n                                            callOnVariantAdded(variantInputValues)\n                                        }else{\n                                            console.log(\"not checked\");\n                                        }\n                                    });\n                                })\n                                \n\n                            popup.append('svg')\n                                .attr(\"height\", \"1.5rem\")\n                                .attr(\"width\", \"1.5rem\")\n                                .style(\"position\", \"absolute\")\n                                .style(\"top\", \"0\") \n                                .style(\"right\", \"0\") \n                                .style(\"margin\", \"1rem\")\n                                .style(\"cursor\", \"pointer\") \n                                .on(\"click\", function() {\n                                    multipleVariantPopup(false)\n                                })\n                                .attr(\"viewBox\",\"0 0 512 640\")\n                                .html(crossIcon)\n                        \n                        const inputContainer = popup\n                            .append(\"div\")\n                            .attr(\"class\", \"input-container\")\n\n                        function changeInputValues(value, type, idx) {\n                            switch(type) {\n                                case \"position\": variantInputValues[idx].position = value;\n                                                $(`#${idx}-original`).text(function() {\n                                                    return sequence.charAt(value-1);\n                                                });\n                                                variantInputValues[idx].original = sequence.charAt(value-1);\n                                                break;\n                                case \"variant\": variantInputValues[idx].variant = value;\n                                                break;\n                            }\n                        }\n\n                          /**\n                         * Add input fields to multiple variant entry popup\n                         */\n\n                        function appendInputFields() {\n                            const variantValues = { position: \"\", original: \"\", variant: \"\" }\n\n                            variantInputValues.push(variantValues)\n\n                            const inputWrapper = inputContainer.append(\"div\")\n\n\n                            inputWrapper.append(\"input\")\n                            .attr(\"type\", \"checkbox\")\n                            .attr(\"class\", \"input-checkbox\")\n                            .attr(\"id\", function() {\n                                return variantInputValues.length - 1;\n                            })\n                            \n                            Object.keys(variantValues).forEach(function(key) {\n\n                                if(key === 'original') {\n                                    inputWrapper\n                                    .append(\"span\")\n                                    .attr(\"id\", function() {\n                                        return variantInputValues.length - 1 + '-' + key;\n                                    })\n                                    .style(\"margin-top\", \"0.5rem\")\n                                    .text(\"0\")      \n                                } else if(key === 'position') {\n                                    inputWrapper\n                                    .append(\"input\")\n                                    .attr(\"class\", \"popup-input\")\n                                    .attr(\"maxlength\", \"2\")\n                                    .attr(\"id\", function() {\n                                        return variantInputValues.length - 1 + '-' + key;\n                                    })       \n                                    .attr(\"value\", function(d, i) {\n                                        return i;\n                                    })\n                                    .on(\"change\", function(d) {\n                                        var value = d3.select(this).property(\"value\");\n                                        var idx = d3.select(this).property(\"id\").split(\"-\")[0]\n                                        changeInputValues(value, key, idx)\n                                    });\n                                } else {\n                                    const dropdown = inputWrapper\n                                    .append(\"div\")\n                                    .attr(\"class\", \"dropdown\")\n\n                                    dropdown\n                                    .append(\"button\")\n                                    .attr(\"class\", \"dropdown-btn\")\n                                    .attr(\"id\", function() {\n                                        return variantInputValues.length - 1 + '-' + key;\n                                    })  \n                                    .text(\"Select variant\")\n                                    .on(\"click\", function() {\n                                        let id = $(this).attr('id');\n                                        $(\"div.dropdown-content\").not(`#${id}-dropdown`).hide();\n                                        $(`#${id}-dropdown`).toggle()\n                                    })\n\n                                    const dropdownContainer = dropdown.append(\"div\")\n                                    .attr(\"id\", function() {\n                                        return variantInputValues.length - 1 + '-' + key + '-dropdown';\n                                    })   \n                                    .attr(\"class\", \"dropdown-content\")\n                                    \n                                    dropdownContainer.append(\"input\")\n                                    .attr(\"placeholder\", \"Search...\")\n                                    .attr(\"id\", \"dropdown-search-input\")\n                                    .on(\"keyup\", function() {\n                                        var input, filter, a, i;\n                                        input = document.getElementById(\"dropdown-search-input\");\n                                        filter = input.value.toUpperCase();\n                                        div = document.getElementById(\"dropdown-container\");\n                                        a = div.getElementsByTagName(\"p\");\n                                        for (i = 0; i < a.length; i++) {\n                                          txtValue = a[i].textContent || a[i].innerText;\n                                          if (txtValue.toUpperCase().indexOf(filter) > -1) {\n                                            a[i].style.display = \"\";\n                                          } else {\n                                            a[i].style.display = \"none\";\n                                          }\n                                        }\n                                    })\n\n                                    const dropdownOptions = [\"A\", \"B\", \"C\", \"D\"]\n                                    \n                                    dropdownOptions.map((d) => {                        \n                                        dropdownContainer.append(\"p\")\n                                        .attr(\"class\", \"dropdown-options\")\n                                        .attr(\"id\", d)\n                                        .text(d)\n                                    })\n                                }\n                            })\n                        }\n\n                        $(document).on('click', '.dropdown-options', function () {\n                            const value = $(this).attr('id');\n                            $('.dropdown-content').hide()\n\n                            const id = $(this).parent().parent().children('button').attr(\"id\")\n                            const index = id.split('-')[0]\n                            const type = id.split('-')[1]\n\n                            $(this).parent().parent().children('button').text(function() {\n                                return value\n                            });\n                            \n                            changeInputValues(value, type, index)\n                        })\n\n                        const btnContainer = popup.append(\"div\")\n                                                .attr(\"class\", \"multiple-variant-btn-container\")\n\n                        btnContainer\n                                .append(\"span\")\n                                .attr(\"class\", \"add-variant-btn\")\n                                .text(\"+\")\n                                .on(\"click\", function() {\n                                    callOnVariantAdded(variantInputValues)\n                                    appendInputFields()\n                                })\n                            \n                        btnContainer\n                                .append(\"span\")\n                                .text(\"Get Predictions\")\n                                .attr(\"class\", \"get-predictions-btn\")\n                                .on(\"click\", function() {\n                                    callOnGetPredictions(variantInputValues);\n                                })\n\n                        function multipleVariantPopup(showPopup) {\n                            popup\n                            .style(\"display\", showPopup ? \"block\" : \"none\")\n                        }\n\n                        multipleVariantContainer\n                        .append(\"span\")\n                            .attr(\"class\", \"get-predictions-btn\")\n                            .text(\"Get Predictions\")\n                            .on(\"click\", function() {\n                               callOnGetPredictions(variantInputValues);\n                            })\n                    }\n            \n            \n            svg = d3.select(div).append(\"svg\")\n                .attr(\"width\", width + margin.left + margin.right)\n                .attr(\"height\", height + margin.top + margin.bottom)\n                .style(\"z-index\", \"2\")\n                .on(\"contextmenu\", function (d, i) {\n                    d3.event.preventDefault();\n                    resetAll();\n                    // react on right-clicking\n                });\n            svgElement = el.getElementsByTagName(\"svg\")[0];\n\n\n            svgContainer = svg\n                .append(\"g\")\n                .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n            //Create Clip-Path\n            var defs = svgContainer.append(\"defs\");\n\n            defs.append(\"clipPath\")\n                .attr(\"id\", \"clip\")\n                .append(\"rect\")\n                .attr(\"width\", width)\n                .attr(\"height\", height);\n\n            var filter = defs.append(\"filter\")\n                .attr(\"id\", \"dropshadow\")\n                .attr(\"height\", \"200%\");\n\n            filter.append(\"feGaussianBlur\")\n                .attr(\"in\", \"SourceAlpha\")\n                .attr(\"stdDeviation\", 3)\n                .attr(\"result\", \"blur\");\n            filter.append(\"feOffset\")\n                .attr(\"in\", \"blur\")\n                .attr(\"dx\", -2)\n                .attr(\"dy\", 2)\n                .attr(\"result\", \"offsetBlur\");\n\n            var feMerge = filter.append(\"feMerge\");\n\n            feMerge.append(\"feMergeNode\")\n                .attr(\"in\", \"offsetBlur\");\n            feMerge.append(\"feMergeNode\")\n                .attr(\"in\", \"SourceGraphic\");\n\n            svgContainer.on('mousemove', function () {\n                let absoluteMousePos = SVGOptions.brushActive ? d3.mouse(d3.select(\".background\").node()) : d3.mouse(svgContainer.node());;          \n                seqPos = Math.round(scalingPosition(absoluteMousePos[0]));\n                absoluteSeqPos = seqPos;\n                if (!options.positionWithoutLetter) {\n                    seqPos += sequence[seqPos-1] || \"\";\n                }\n                $(div + \" #zoomPosition\").text(seqPos);\n            });\n            \n            if (typeof options.dottedSequence !== \"undefined\"){\n                SVGOptions.dottedSequence = options.dottedSequence;\n            }\n            if (options.showSequence && !(intLength)) {\n                SVGOptions.showSequence = true;\n                if (displaySequence(offset.end - offset.start)) {\n                    fillSVG.sequence(sequence.substring(offset.start-1, offset.end), Yposition, offset.start);\n                }\n                else{\n                    fillSVG.sequenceLine();\n                }\n                features.push({\n                    data: sequence,\n                    name: \"Sequence\",\n                    className: \"AA\",\n                    color: \"black\",\n                    type: \"text\"\n                });\n                yData.push({\n                    title: \"Sequence\",\n                    y: Yposition - 8\n                });\n            }\n            if (options.showAxis) addXAxis(Yposition);\n            addYAxis();\n            if (options.brushActive) {\n                SVGOptions.brushActive = true;\n                zoom = true;\n                addBrush();\n            }\n            if (options.verticalLine) {\n                SVGOptions.verticalLine = true;\n                addVerticalLine();\n            }\n\n            updateSVGHeight(Yposition);\n\n        }\n\n        initSVG(div, options);\n\n        /**\n        * Calls onVariantAdded Custom Event\n        * @param {Object} variantInputValues Variant Input Values\n        */\n        function callOnVariantAdded(variantInputValues) {\n            if (CustomEvent) {\n                svgElement.dispatchEvent(new CustomEvent(\n                  self.events.VARIANT_ADDED_EVENT,\n                  {detail: variantInputValues}\n                  ));\n              }\n              if (self.trigger)  self.trigger(self.events.VARIANT_ADDED_EVENT, \n                variantInputValues\n            ); \n        }\n\n        /**\n        * Calls onGetPredictions Custom Event\n        * @param {Object} variantInputValues Variant Input Values\n        */\n        function callOnGetPredictions(variantInputValues) {\n            if (CustomEvent) {\n                svgElement.dispatchEvent(new CustomEvent(\n                self.events.GET_PREDICTIONS_EVENT,\n                { detail: variantInputValues }\n                ));\n            }\n            if (self.trigger) self.trigger(self.events.GET_PREDICTIONS_EVENT, \n                variantInputValues\n                    );\n          }\n\n        this.addFeature = function (object) {\n            Yposition += 20;\n            features.push(object);\n            fillSVG.typeIdentifier(object);\n            updateYaxis();\n            updateXaxis(Yposition);\n            updateSVGHeight(Yposition);\n            if (SVGOptions.brushActive) {\n                svgContainer.selectAll(\".brush rect\")\n                    .attr('height', Yposition + 50);\n            }\n            if (SVGOptions.verticalLine) d3.selectAll(\".Vline\").style(\"height\", (Yposition + 50) + \"px\");\n            if (d3.selectAll(\".element\")[0].length > 1500) animation = false;\n\n        }\n        \n        this.clearInstance = function (){\n            $(window).off(\"resize\", resizeCallback);\n            svg = null;\n            svgElement = null;\n            svgContainer = null;\n            yAxisSVGgroup = null;\n            yAxisSVG = null;\n            features = null;\n            sbcRip = null;\n            d3.helper = {};\n        }\n\n    }\n\nif ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\n    module.exports = createFeature;\n}","/*\n * feature-viewer\n * https://github.com/calipho-sib/feature-viewer\n *\n * Copyright (c) 2015 Calipho - SIB\n * Licensed under the GNU GPL v2 license.\n */\n\n/**\n @class FeatureViewer\n */\n\n\nglobal.jQuery = $ = require(\"jquery\");\nd3 = require(\"d3\");\nrequire(\"bootstrap/js/src/tooltip.js\");\nrequire(\"bootstrap/js/src/popover.js\");\n\nrequire(\"../css/style.css\");\n\nconst createFeature = require(\"../src/feature-viewer.js\");\n \n//Optional : usage with neXtProt\nconst Nextprot = require(\"nextprot/src/nextprot-core.js\");\nconst NXUtils = require(\"nextprot/src/nextprot-utils.js\")[\"NXUtils\"];\nconst NXViewerUtils = require(\"nextprot/src/nextprot-utils.js\")[\"NXViewerUtils\"];\n\n//Optional : usage with neXtProt\nconst nxFeatureViewer = require(\"../src/fv.nextprot.js\");\n\nrequire(\"biojs-events\").mixin(createFeature.prototype);\nmodule.exports = { createFeature, Nextprot, NXUtils, NXViewerUtils, nxFeatureViewer };","const crossIcon = `<path fill=\"#3a3a3a\" d=\"M256,0h0C114.61,0,0,114.61,0,256H0C0,397.39,114.61,512,256,512h0c141.38,0,256-114.61,256-256h0C512,114.61,397.39,0,256,0Zm87.72,307c13.06,12.28,17.61,26.86,4.11,40.55s-28,9.52-40.57-3.41l-52.08-53.6c-18.33,19.5-34.31,36.71-50.52,53.69-12.47,13.07-27.19,16.91-40.53,3.18s-8.6-28.24,4.38-40.55c16.54-15.7,33.06-31.41,56.4-53.59-20.08-17-38.19-31.84-55.64-47.38-14-12.48-19.23-27.9-4.12-42.21,14-13.22,28.46-7.8,40.57,5.12,15.57,16.61,31.06,33.28,50.39,54,20-21.34,35.94-38.68,52.21-55.74,11.81-12.39,26-15.48,38.77-3.31,13.88,13.24,10.45,27.93-2.62,40.51-16.95,16.31-34.17,32.32-55.13,52.1C309.44,275,326.65,290.92,343.72,307Z\" />`;\n\nconst deleteIcon = `<svg\nclass=\"delete-icon\"\nxmlns=\"http://www.w3.org/2000/svg\"\nx=\"0\"\ny=\"0\"\nviewBox=\"0 0 8.467 10.583\"\n>\n<g color=\"#000\" fontFamily=\"sans-serif\">\n  <path\n    style={{\n      lineHeight: \"normal\",\n      fontVariantLigatures: \"normal\",\n      fontVariantPosition: \"normal\",\n      fontVariantCaps: \"normal\",\n      fontVariantNumeric: \"normal\",\n      fontVariantAlternates: \"normal\",\n      fontVariantEastAsian: \"normal\",\n      fontFeatureSettings: \"normal\",\n      fontVariationSettings: \"normal\",\n      WebkitTextIndent: \"0\",\n      textIndent: \"0\",\n      WebkitTextAlign: \"start\",\n      textAlign: \"start\",\n      WebkitTextDecorationLine: \"none\",\n      textDecorationLine: \"none\",\n      WebkitTextDecorationStyle: \"solid\",\n      textDecorationStyle: \"solid\",\n      WebkitTextDecorationColor: \"#000000\",\n      textDecorationColor: \"#000000\",\n      WebkitTextTransform: \"none\",\n      textTransform: \"none\",\n      WebkitTextOrientation: \"mixed\",\n      textOrientation: \"mixed\",\n      whiteSpace: \"normal\",\n      shapePadding: \"0\",\n      shapeMargin: \"0\",\n      inlineSize: \"0\",\n      isolation: \"auto\",\n      mixBlendMode: \"normal\",\n      solidColor: \"#000000\",\n      solidOpacity: \"1\",\n    }}\n    d=\"M3.506-52.386a.796.796 0 00-.793.792v.264H.799a.265.265 0 100 .529h.474l.315 4.672c.042.619.525 1.15 1.168 1.15H5.71c.643 0 1.125-.531 1.168-1.15l.316-4.672h.473a.265.265 0 100-.53H5.754v-.263a.796.796 0 00-.793-.792zm0 .529H4.96c.151 0 .263.112.263.263v.264H3.24v-.264c0-.15.115-.263.266-.263zM1.8-50.801h4.865l-.313 4.635c-.026.38-.283.658-.641.658H2.756c-.358 0-.615-.279-.64-.658z\"\n    enableBackground=\"accumulate\"\n    overflow=\"visible\"\n    transform=\"translate(0 52.916)\"\n  ></path>\n  <path\n    style={{\n      lineHeight: \"normal\",\n      fontVariantLigatures: \"normal\",\n      fontVariantPosition: \"normal\",\n      fontVariantCaps: \"normal\",\n      fontVariantNumeric: \"normal\",\n      fontVariantAlternates: \"normal\",\n      fontVariantEastAsian: \"normal\",\n      fontFeatureSettings: \"normal\",\n      fontVariationSettings: \"normal\",\n      WebkitTextIndent: \"0\",\n      textIndent: \"0\",\n      WebkitTextAlign: \"start\",\n      textAlign: \"start\",\n      WebkitTextDecorationLine: \"none\",\n      textDecorationLine: \"none\",\n      WebkitTextDecorationStyle: \"solid\",\n      textDecorationStyle: \"solid\",\n      WebkitTextDecorationColor: \"#000000\",\n      textDecorationColor: \"#000000\",\n      WebkitTextTransform: \"none\",\n      textTransform: \"none\",\n      WebkitTextOrientation: \"mixed\",\n      textOrientation: \"mixed\",\n      whiteSpace: \"normal\",\n      shapePadding: \"0\",\n      shapeMargin: \"0\",\n      inlineSize: \"0\",\n      isolation: \"auto\",\n      mixBlendMode: \"normal\",\n      solidColor: \"#000000\",\n      solidOpacity: \"1\",\n    }}\n    d=\"M3.44-49.742a.265.265 0 00-.264.265v2.645a.265.265 0 00.263.266.265.265 0 00.266-.266v-2.645a.265.265 0 00-.266-.265zM5.027-49.742a.265.265 0 00-.265.265v2.645a.265.265 0 00.265.266.265.265 0 00.264-.266v-2.645a.265.265 0 00-.264-.265z\"\n    enableBackground=\"accumulate\"\n    overflow=\"visible\"\n    transform=\"translate(0 52.916)\"\n  ></path>\n</g><svg`;\n\nmodule.exports = { crossIcon, deleteIcon };\n","const createFeature = require('./feature-viewer')\n\nconst Nextprot = require(\"nextprot/src/nextprot-core.js\");\nconst NXUtils = require(\"nextprot/src/nextprot-utils.js\")[\"NXUtils\"];\nconst NXViewerUtils = require(\"nextprot/src/nextprot-utils.js\")[\"NXViewerUtils\"];\n\nvar nxClient;\n\n\n\nfunction nxFeatureViewer(nx, entry, div, options) {\n    nxClient = nx;\n    return new Promise(function(resolve, reject) {\n        var ft;\n        var isoform = entry;\n        var sequence = \"\";\n        if (entry.startsWith(\"NX_\")) {\n            var isoNb = isoform.split(\"-\")[1] ? isoform : isoform.split(\"-\")[0] + \"-1\";\n            var nxEntry = isoform.split(\"-\")[0];\n            nx.getProteinSequence(nxEntry).then(function (data) {\n                var isoSeq = data.filter(function(iso) {return iso.uniqueName === isoNb});\n                var sequence = isoSeq[0].sequence;\n                // Object.setPrototypeOf(createFeature, d);\n                createFeature.prototype.isoform = isoNb;\n                createFeature.prototype.entry = nxEntry;\n                createFeature.prototype.nxClient = nx;\n                createFeature.prototype.addNxFeature = addNxFeature;\n                ft = new createFeature(sequence, div, options);\n                resolve(ft);\n            })\n        }\n    });\n\n}\n\nfunction filterFeatures(featuresForViewer, viewer) {\n    var isoName = viewer.isoform;\n    for (var i = 0; i < featuresForViewer.length; i++) {\n        if (Object.keys(featuresForViewer[i]).length !== 0 && featuresForViewer[i].hasOwnProperty(isoName)) {\n            var feature = jQuery.extend({}, featuresForViewer[i][isoName]);\n            viewer.addFeature(feature);\n        }\n    }\n}\n\nfunction mergeData(oneData, metaData, viewer) {\n    featuresForViewer = [];\n\n    for (var i = 0; i < oneData.length; i++) {\n        var feat = NXUtils.convertMappingsToIsoformMap(oneData[i], metaData[i].name, metaData[i].filter);\n        var featForViewer = NXViewerUtils.convertNXAnnotations(feat, metaData[i]);\n        featuresForViewer.push(featForViewer);\n    }\n    return featuresForViewer;\n}\n\nfunction getFeaturesByview(nx, list, entry) {\n    \n    var data = [];\n    for (var feat in list) {\n        switch (list[feat]) {\n        case \"sequence\":\n            data.push(nx.getProteinSequence(entry));\n            break;\n        case \"antibody\":\n            data.push(nx.getAntibody(entry));\n            break;\n        case \"isoform-mapping\":\n            data.push(nx.getIsoformMapping(entry));\n            break;\n        default:\n            data.push(nx.getAnnotationsByCategory(entry, list[feat]));\n            break;\n        }\n    }\n    return data;\n}\n\nfunction addNxFeature(featuresName, featuresStyle) {\n    console.log(\"www\")\n    var that = this;\n    return new Promise(function(resolve, reject) {\n        Promise.all(getFeaturesByview(that.nxClient, featuresName, that.entry))\n            .then(function (oneData) {\n                var featuresForViewer = mergeData(oneData, featuresStyle);\n                filterFeatures(featuresForViewer, that);\n                resolve(that);\n            }).catch(function (err) {\n                // catch any error that happened so far\n                console.log(\"Argh, broken: \" + err.message);\n                console.log(\"Error at line : \" + err.stack);\n            });\n        \n    });\n}\n\nif ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\n    module.exports = nxFeatureViewer;\n}","import axios from \"axios\";\n\nexport async function getIsoforms(entry: string) {\n  let res;\n  await axios\n    .get(`https://api.nextprot.org/entry/${entry}/`)\n    .then(function (response) {\n      // handle success\n      console.log(response)\n      res = response.data.entry.isoforms;\n      console.log(response.data.entry.isoforms)\n    })\n    .catch(function (error) {\n      // handle error\n      console.log(error);\n    })\n    // await axios\n    // .get(`https://api.nextprot.org/entry/NX_P01308/annotation`)\n    // .then(function (response) {\n    //   // handle success\n    //   console.log(response)\n    //   res = response.data;\n    //   console.log(response.data)\n    // })\n    // .catch(function (error) {\n    //   // handle error\n    //   console.log(error);\n    // })\n    // console.log(res)\n  return res;\n}\n","import { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { getIsoforms } from \"../utils/services/isoform\";\n\ntype IsoformProps = {\n  handleIsoformChange: (e: any) => void;\n  currentIsoform: string;\n};\n\nconst Isoform = ({ handleIsoformChange, currentIsoform }: IsoformProps) => {\n  const [isoforms, setIsoforms] = useState<any>();\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    (async () => {\n      let res = await getIsoforms(\"NX_P07711\");\n      console.log(\"res\", res);\n      setIsoforms(res);\n    })().then(() => {\n      setLoading(false);\n    });\n  }, []);\n\n  if (loading) {\n    return <div>Loading</div>;\n  }\n\n  return (\n    <div>\n      {isoforms && isoforms.length > 1 ? (\n        <select value={currentIsoform} onChange={(e) => handleIsoformChange(e)}>\n          {isoforms?.map((i: any) => (\n            <option value={i.uniqueName}>{i.mainEntityName.name}</option>\n          ))}\n        </select>\n      ) : (\n        <div>Isoform: {isoforms && isoforms[0].mainEntityName.name}</div>\n      )}\n    </div>\n  );\n};\n\nexport default Isoform;\n","export const DEFAULT_SEQUENCE =\n  \"MTKFTILLISLLFCIAHTCSASKWQHQQDSCRKQLQGVNLTPCEKHIMEKIQGRGDDDDDDDDDNHILRTMRGRINYIRRNEGKDEDEE\";\n\nexport const DEFAULT_ENTRY = \"NX_P01308\";\n\nexport const DEFAULT_OPTIONS = {\n  showAxis: true,\n  showSequence: true,\n  brushActive: true,\n  toolbar: true,\n  bubbleHelp: true,\n  zoomMax: 20,\n  variant: true,\n};\n\nexport const ENTRY_OPTIONS = [\n  { value: \"absorption-max\", label: \"Max Absorption\" },\n  { value: \"absorption-note\", label: \"Absorption Rate\" },\n  { value: \"accession\", label: \"Accession\" },\n  { value: \"active-site\", label: \"Active Site\" },\n  { value: \"allergen\", label: \"Allergen\" },\n];\n\nexport const FEATURE_DATA = [\n  {\n    name: \"Test Feature 1\",\n    data: [\n      { x: 120, y: 154, description: \"aaaaa\", id: \"a1\" },\n      { x: 22, y: 163, description: \"bbbbb\", id: \"b1\" },\n      { x: 90, y: 108, description: \"ccccc\", id: \"c1\" },\n      { x: 10, y: 25, description: \"ddddd\", id: \"d1\" },\n      { x: 193, y: 210, description: \"eeeee\", id: \"e1\" },\n      { x: 78, y: 85, description: \"fffff\", id: \"f1\" },\n      { x: 96, y: 143, description: \"ggggg\", id: \"g1\" },\n      { x: 14, y: 65, description: \"hhhhh\", id: \"h1\" },\n      { x: 56, y: 167, description: \"jjjjj\", id: \"j1\" },\n    ],\n    className: \"test1\",\n    color: \"#54FEB7\",\n    type: \"multipleRect\",\n    filter: \"type2\",\n  },\n  {\n    data: [\n      { x: 57, y: 87, description: \"C peptide\", id: \"b1\"  },\n    ],\n    name: \"Propeptide\",\n    className: \"test2\",\n    color: \"#007800\",\n    type: \"rect\",\n    filter: \"type2\",\n  },\n  {\n    data: [\n      { x: 130, y: 184 },\n      { x: 40, y: 142 },\n      { x: 80, y: 110 },\n    ],\n    name: \"test feature 3\",\n    className: \"test3\",\n    color: \"#CFB915\",\n    type: \"path\",\n    filter: \"type2\",\n  },\n  {\n    data: [\n      { x: 120, y: 154 },\n      { x: 22, y: 163 },\n      { x: 90, y: 108 },\n      { x: 10, y: 25 },\n      { x: 193, y: 210 },\n      { x: 78, y: 85 },\n      { x: 96, y: 143 },\n      { x: 14, y: 65 },\n      { x: 56, y: 167 },\n    ],\n    name: \"test feature 4\",\n    className: \"test4\",\n    color: \"#79E376\",\n    type: \"multipleRect\",\n    filter: \"type1\",\n  },\n  {\n    data: [\n      { x: 120, y: 154 },\n      { x: 21, y: 163 },\n      { x: 90, y: 108 },\n      { x: 10, y: 25 },\n      { x: 193, y: 210 },\n      { x: 78, y: 85 },\n      { x: 96, y: 143 },\n      { x: 14, y: 65 },\n      { x: 56, y: 167 },\n    ],\n    name: \"test feature 5\",\n    className: \"test5\",\n    color: \"orange\",\n    type: \"rect\",\n    height: 8,\n    filter: \"type1\",\n  },\n  {\n    data: [\n      { x: 120, y: 154 },\n      { x: 22, y: 163 },\n      { x: 90, y: 90 },\n      { x: 10, y: 25 },\n      { x: 193, y: 210 },\n      { x: 78, y: 85 },\n      { x: 96, y: 143 },\n      { x: 14, y: 14 },\n      { x: 56, y: 57 },\n    ],\n    name: \"test feature 6\",\n    className: \"test6\",\n    color: \"green\",\n    type: \"rect\",\n    filter: \"type2\",\n  },\n];\n","import Papa from \"papaparse\";\n\nexport function getExportFileBlob({ columns, data, fileType, fileName }: any) {\n  if (fileType === \"csv\") {\n    const headerNames = columns.map((col: any) => col.exportValue);\n    const csvString = Papa.unparse({ fields: headerNames, data });\n    return new Blob([csvString], { type: \"text/csv\" });\n  }\n}\n","import {\n  useTable,\n  useAsyncDebounce,\n  usePagination,\n  useGlobalFilter,\n  ColumnInstance,\n} from \"react-table\";\nimport { useExportData } from \"react-table-plugins\";\nimport { useState, useMemo } from \"react\";\n\nimport { getExportFileBlob } from \"../utils/exportFile\";\nimport { VariantData } from \"./FeatureViewer\";\n\nconst RESULT_COLUMN_DATA = [\n  {\n    Header: \"S. No.\",\n    accessor: \"id\",\n    Cell: (row: any) => {\n      return <div>{Number(row.row.id) + 1}</div>;\n    },\n  },\n  {\n    Header: \"Position\",\n    accessor: \"position\",\n  },\n  {\n    Header: \"Original\",\n    accessor: \"original\",\n  },\n  {\n    Header: \"Variant\",\n    accessor: \"variant\",\n  },\n  {\n    Header: \"sift\",\n    accessor: \"sift\",\n  },\n  {\n    Header: \"polyphen\",\n    accessor: \"polyphen\",\n  },\n];\n\ntype TableProps = {\n  data: VariantData[];\n};\n\nfunction GlobalFilter({\n  preGlobalFilteredRows,\n  globalFilter,\n  setGlobalFilter,\n}: any) {\n  const count =\n    preGlobalFilteredRows.length > 0 ? preGlobalFilteredRows.length : 0;\n\n  const [value, setValue] = useState(globalFilter);\n\n  const onChange = useAsyncDebounce((value) => {\n    setGlobalFilter(value || undefined);\n  }, 200);\n\n  return (\n    <input\n      className=\"search-input\"\n      value={value || \"\"}\n      onChange={(e) => {\n        setValue(e.target.value);\n        onChange(e.target.value);\n      }}\n      placeholder={`Search ${count} records...`}\n    />\n  );\n}\n\nconst Table = (props: TableProps) => {\n  const { data } = props;\n\n  const columns = useMemo(() => RESULT_COLUMN_DATA, []);\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    prepareRow,\n    page,\n    state,\n    canPreviousPage,\n    canNextPage,\n    pageOptions,\n    pageCount,\n    gotoPage,\n    nextPage,\n    preGlobalFilteredRows,\n    setGlobalFilter,\n    previousPage,\n    setPageSize,\n    state: { pageIndex, pageSize },\n    exportData,\n  } = useTable(\n    {\n      //@ts-ignore\n      columns,\n      data,\n      getExportFileBlob,\n      //@ts-ignore\n      initialState: { pageIndex: 0, pageSize: 5 },\n    },\n    useGlobalFilter,\n    usePagination,\n    useExportData\n  );\n\n  return (\n    <div className=\"variant-table-container\">\n      <div className=\"table-header\">\n        <GlobalFilter\n          preGlobalFilteredRows={preGlobalFilteredRows}\n          globalFilter={state.globalFilter}\n          setGlobalFilter={setGlobalFilter}\n        />\n        <button\n          className=\"export-btn\"\n          onClick={() => {\n            exportData(\"csv\", true);\n          }}\n        >\n          Export All as CSV\n        </button>\n      </div>\n      <table {...getTableProps()} className=\"variant-data-table\">\n        <thead>\n          {headerGroups.map((headerGroup: any) => {\n            return (\n              <tr {...headerGroup.getHeaderGroupProps()}>\n                {headerGroup.headers.map((column: ColumnInstance) => {\n                  return (\n                    <th\n                      style={{\n                        backgroundColor:\n                          column.id === \"polyphen\" || column.id === \"sift\"\n                            ? \"#d5e6ff\"\n                            : \"#FFF\",\n                      }}\n                      {...column.getHeaderProps()}\n                    >\n                      {column.render(\"Header\")}\n                    </th>\n                  );\n                })}\n              </tr>\n            );\n          })}\n        </thead>\n        <tbody {...getTableBodyProps()}>\n          {page.map((row: any) => {\n            prepareRow(row);\n            return (\n              <tr {...row.getRowProps()}>\n                {row.cells.map((cell: any) => {\n                  return (\n                    <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                  );\n                })}\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n      {data.length === 0 ? (\n        <p className=\"table-text\">\n          <i>\n            No records added. Add variants and click on get predictions to get\n            results\n          </i>\n          .\n        </p>\n      ) : (\n        <div className=\"pagination\">\n          <button onClick={() => gotoPage(0)} disabled={!canPreviousPage}>\n            {\"<<\"}\n          </button>{\" \"}\n          <button onClick={() => previousPage()} disabled={!canPreviousPage}>\n            {\"<\"}\n          </button>{\" \"}\n          <button onClick={() => nextPage()} disabled={!canNextPage}>\n            {\">\"}\n          </button>{\" \"}\n          <button\n            onClick={() => gotoPage(pageCount - 1)}\n            disabled={!canNextPage}\n          >\n            {\">>\"}\n          </button>{\" \"}\n          <span>\n            Page{\" \"}\n            <strong>\n              {pageIndex + 1} of {pageOptions.length}\n            </strong>{\" \"}\n          </span>\n          <span>\n            | Go to page:{\" \"}\n            <input\n              type=\"number\"\n              defaultValue={pageIndex + 1 || 1}\n              onChange={(e) => {\n                const page = e.target.value ? Number(e.target.value) - 1 : 0;\n                gotoPage(page);\n              }}\n            />\n          </span>{\" \"}\n          <select\n            value={pageSize}\n            onChange={(e) => {\n              setPageSize(Number(e.target.value));\n            }}\n          >\n            {[10, 20, 30, 40, 50].map((pageSize) => (\n              <option key={pageSize} value={pageSize}>\n                Show {pageSize}\n              </option>\n            ))}\n          </select>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Table;\n","import { useEffect, useState } from \"react\";\nimport {\n  createFeature,\n  NXUtils,\n  Nextprot,\n  NXViewerUtils,\n} from \"feature-viewer\";\n\nimport Isoform from \"./Isoform\";\nimport { DEFAULT_SEQUENCE, FEATURE_DATA, DEFAULT_OPTIONS } from \"../utils/data\";\nimport Table from \"./Table\";\n\nexport type VariantData = {\n  position: string;\n  original: string;\n  variant: string;\n  sift: string;\n  polyphen: string;\n};\n\nconst FeatureViewerComponent = () => {\n  const [data, setData] = useState<VariantData[] | []>([]);\n  const [currentIsoform, setCurrentIsoform] = useState<any>();\n\n  const CONTAINER_ID = \"fv1\";\n\n  function handleIsoformChange(e: any) {\n    console.log(e.target.value);\n    setCurrentIsoform(e.target.value);\n    // document.getElementById(CONTAINER_ID)!.innerHTML = \"\";\n    setData([]);\n  }\n\n  useEffect(() => {\n    // let nx = new Nextprot.Client(\"Calipho Group\", \"VEP commumity tool\");\n\n    // var nxEntry = \"NX_P07711\";\n\n    // console.log(nxEntry, nx);\n\n    // let rawData: any;\n    // let sequences: any;\n\n    // nx.getIsoformMapping(nxEntry).then((data: any) => {\n    //   console.log(data);\n    // });\n\n    // nx.getProteinSequence(nxEntry).then(function (s: any) {\n    //   console.log(s);\n    //   rawData = s;\n    //   sequences = rawData[0];\n\n    //   for (let i = 0; i < rawData.length - 1; i++) {\n    //     console.log(rawData[i].metadata);\n    //     var feat = NXUtils.convertMappingsToIsoformMap(\n    //       rawData[i],\n    //       {},\n    //       \"propeptide\",\n    //       \"\"\n    //     );\n\n    //     console.log(feat);\n    //     // let featuresForViewer = [];\n    //     // let a  = NXViewerUtils.convertNXAnnotations(feat,.metaData[i],isoLengths);\n    //     // featuresForViewer.push(a);\n    //     // featsByIso.push(feat);\n    //   }\n    // });\n\n    document.getElementById(CONTAINER_ID)!.innerHTML = \"\";\n\n    let fv = new createFeature(\n      DEFAULT_SEQUENCE,\n      `#${CONTAINER_ID}`,\n      DEFAULT_OPTIONS\n    );\n\n    FEATURE_DATA.map((feature) => {\n      fv.addFeature(feature);\n    });\n\n    fv.onVariantAdded((d: CustomEvent) => {\n      setData([...d.detail]);\n    });\n\n    fv.onGetPredictions((d: CustomEvent) => {\n      const variantValues = d.detail;\n\n      variantValues.map((v: VariantData) => {\n        v.sift = Math.random().toFixed(2);\n        v.polyphen = Math.random().toFixed(2);\n      });\n\n      setData(variantValues);\n    });\n  }, []);\n\n  return (\n    <div className=\"viewer-container\">\n      <Isoform\n        currentIsoform={currentIsoform}\n        handleIsoformChange={handleIsoformChange}\n      />\n      <div id=\"fv1\" />\n      <Table data={data} />\n    </div>\n  );\n};\n\nexport default FeatureViewerComponent;\n","import FeatureViewerComponent from \"./components/FeatureViewer\";\nimport Isoform from \"./components/Isoform\";\nimport \"./App.css\";\n\nconst App = () => {\n  return (\n    <div className=\"App\">\n      <img src=\"nextprot-logo.png\" className=\"logo\" alt=\"neXtProt logo\" />\n      <FeatureViewerComponent />\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}